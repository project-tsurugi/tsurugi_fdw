CREATE DATABASE test TEMPLATE = template0 ENCODING = 'UTF8' LC_COLLATE = 'C' LC_CTYPE = 'en_US.utf8';

\c test

CREATE EXTENSION ogawayama_fdw;
CREATE SERVER ogawayama FOREIGN DATA WRAPPER ogawayama_fdw;

create table insert_select_happy (
col0  integer                 constraint nn0 not null PRIMARY KEY,
col1  int                     constraint nn1 not null,
col2  int4                    constraint nn2 not null,
col3  bigint                  constraint nn3 not null,
col4  int8                    constraint nn4 not null,
col5  real                    constraint nn5 not null,
col6  float4                  constraint nn6 not null,
col7  double precision        constraint nn7 not null,
col8  float8                  constraint nn8 not null,
col9  char                    constraint nn9 not null,
col10 char(1)                 constraint nn10 not null,
col11 character               constraint nn11 not null,
col12 character(10)           constraint nn12 not null,
col13 character(1000)         constraint nn13 not null,
col14 varchar(1000)           constraint nn14 not null,
col15 varchar(1000)           constraint nn15 not null,
col16 character varying(1000) constraint nn16 not null
) tablespace tsurugi;

create table integer1 (
  ol_w_id int PRIMARY KEY
) tablespace tsurugi;

create table integer2 (
  ol_w_id int PRIMARY KEY
) tablespace tsurugi;

create table integer3 (
  ol_w_id int PRIMARY KEY
) tablespace tsurugi;

create table integer4 (
  ol_w_id int PRIMARY KEY
) tablespace tsurugi;

create table integer5 (
  ol_w_id int PRIMARY KEY
) tablespace tsurugi;

create table bigint1 (
  ol_w_id bigint PRIMARY KEY
) tablespace tsurugi;

create table bigint2 (
  ol_w_id bigint PRIMARY KEY
) tablespace tsurugi;

create table bigint3 (
  ol_w_id bigint PRIMARY KEY
) tablespace tsurugi;

create table bigint4 (
  ol_w_id bigint PRIMARY KEY
) tablespace tsurugi;

create table real1 (
  ol_w_id real PRIMARY KEY
) tablespace tsurugi;

create table real2 (
  ol_w_id real PRIMARY KEY
) tablespace tsurugi;

create table real3 (
  ol_w_id real PRIMARY KEY
) tablespace tsurugi;

create table real4 (
  ol_w_id real PRIMARY KEY
) tablespace tsurugi;

create table real5 (
  ol_w_id real PRIMARY KEY
) tablespace tsurugi;

create table real6 (
  ol_w_id real PRIMARY KEY
) tablespace tsurugi;

create table double1 (
  ol_w_id double precision PRIMARY KEY
) tablespace tsurugi;

create table double2 (
  ol_w_id double precision PRIMARY KEY
) tablespace tsurugi;

create table double3 (
  ol_w_id double precision PRIMARY KEY
) tablespace tsurugi;

create table double4 (
  ol_w_id double precision PRIMARY KEY
) tablespace tsurugi;

create table double5 (
  ol_w_id double precision PRIMARY KEY
) tablespace tsurugi;

create table double6 (
  ol_w_id double precision PRIMARY KEY
) tablespace tsurugi;

create table char_length_1 (
  ol_w_id char(1) PRIMARY KEY
) tablespace tsurugi;

create table varchar_length_1 (
  ol_w_id varchar(1) PRIMARY KEY
) tablespace tsurugi;

create table char_length_10 (
  ol_w_id char(10) PRIMARY KEY
) tablespace tsurugi;

create table varchar_length_10 (
  ol_w_id varchar(10) PRIMARY KEY
) tablespace tsurugi;

CREATE FOREIGN TABLE insert_select_happy (
col0  integer                 constraint nn0 not null,
col1  int                     constraint nn1 not null,
col2  int4                    constraint nn2 not null,
col3  bigint                  constraint nn3 not null,
col4  int8                    constraint nn4 not null,
col5  real                    constraint nn5 not null,
col6  float4                  constraint nn6 not null,
col7  double precision        constraint nn7 not null,
col8  float8                  constraint nn8 not null,
col9  char                    constraint nn9 not null,
col10 char(1)                 constraint nn10 not null,
col11 character               constraint nn11 not null,
col12 character(10)           constraint nn12 not null,
col13 character(1000)         constraint nn13 not null,
col14 varchar(1000)           constraint nn14 not null,
col15 varchar(1000)           constraint nn15 not null,
col16 character varying(1000) constraint nn16 not null 
) SERVER ogawayama;

create foreign table integer1 (
  ol_w_id int
) SERVER ogawayama;

create foreign table integer2 (
  ol_w_id int
) SERVER ogawayama;

create foreign table integer3 (
  ol_w_id int
) SERVER ogawayama;

create foreign table integer4 (
  ol_w_id int
) SERVER ogawayama;

create foreign table integer5 (
  ol_w_id int
) SERVER ogawayama;

create foreign table bigint1 (
  ol_w_id bigint
) SERVER ogawayama;

create foreign table bigint2 (
  ol_w_id bigint
) SERVER ogawayama;

create foreign table bigint3 (
  ol_w_id bigint
) SERVER ogawayama;

create foreign table bigint4 (
  ol_w_id bigint
) SERVER ogawayama;

create foreign table real1 (
  ol_w_id real
) SERVER ogawayama;

create foreign table real2 (
  ol_w_id real
) SERVER ogawayama;

create foreign table real3 (
  ol_w_id real
) SERVER ogawayama;

create foreign table real4 (
  ol_w_id real
) SERVER ogawayama;

create foreign table real5 (
  ol_w_id real
) SERVER ogawayama;

create foreign table real6 (
  ol_w_id real
) SERVER ogawayama;

create foreign table double1 (
  ol_w_id double precision
) SERVER ogawayama;

create foreign table double2 (
  ol_w_id double precision
) SERVER ogawayama;

create foreign table double3 (
  ol_w_id double precision
) SERVER ogawayama;

create foreign table double4 (
  ol_w_id double precision
) SERVER ogawayama;

create foreign table double5 (
  ol_w_id double precision
) SERVER ogawayama;

create foreign table double6 (
  ol_w_id double precision
) SERVER ogawayama;

create foreign table char_length_1 (
  ol_w_id char(1)
) SERVER ogawayama;

create foreign table varchar_length_1 (
  ol_w_id varchar(1)
) SERVER ogawayama;

create foreign table char_length_10 (
  ol_w_id char(10)
) SERVER ogawayama;

create foreign table varchar_length_10 (
  ol_w_id varchar(10)
) SERVER ogawayama;

SELECT * FROM insert_select_happy;
--ok
INSERT INTO insert_select_happy VALUES (-2147483648, 0, 2147483647,-3147483648, 3147483647,3.24000001, -2.27600002,-0.299999999999999989, 25.8000000000000007,'A','B','a','abcdefghij','0123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789', 'b','KLMNOPQRST','ABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKL');
SELECT * FROM insert_select_happy;
---char(1000) value too long error
INSERT INTO insert_select_happy VALUES (-2147483648, 0, 2147483647,-3147483648, 3147483647,3.24000001, -2.27600002,-0.299999999999999989, 25.8000000000000007,'A','B','a','abcdefghij','01234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890', 'b','KLMNOPQRST','ABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKL');
SELECT * FROM insert_select_happy;
---varchar(1000) value too long error
INSERT INTO insert_select_happy VALUES (-2147483648, 0, 2147483647,-3147483648, 3147483647,3.24000001, -2.27600002,-0.299999999999999989, 25.8000000000000007,'A','B','a','abcdefghij','0123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789', 'b','KLMNOPQRST','ABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLM');
SELECT * FROM insert_select_happy;

--- out of range test
--- int
SELECT * FROM integer1;
INSERT INTO integer1 VALUES (2147483647);
SELECT * FROM integer1;

SELECT * FROM integer2;
INSERT INTO integer2 VALUES (-2147483648);
SELECT * FROM integer2;

SELECT * FROM integer3;
INSERT INTO integer3 VALUES (-2147483649);
SELECT * FROM integer3;

SELECT * FROM integer4;
INSERT INTO integer4 VALUES (2147483648);
SELECT * FROM integer4;

SELECT * FROM integer5;
INSERT INTO integer5 VALUES (2147483648);
SELECT * FROM integer5;

--- bigint
SELECT * FROM bigint1;
INSERT INTO bigint1 VALUES (-9223372036854775808);
SELECT * FROM bigint1;

SELECT * FROM bigint2;
INSERT INTO bigint2 VALUES (-9223372036854775809);
SELECT * FROM bigint2;

SELECT * FROM bigint3;
INSERT INTO bigint3 VALUES (9223372036854775807);
SELECT * FROM bigint3;

SELECT * FROM bigint4;
INSERT INTO bigint4 VALUES (9223372036854775808);
SELECT * FROM bigint4;

--- real
--- comment out out of range test because I don't know specs about range of type
---SELECT * FROM real1;
---INSERT INTO real1 VALUES (10000000000000000000000000000000000000);
---SELECT * FROM real1;
---
---SELECT * FROM real2;
---INSERT INTO real2 VALUES (100000000000000000000000000000000000000);
---SELECT * FROM real2;

SELECT * FROM real5;
INSERT INTO real5 VALUES (0.1);
SELECT * FROM real5;

SELECT * FROM real6;
INSERT INTO real6 VALUES (1.1);
SELECT * FROM real6;

--- double precision
--- comment out out of range test because I don't know specs about range of type
---SELECT * FROM double1;
---INSERT INTO double1 VALUES ---(10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000);
---SELECT * FROM double1;
---
---SELECT * FROM double2;
---INSERT INTO double2 VALUES ---(100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000);
---SELECT * FROM double2;

SELECT * FROM double5;
INSERT INTO double5 VALUES (0.1);
SELECT * FROM double5;

SELECT * FROM double6;
INSERT INTO double6 VALUES (1.1);
SELECT * FROM double6;

--- char(1)
SELECT * FROM char_length_1;
INSERT INTO char_length_1 VALUES ('P');
SELECT * FROM char_length_1;
INSERT INTO char_length_1 VALUES ('Po');
SELECT * FROM char_length_1;

--- varchar(1)
SELECT * FROM varchar_length_1;
INSERT INTO varchar_length_1 VALUES ('P');
SELECT * FROM varchar_length_1;
INSERT INTO varchar_length_1 VALUES ('Po');
SELECT * FROM varchar_length_1;

--- char(10)
SELECT * FROM char_length_10;
INSERT INTO char_length_10 VALUES ('PostgreSQL');
SELECT * FROM char_length_10;
INSERT INTO char_length_10 VALUES ('PostgreSQL1');
SELECT * FROM char_length_10;

--- varchar(10)
SELECT * FROM varchar_length_10;
INSERT INTO varchar_length_10 VALUES ('PostgreSQL');
SELECT * FROM varchar_length_10;
INSERT INTO varchar_length_10 VALUES ('PostgreSQL1');
SELECT * FROM varchar_length_10;

\c postgres

DROP DATABASE test;
