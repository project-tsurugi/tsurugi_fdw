# Psycopg API について

2025.12.5  

## psycopg3 (バージョン 3.3.0) API 仕様一覧

`psycopg3` は `psycopg2` の後継として、よりモダンなPythonの機能 (asyncioなど) を活用し、パフォーマンスと使いやすさを向上させることを目指しています。

- [`psycopg` モジュールインターフェース](#psycopg-モジュールインターフェース)：グローバルインターフェース
- [`Connection` クラス](#connection-クラス)：データベースとの接続を管理（同期）
- [`AsyncConnection` クラス](#asyncconnection-クラス)：データベースとの接続を管理（非同期）
- [`Cursor` クラス](#cursor-クラス)：SQLコマンドの実行と結果を処理（同期）
- [`AsyncCursor` クラス](#asynccursor-クラス)：SQLコマンドの実行と結果を処理（非同期）
- [`Copy` 関連オブジェクト](#copy-関連オブジェクト)：SQL COPYコマンドを処理（同期/非同期）
- [その他のトップレベルオブジェクト](#その他のトップレベルオブジェクト)
  - [`ConnectionInfo` クラス](#connectioninfo-クラス)
  - [`LibpqCapabilitieInfo` クラス](#libpqcapabilitieinfo-クラス)
  - [`Column` クラス](#column-クラス)
  - [`Notify` クラス](#notify-クラス)
  - [`Pipeline` 関連オブジェクト](#pipeline-関連オブジェクト)
  - [Transaction関連オブジェクト](#transaction関連オブジェクト)
  - [Two-Phase Commit関連オブジェクト](#two-phase-commit関連オブジェクト)
- [conninfo (psycopg.conninfo)](#conninfo-psycopgconninfo)：データベース接続文字列を操作
- [adapt (psycopg.adapt)](#adapt-psycopgadapt)：PythonとPostgreSQLのデータ型変換
- [types (psycopg.types)](#types-psycopgtypes)：型情報とアダプタ
- [abc (psycopg.abc)](#abc-psycopgabc)：データ型変換の抽象クラス
- [pq (psycopg.pq)](#pq-psycopgpq)：libpqラッパーモジュール
- [crdb (psycopg.crdb)](#crdb-psycopgcrdb)：CockroachDBサポート
- [\_dns (psycopg.\_dns)](#_dns-psycopg_dns)：DNS解決ユーティリティ

### `psycopg` モジュールインターフェース

Python Database DB API 2.0 (PEP 249) 仕様で要求されるモジュールレベルのオブジェクト。  

#### 接続関数

| メソッド名              | 説明 | サポート |
| :---------------------- | :--- | :------: |
| `psycopg.connect(...)`  | データベースへの接続を確立し `Connection` オブジェクトを返す。`Connection.connect` のエイリアス | 〇 |

#### 属性

| 属性名                       | 説明 | サポート |
| :--------------------------- | :--- | :------: |
| `psycopg.capabilities`       | `libpq` が特定の機能を実装しているかを確認するためのオブジェクト (`Capabilities` クラスのインスタンス) | 確認 |
| `psycopg.adapters`           | Python型とPostgreSQL型の変換方法を定義するデフォルトのアダプターマップ。 (`AdaptersMap` クラスのインスタンス) | 確認 |

#### 例外クラス (PEP 249準拠)

| クラス名                     | 説明 | サポート |
| :--------------------------- | :--- | :------: |
| `psycopg.Warning`            | データベースに関する警告のための例外クラス | 確認 |
| `psycopg.Error`              | データベース操作全般のエラーのための例外クラス | 〇 |
| `psycopg.InterfaceError`     | データベースインターフェース自体に関するエラーのための例外クラス。`Error` のサブクラス | 確認 |
| `psycopg.DatabaseError`      | データベース自体に関するエラーのための例外クラス。`Error` のサブクラス | 確認 |
| `psycopg.DataError`          | データベースで処理中のデータに関する問題。`DatabaseError` のサブクラス | 確認 |
| `psycopg.OperationalError`   | データベースの動作環境に関するエラー。`DatabaseError` のサブクラス | 確認 |
| `psycopg.IntegrityError`     | データベースの整合性に関するエラー。`DatabaseError` のサブクラス | 確認 |
| `psycopg.InternalError`      | データベースの内部エラー。`DatabaseError` のサブクラス | 確認 |
| `psycopg.ProgrammingError`   | プログラミングエラー。`DatabaseError` のサブクラス | 確認 |
| `psycopg.NotSupportedError`  | ドライバがサポートしない機能を使用しようとした場合のエラー。`DatabaseError` のサブクラス | 確認 |

#### 例外クラス (psycopg 拡張機能)

| 属性名                          | 説明 | サポート |
| :------------------------------ | :--- | :------: |
| `psycopg.Error.diag` (属性)     | エラーに関する詳細情報を含む `Diagnostics` オブジェクト | 確認 |
| `psycopg.Error.sqlstate` (属性) | サーバーからエラーが受信された場合のエラーコード | 確認 |
| `psycopg.Error.pgconn` (属性)   | エラーが接続試行から発生した場合の接続オブジェクト | 確認 |
| `psycopg.Error.pgresult` (属性) | エラーが失敗したクエリの後に発生した場合の結果オブジェクト | 確認 |

#### 型オブジェクトについて (補足説明)

`psycopg3` は、PEP 249の「型オブジェクト」を直接は提供していません。  
（詳細は [psycopg3 ドキュメント - Data adaptation configuration](https://www.psycopg.org/psycopg3/docs/advanced/adapt.html) 参照）  
ちなみに、`psycopg2` は、`psycopg2.Date()`, `psycopg2.Binary()` といった  
PEP 249 に準拠した型オブジェクトをモジュールレベルで提供しています。  

`psycopg3` は、Python 標準のデータ型を最大限に活用し、より汎用的で  
カスタマイズ可能なデータ適応システム (`psycopg.adapt` と `psycopg.types`  
が中心) を通じて型変換を扱っています。  
これは、`psycopg3` が `psycopg2` からの変更点として、より柔軟で強力な  
「データ適応システム (Data Adaptation System)」 を導入しているためです。  
これにより、特定のデータベース固有の型やユーザー定義型への対応が柔軟に  
行えるようになっているようです。  

---

### `Connection` クラス

PostgreSQLデータベースへの接続を表す（同期）オブジェクト。トランザクションの管理、カーソルの作成などを行う。

#### PEP 249準拠 (`Connection` クラス)

| メソッド名         | 説明 | サポート |
| :----------------- | :--- | :------: |
| `close()`          | データベース接続を閉じる | 〇 |
| `commit()`         | 保留中のトランザクションをデータベースにコミットする | 〇 |
| `rollback()`       | 保留中のトランザクションの開始点までロールバックする | 〇 |
| `cursor(...)`      | 新しいカーソルオブジェクトを返す | 〇 |

#### psycopg 拡張機能 (`Connection` クラス)

| 名前                            | 説明 | サポート |
| :------------------------------ | :--- | :------: |
| `connect(...)` (クラスメソッド) | データベースサーバーに接続し、新しい `Connection` インスタンスを返す。`psycopg.connect()` のエイリアス | 確認 |
| `execute(...)`                  | クエリを実行し、結果を読み取るカーソルを返す | 確認 |
| `pipeline()`                    | 接続をパイプラインモードに切り替えるコンテキストマネージャ。`with conn.pipeline() as p:` のように使用する | 確認 |
| `transaction(...)`              | 新しいトランザクションまたはネストされたトランザクションでコンテキストブロックを開始する | 確認 |
| `set_autocommit(...)`           | `autocommit` セッターのメソッドバージョン | 確認 |
| `set_isolation_level(...)`      | `isolation_level` セッターのメソッドバージョン | 確認 |
| `set_read_only(...)`            | `read_only` セッターのメソッドバージョン | 確認 |
| `set_deferrable(...)`           | `deferrable` セッターのメソッドバージョン | 確認 |
| `cancel_safe(...)`              | 接続上の現在の操作をキャンセルする | 確認 |
| `cancel()`                      | 接続上の現在の操作をキャンセルする。シグナルハンドラとして呼び出す場合にのみ推奨される | 確認 |
| `notifies(...)`                 | データベースから通知を受信すると `Notify` オブジェクトを生成する | 確認 |
| `add_notify_handler(...)`       | 通知を受信したときに呼び出される callable を登録する | 確認 |
| `remove_notify_handler(...)`    | 以前に登録された通知 callable を登録解除する | 確認 |
| `add_notice_handler(...)`       | 通知メッセージを受信したときに呼び出される callable を登録する | 確認 |
| `remove_notice_handler(...)`    | 以前に登録された通知メッセージ callable を登録解除する | 確認 |
| `fileno()`                      | 接続のファイルディスクリプタを返す | 確認 |
| `xid(...)`                      | Two-phase commitで使用する `Xid` インスタンスを返す | 確認 |
| `tpc_begin(...)`                | 指定されたトランザクションID `xid` でTwo-phase commitトランザクションを開始する | 確認 |
| `tpc_prepare()`                 | `tpc_begin()` で開始されたトランザクションのTwo-phase commitの最初のフェーズを実行する | 確認 |
| `tpc_commit(...)`               | 準備されたTwo-phase commitトランザクションをコミットする | 確認 |
| `tpc_rollback(...)`             | 準備されたTwo-phase commitトランザクションをロールバックする | 確認 |
| `tpc_recover()`                 | 準備状態のトランザクションのリスト (`Xid` オブジェクト) を返す | 確認 |
| `prepare(...)`                  | クエリを準備し、`PreparedStatement` オブジェクトを返す | 確認 |
| `prepared_statement(...)`       | 準備済みステートメントのコンテキストマネージャ | 確認 |
| `adapters` (属性)               | このカーソルで実行されるクエリのPythonパラメータとPostgreSQL結果を変換するために使用されるアダプター構成 | **R884** |
| `closed` (属性)                 | 接続が閉じている場合にTrue | 確認 |
| `broken` (属性)                 | 接続が中断された場合にTrue | 確認 |
| `cursor_factory` (属性)         | `cursor()` および `execute()` によって返される型、またはファクトリ関数。デフォルトは `psycopg.Cursor` | 確認 |
| `server_cursor_factory` (属性)  | `name` が指定された場合に `cursor()` によって返される型、またはファクトリ関数。デフォルトは `psycopg.ServerCursor` | 確認 |
| `row_factory` (属性)            | `fetchone()` およびその他のカーソルフェッチメソッドによって返される行のタイプを定義する行ファクトリ。デフォルトは `tuple_row` | 確認 |
| `autocommit` (属性)             | 接続の自動コミット状態。同期接続では書き込み可能、非同期接続では読み取り専用 | 確認 |
| `isolation_level` (属性)        | 新しいトランザクションの分離レベル | 確認 |
| `read_only` (属性)              | 新しいトランザクションの読み取り専用状態 | 確認 |
| `deferrable` (属性)             | 新しいトランザクションのdeferrable状態 | 確認 |
| `pgconn` (属性)                 | 接続を構成する `libpq` 接続ラッパー | 確認 |
| `info` (属性)                   | 接続プロパティを検査するための `ConnectionInfo` 属性 | 確認 |
| `prepare_threshold` (属性)      | クエリが準備されるまでに実行される回数。デフォルトは5 | 確認 |
| `prepared_max` (属性)           | 接続上の準備済みステートメントの最大数。デフォルトは100 | 確認 |

### `AsyncConnection` クラス

PostgreSQLデータベースへの接続を表す（非同期）オブジェクト。トランザクションの管理、カーソルの作成などを行う。

#### PEP 249準拠 (`AsyncConnection` クラス)

| 名前                 | 説明 | サポート |
| :------------------- | :--- | :------: |
| `close()` (async)    | データベース接続を非同期で閉じる | 確認 |
| `commit()` (async)   | 保留中のトランザクションをデータベースに非同期でコミットする | 確認 |
| `rollback()` (async) | 保留中のトランザクションの開始点まで非同期でロールバックする | 確認 |
| `cursor(...)`        | 新しい非同期カーソルオブジェクトを返す | 確認 |

#### psycopg 拡張機能 (`AsyncConnection` クラス)

| 名前                 | 説明 | サポート |
| :----------------------------- | :--- | :------: |
| `connect(...)` (async クラスメソッド) | データベースサーバーに接続し、新しい `AsyncConnection` インスタンスを返す | 確認 |
| `execute(...)` (async)         | 非同期でクエリを実行し、結果を読み取るカーソルを返す | 確認 |
| `pipeline()` (async)           | 接続をパイプラインモードに切り替える非同期コンテキストマネージャ | 確認 |
| `transaction(...)` (async)     | 新しいトランザクションまたはネストされたトランザクションで非同期コンテキストブロックを開始する | 確認 |
| `cancel_safe(...)` (async)     | 接続上の現在の操作を非同期でキャンセルする | 確認 |
| `notifies(...)` (async)        | データベースから通知を受信すると `Notify` オブジェクトを非同期で生成する | 確認 |
| `set_autocommit(...)` (async)  | `autocommit` セッターの非同期メソッドバージョン | 確認 |
| `set_isolation_level(...)` (async) | `isolation_level` セッターの非同期メソッドバージョン | 確認 |
| `set_read_only(...)` (async)   | `read_only` セッターの非同期メソッドバージョン | 確認 |
| `set_deferrable(...)` (async)  | `deferrable` セッターの非同期メソッドバージョン | 確認 |
| `tpc_prepare()` (async)        | `tpc_begin()` で開始されたトランザクションのTwo-phase commitの最初のフェーズを非同期で実行する | × |
| `tpc_commit(...)` (async)      | 準備されたTwo-phase commitトランザクションを非同期でコミットする | × |
| `tpc_rollback(...)` (async)    | 準備されたTwo-phase commitトランザクションを非同期でロールバックする | × |
| `tpc_recover()` (async)        | 準備状態のトランザクションのリスト (`Xid` オブジェクト) を非同期で返す | × |
| `cursor_factory` (属性)        | `cursor()` によって返される非同期カーソルの型、またはファクトリ関数 | 確認 |
| `server_cursor_factory` (属性) | `name` が指定された場合に `cursor()` によって返される非同期カーソルの型、またはファクトリ関数 | 確認 |
| `row_factory` (属性)           | `fetchone()` およびその他の非同期カーソルフェッチメソッドによって返される行のタイプを定義する非同期行ファクトリ | 確認 |
| `async with` (特殊メソッド)    | 非同期接続をコンテキストマネージャとして使用し、`async with` ブロックの終了時にコミットまたはロールバックを自動的に行う | 確認 |

---

### `Cursor` クラス

SQLコマンドの実行と結果を処理するための（同期）オブジェクト。SQLクエリの実行、フェッチなどを行う。

#### PEP 249準拠 (`Cursor` クラス)

| 名前                 | 説明 | サポート |
| :------------------- | :--- | :------: |
| `execute(...)`       | SQLステートメントを実行する | 〇 |
| `executemany(...)`   | 複数のパラメータセットに対して同じSQLステートメントを複数回実行する | 確認 |
| `fetchone()`         | 次の1行を取得する | 〇 |
| `fetchmany(...)`     | 指定された数の行を取得する | 〇 |
| `fetchall()`         | 残りのすべての行を取得する | 〇 |
| `close()`            | カーソルを閉じる | 〇 |
| `rowcount` (属性)    | 影響を受けた行の数、または返された行の数 | 〇 |
| `description` (属性) | 最後のクエリ結果の列のメタデータを記述するタプルのシーケンス | 確認 |
| `arraysize` (属性)   | `fetchmany()` のデフォルトサイズ | 確認 |
| `setinputsizes(...)` | （オプション）次の実行されるSQLの入力パラメータのサイズを事前に定義する | 確認 |
| `setoutputsize(...)` | （オプション）特定のカラムの出力サイズを事前に定義する | 確認 |
| `callproc(...)`      | ストアドプロシージャを実行する | × |

#### psycopg 拡張機能 (`Cursor` クラス)

| 名前                   | 説明 | サポート |
| :--------------------- | :--- | :------: |
| `connection` (属性)    | このカーソルが使用している接続 | 確認 |
| `adapters` (属性)      | PythonパラメータとPostgreSQL結果を変換するために使用されるアダプター設定 | 確認 |
| `closed` (属性)        | カーソルが閉じている場合にTrue | 確認 |
| `copy(...)`            | `COPY` 操作を開始し、それを管理するためのオブジェクトを返す | 確認 |
| `stream(...)`          | データベースからの結果を1行ずつイテレートする | 確認 |
| `format` (属性)        | クエリによって返されるデータの形式 (`pq.Format` 列挙型) | 確認 |
| `row_factory` (属性)   | 結果行の形成方法を制御する書き込み可能な属性 | 確認 |
| `nextset()`            | `executemany()` によって実行された次のクエリの結果セットに移動する | 確認 |
| `results()`            | カーソルによって受信された複数のレコードセットをイテレートする | 確認 |
| `set_result(...)`      | 特定の結果セットに移動する | 確認 |
| `scroll(...)`          | 結果セット内のカーソルを新しい位置に移動する | 確認 |
| `pgresult` (属性)      | 現在の結果セットの表現（低レベルの `PGresult` オブジェクト） | 確認 |
| `statusmessage` (属性) | 現在の結果セットのステータスタグ | 確認 |
| `rownumber` (属性)     | 現在の結果セットでフェッチする次の行のインデックス | 確認 |
| `_query` (属性)        | クエリとパラメータを変換するために使用されるヘルパーオブジェクト | 確認 |
| `ntuples` (属性)       | 結果セットの行数 | 確認 |
| `nfields` (属性)       | 結果セットの列数 | 確認 |
| `mogrify(...)`         | クエリを準備しますが実行せず、バインドされた引数を含む文字列を返す | 確認 |
| `copy(...)`            | `COPY` コマンドを実行し、ファイルのようなオブジェクトから/へデータをコピーする | 確認 |

#### その他 (`Cursor` クラス)

| 名前                   | 説明 | サポート |
| :--------------------- | :--- | :------: |
| `ClientCursor(...)` (クラス) | クライアント側バインディングカーソル | 確認 |
| `mogrify(...)`         | クエリとパラメータをマージした文字列を返す | 確認 |
| `ServerCursor(...)` (クラス) | サーバーサイドカーソル | 確認 |
| `name` (属性)          | カーソルの名前 | 確認 |
| `scrollable` (属性)    | カーソルがスクロール可能かどうか。Trueの場合、`scroll()` メソッドを使用できる | 確認 |
| `withhold` (属性)      | 作成トランザクションがコミットされた後もカーソルを使用できるかどうか | 確認 |
| `close()`              | 現在のカーソルを閉じ、関連するリソースを解放する | 確認 |
| `execute(...)`         | クエリを実行してカーソルを開く | 確認 |
| `executemany(...)`     | サーバーサイドカーソルには実装されてない | 確認 |
| `fetchone()`           | 現在の結果セットから次のレコードを取得する | 確認 |
| `fetchmany(...)`       | 現在の結果セットから次の指定数のレコードを取得する | 確認 |
| `fetchall()`           | 現在の結果セットから残りの全てのレコードを取得する | 確認 |
| `itersize` (属性)      | カーソルをイテレートする際に、一度にバックエンドからフェッチするレコード数 | 確認 |
| `scroll(...)`          | 結果セット内のカーソルを新しい位置に移動する | 確認 |
| `RawCursor(...)` (クラス) | PostgreSQL形式 ($1, $2…) のプレースホルダをサポートする | 確認 |
| `RawServerCursor(...)` (クラス) | PostgreSQL形式 ($1, $2…) のプレースホルダをサポートする | 確認 |

### `AsyncCursor` クラス

SQLコマンドの実行と結果を処理するための（非同期）オブジェクト。SQLクエリの実行、フェッチなどを行う。

#### PEP 249準拠 (`AsyncCursor` クラス)

| 名前                       | 説明 | サポート |
| :------------------------- | :--- | :------: |
| `execute(...)` (async)     | SQLステートメントを非同期で実行する | 確認 |
| `executemany(...)` (async) | 複数のパラメータセットに対して同じSQLステートメントを非同期で複数回実行する | 確認 |
| `fetchone()` (async)       | 次の1行を非同期で取得する | 確認 |
| `fetchmany(...)` (async)   | 指定された数の行を非同期で取得する | 確認 |
| `fetchall()` (async)       | 残りのすべての行を非同期で取得する | 確認 |
| `close()` (async)          | カーソルを非同期で閉じる | 確認 |
| `rowcount` (属性)          | 影響を受けた行の数、または返された行の数 | 確認 |
| `description` (属性)       | 最後のクエリ結果の列のメタデータを記述するタプルのシーケンス | 確認 |
| `arraysize` (属性)         | `fetchmany()` のデフォルトサイズ | 確認 |
| `setinputsizes(...)`       | （オプション）次の実行されるSQLの入力パラメータのサイズを事前に定義する | 確認 |
| `setoutputsize(...)`       | （オプション）特定のカラムの出力サイズを事前に定義する | 確認 |
| `callproc(...)`            | ストアドプロシージャを非同期で実行する | × |

#### psycopg 拡張機能 (`AsyncCursor` クラス)

| 名前                       | 説明 | サポート |
| :------------------------- | :--- | :------: |
| `connection` (属性)        | このカーソルが使用している非同期接続 | 確認 |
| `adapters` (属性)          | PythonパラメータとPostgreSQL結果を変換するために使用されるアダプター設定 | 確認 |
| `closed` (属性)            | カーソルが閉じている場合にTrue | 確認 |
| `copy(...)` (async)        | `COPY` 操作を開始し、それを管理するためのオブジェクトを非同期で返す | 確認 |
| `stream(...)` (async)      | データベースからの結果を1行ずつ非同期でイテレートする | 確認 |
| `format` (属性)            | クエリによって返されるデータの形式 | 確認 |
| `row_factory` (属性)       | 結果行の形成方法を制御する書き込み可能な属性 | 確認 |
| `results()` (async)        | カーソルによって受信された複数のレコードセットを非同期でイテレートする | 確認 |
| `set_result(...)` (async)  | 特定の結果セットに非同期で移動する | 確認 |
| `scroll(...)` (async)      | 結果セット内のカーソルを新しい位置に非同期で移動する | 確認 |
| `pgresult` (属性)          | 現在の結果セットの表現 | 確認 |
| `statusmessage` (属性)     | 現在の結果セットのステータスタグ | 確認 |
| `rownumber` (属性)         | 現在の結果セットでフェッチする次の行のインデックス | 確認 |
| `_query` (属性)            | クエリとパラメータを変換するために使用されるヘルパーオブジェクト（デバッグ用） | 確認 |
| `async for` (特殊メソッド) | 非同期カーソルを非同期イテレータとして使用できる | 確認 |
| `ntuples` (属性)           | 結果セットの行数 | 確認 |
| `nfields` (属性)           | 結果セットの列数 | 確認 |
| `mogrify(...)`             | クエリを準備しますが実行せず、バインドされた引数を含む文字列を返す | 確認 |
| `copy(...)`                | `COPY` コマンドを実行し、ファイルのようなオブジェクトから/へデータをコピーする | 確認 |

#### その他 (`AsyncCursor` クラス)

| 名前                       | 説明 | サポート |
| :------------------------- | :--- | :------: |
| `AsyncClientCursor(...)` (クラス) | `ClientCursor` の非同期版 | 確認 |
| `AsyncServerCursor(...)` (クラス) | `ServerCursor` の非同期版 | 確認 |
| `close()` (async)          | 現在のカーソルを非同期で閉じ、関連するリソースを解放する | 確認 |
| `execute(...)` (async)     | クエリを実行してカーソルを非同期で開く | 確認 |
| `executemany(...)` (async) | サーバーサイドカーソルには実装されてない | 確認 |
| `fetchone()` (async)       | 現在の結果セットから次のレコードを非同期で取得する | 確認 |
| `fetchmany(...)` (async)   | 現在の結果セットから次の指定数のレコードを非同期で取得する | 確認 |
| `fetchall()` (async)       | 現在の結果セットから残りの全てのレコードを非同期で取得する | 確認 |
| `scroll(...)` (async)      | 結果セット内のカーソルを新しい位置に非同期で移動する | 確認 |
| `AsyncRawCursor(...)` (クラス) | `RawCursor` の非同期版 | 確認 |
| `AsyncRawServerCursor(...)` (クラス) | `RawServerCursor` の非同期版 | 確認 |

---

### `Copy` 関連オブジェクト

#### `Copy` クラス

| 名前                       | 説明 | サポート |
| :------------------------- | :--- | :------: |
| `Copy(...)` (クラス)       | 非同期 `COPY` 操作を管理するオブジェクト | × |
| `write_row(...)`           | `COPY FROM` 操作の後にレコードをテーブルに書き込む | × |
| `write(...)`               | `COPY FROM` 操作の後にデータのブロックをテーブルに書き込む | × |
| `read()`                   | `COPY TO` 操作の後に解析されていない行を読み取る | × |
| `rows()`                   | `COPY TO` 操作の結果をレコードごとにイテレートする | × |
| `read_row()`               | `COPY TO` 操作の後に解析されたデータの行をテーブルから読み取る。データが終了すると `None` を返す | × |
| `set_types(...)`           | `COPY` 操作で期待される型を設定する | × |

#### `AsyncCopy` クラス

| 名前                       | 説明 | サポート |
| :------------------------- | :--- | :------: |
| `AsyncCopy(...)` (クラス)  | 非同期 `COPY` 操作を管理するオブジェクト | × |
| `write_row(...)` (async)   | `COPY FROM` 操作の後にレコードをテーブルに非同期で書き込む | × |
| `write(...)` (async)       | `COPY FROM` 操作の後にデータのブロックをテーブルに非同期で書き込む | × |
| `read()` (async)           | `COPY TO` 操作の後に解析されていない行を非同期で読み取る | × |
| `rows()` (async)           | `COPY TO` 操作の結果をレコードごとに非同期でイテレートする | × |
| `read_row()` (async)       | `COPY TO` 操作の後に解析されたデータの行をテーブルから非同期で読み取る。データが終了すると `None` を返す | × |

#### その他 (`Copy` オブジェクト)

| 名前                       | 説明 | サポート |
| :------------------------- | :--- | :------: |
| `Writer` (抽象クラス)      | コピーデータをどこかに書き込むための抽象基底クラス | × |
| `AsyncWriter` (抽象クラス) | 非同期 `Writer` | × |
| `LibpqWriter(...)` (クラス)| `COPY` データをPostgresデータベースに書き込むための `Writer` | × |
| `FileWriter(...)` (クラス) | `COPY` データをファイルライクオブジェクトに書き込むための `Writer` | × |
| `AsyncLibpqWriter(...)` (クラス) | `COPY` データをPostgresデータベースに書き込むための `AsyncWriter` | × |

---

### その他のトップレベルオブジェクト

#### `ConnectionInfo` クラス

| 名前                                        | 説明 | サポート |
| :------------------------------------------ | :--- | :------: |
| `ConnectionInfo` (クラス)                   | 接続に関する情報へのアクセスを許可するオブジェクト | 確認 |
| `dsn` (属性)                                | データベースに接続するための接続文字列 | 確認 |
| `status` (属性)                             | 接続のステータス | 確認 |
| `transaction_status` (属性)                 | セッションの現在のイン・トランザクションステータス | 確認 |
| `pipeline_status` (属性)                    | クライアントの現在のパイプラインステータス | 確認 |
| `backend_pid` (属性)                        | この接続を処理するバックエンドプロセスのPID | 確認 |
| `vendor` (属性)                             | 接続されているデータベースベンダーを表す文字列 | 確認 |
| `server_version` (属性)                     | サーバーのバージョンを表す整数 | 確認 |
| `full_protocol_version` (属性)              | サーバーの完全なプロトコルバージョンを表す整数 | 確認 |
| `error_message` (属性)                      | 接続に対する操作によって最近生成されたエラーメッセージ | 確認 |
| `get_parameters()`                          | 接続パラメータの値を辞書として返す | 確認 |
| `timezone` (属性)                           | 接続のタイムゾーンのPythonタイムゾーン情報 | 確認 |
| `host` (属性)                               | アクティブな接続のサーバーホスト名 | 確認 |
| `hostaddr` (属性)                           | 接続のサーバーIPアドレス | 確認 |
| `port` (属性)                               | アクティブな接続のポート | 確認 |
| `dbname` (属性)                             | 接続のデータベース名 | 確認 |
| `user` (属性)                               | 接続のユーザー名 | 確認 |
| `password` (属性)                           | 接続のパスワード | 確認 |
| `options` (属性)                            | 接続要求で渡されたコマンドラインオプション | 確認 |
| `parameter_status(...)`                     | 接続のパラメータ設定を返す | 確認 |
| `encoding` (属性)                           | 接続のクライアントエンコーディングのPythonコーデック名 | 確認 |

#### `LibpqCapabilitieInfo` クラス

| 名前                                        | 説明 | サポート |
| :------------------------------------------ | :--- | :------: |
| `Capabilities` (クラス)                     | クライアントで利用可能な `libpq` が特定の機能をサポートしているかを確認するためのオブジェクト | 確認 |
| `has_full_protocol_version(...)`            | `PGconn.full_protocol_version()` メソッドが実装されているかチェックする | 確認 |
| `has_encrypt_password(...)`                 | `PGconn.encrypt_password()` メソッドが実装されているかチェックする | 確認 |
| `has_hostaddr(...)`                         | `ConnectionInfo.hostaddr` 属性が実装されているかチェックする | 確認 |
| `has_pipeline(...)`                         | パイプラインモードがサポートされているかチェックする | 確認 |
| `has_set_trace_flags(...)`                  | `pq.PGconn.set_trace_flags()` メソッドが実装されているかチェックする | 確認 |
| `has_used_gssapi(...)`                      | `pq.PGconn.used_gssapi` 属性が実装されているかチェックする | 確認 |
| `has_cancel_safe(...)`                      | `Connection.cancel_safe()` メソッドが実装されているかチェックする | 確認 |
| `has_stream_chunked(...)`                   | `Cursor.stream()` がチャンクで結果を取得するために `size` パラメータを扱えるかチェックする | 確認 |
| `has_send_close_prepared(...)`              | `pq.PGconn.send_closed_prepared()` メソッドが実装されているかチェックする | 確認 |

#### `Column` クラス

| 名前                                        | 説明 | サポート |
| :------------------------------------------ | :--- | :------: |
| `Column` (クラス)                           | DBAPIによって記述された、データベース結果からのデータ列の記述 | 〇 |
| `name` (属性)                               | 列の名前 | 〇 |
| `type_code` (属性)                          | 列の数値OID | 〇 |
| `type_display` (属性)                       | 列の型の表現 | 確認 |
| `display_size` (属性)                       | 文字列型などのフィールドサイズ。常にNone | 確認 |
| `internal_size` (属性)                      | 固定長型の場合の内部フィールドサイズ。それ以外の場合はNone | 〇 |
| `precision` (属性)                          | 固定精度型の場合の有効桁数の合計 | 確認 |
| `scale` (属性)                              | 数値型の場合の小数点以下の桁数 | 確認 |
| `null_ok` (属性)                            | 常にNone | 確認 |

#### `Notify` クラス

| 名前                                        | 説明 | サポート |
| :------------------------------------------ | :--- | :------: |
| `Notify(...)` (クラス)                      | データベースから受信した非同期通知 | 確認 |
| `channel` (属性)                            | 通知が受信されたチャネルの名前 | 確認 |
| `payload` (属性)                            | 通知に添付されたメッセージ | 確認 |
| `pid` (属性)                                | 通知を送信したバックエンドプロセスのPID | 確認 |

#### `Pipeline` 関連オブジェクト

| 名前                                        | 説明 | サポート |
| :------------------------------------------ | :--- | :------: |
| `Pipeline(...)` (クラス)                    | (同期)パイプラインモードでの接続のハンドラ。`Connection.pipeline()` によって返る | × |
| `sync()`                                    | パイプラインを同期し、保留中のコマンドを送信し、利用可能なすべての結果を受信して処理する | × |
| `is_supported()` (クラスメソッド)           | `psycopg` の `libpq` ラッパーがパイプラインモードをサポートしている場合にTrueを返す | × |
| `AsyncPipeline(...)` (クラス)               | (非同期)パイプラインモードでの接続のハンドラ。`AsyncConnection.pipeline()` によって返る | × |
| `sync()` (async)                            | パイプラインを非同期で同期し、保留中のコマンドを送信し、利用可能なすべての結果を受信して処理する | × |

#### Transaction関連オブジェクト

| 名前                                        | 説明 | サポート |
| :------------------------------------------ | :--- | :------: |
| `Transaction(...)` (クラス)                 | `Connection.transaction()` によって返されるトランザクションブロックを処理するためのオブジェクト | 確認 |
| `savepoint_name` (属性)                     | セーブポイントの名前 | 確認 |
| `connection` (属性)                         | オブジェクトが管理している接続 | 確認 |
| `status` (属性)                             | トランザクションの現在のステータス | 確認 |
| `AsyncTransaction(...)` (クラス)            | `AsyncConnection.transaction()` によって返されるトランザクションブロックを処理するためのオブジェクト | 確認 |
| `connection` (属性)                         | オブジェクトが管理している非同期接続 | 確認 |
| `IsolationLevel` (Enum)                     | トランザクションの分離レベルを表す列挙型 | 確認 |
| `Rollback(...)` (例外クラス)                | 現在のトランザクションコンテキストを直ちに終了し、このコンテキスト内で行われた変更をロールバックする | 確認 |

#### Two-Phase Commit関連オブジェクト

| 名前                                        | 説明 | サポート |
| :------------------------------------------ | :--- | :------: |
| `Xid(...)` (クラス)                         | Two-phase commitトランザクション識別子 | × |
| `format_id` (属性)                          | Two-phaseトランザクションのフォーマット識別子 | × |
| `gtrid` (属性)                              | Two-phaseトランザクションのグローバル・トランザクション識別子 | × |
| `bqual` (属性)                              | Two-phaseトランザクションのブランチ修飾子 | × |
| `prepared` (属性)                           | トランザクションがコミット準備されたタイムスタンプ | × |
| `owner` (属性)                              | 回復されたトランザクションを実行したユーザーの名前 | × |
| `database` (属性)                           | トランザクションが実行されたデータベースの名前 | × |

### conninfo (psycopg.conninfo)

データベース接続文字列を操作するためのユーティリティ。

### adapt (psycopg.adapt)

Types adaptation。
Python オブジェクトから PostgreSQL データ型への変換 (およびその逆) であるデータ適応psycopg.adaptの構成に役立つオブジェクトのセットを公開します

#### `psycopg.adapt.Dumper` (クラス)

PythonオブジェクトをPostgreSQLが理解できる形式のバイト列に変換するために使用されるオブジェクト。

| 名前                            | 説明 | サポート |
| :------------------------------ | :--- | :------: |
| `Dumper(...)` (クラス)          | PostgreSQL表現にPythonオブジェクトを変換する抽象基底クラス | 確認 |
| `dump(...)` (抽象メソッド)      | オブジェクトをPostgreSQL表現に変換する | 確認 |
| `format` (クラス属性)           | クラスの `dump()` メソッドがオブジェクトをバイナリ形式に変換する場合 `BINARY` に設定する。デフォルトは `TEXT` | 確認 |
| `quote(...)`                    | デフォルトでは、`dump()` の値を引用符で囲みサニタイズして、結果をSQL文字列の構築に使用できるようにする | 確認 |
| `get_key(...)`                  | `Dumper` プロトコルの `get_key()` メンバーの実装 | 確認 |
| `upgrade(...)`                  | `obj` を管理するための新しい `Dumper` を返す | 確認 |

#### `psycopg.adapt.Loader` (クラス)

PostgreSQLからバイトシーケンスを読み取ってPython オブジェクトを作成するために使用されるオブジェクト(Dumperの反対)。  

| 名前                            | 説明 | サポート |
| :------------------------------ | :--- | :------: |
| `Loader(...)` (クラス)          | OID oid を持つPostgreSQL値をPythonオブジェクトに変換する抽象基底クラス | 確認 |
| `load(...)` (抽象メソッド)      | データベースから返されたデータをPythonオブジェクトに変換する | 確認 |
| `format` (クラス属性)           | クラスの `load()` メソッドがオブジェクトをバイナリ形式から変換する場合 `BINARY` に設定する。デフォルトは `TEXT` | 確認 |

#### `psycopg.adapt.AdaptersMap` (クラス)

PythonとPostgreSQL間で型がどのように変換されるか確立する。

| 名前                            | 説明 | サポート |
| :------------------------------ | :--- | :------: |
| `AdaptersMap(...)` (クラス)     | Pythonの型を `Dumper` クラスに、OIDを `Loader` クラスにマッピングする | 確認 |
| `register_dumper(...)`          | オブジェクトを変換するためにコンテキストを設定する | **R884** |
| `register_loader(...)`          | OID `oid` のデータを変換するために `loader` を使用するようにコンテキストを設定する | 確認 |
| `types` (属性)                  | 型情報を検索するオブジェクト (`TypesRegistry` 型) | 確認 |
| `get_dumper(...)`               | 指定された型と形式のダンプクラスを返す | 確認 |
| `get_dumper_by_oid(...)`        | 指定されたOIDと形式のダンプクラスを返す | 確認 |
| `get_loader(...)`               | 指定されたOIDと形式のローダークラスを返す | 確認 |

#### `psycopg.adapt.Transformer` (クラス)

PythonとPostgreSQL間で効率的に型を適応させることができるオブジェクト。

| 名前                            | 説明 | サポート |
| :------------------------------ | :--- | :------: |
| `Transformer(...)` (クラス)     | PythonとPostgreSQL間で効率的に型を適応させる | 確認 |

### types (psycopg.types)

Types information and adapters。
PostgreSQL型を記述するオブジェクトを使用して型変換を支援またはカスタマイズ。  
直接的な Python 表現を持たないPostgreSQL データ型を表すヘルパー オブジェクト。

#### `psycopg.types.TypeInfo` (型情報クラス)

| 名前                            | 説明 | サポート |
| :------------------------------ | :--- | :------: |
| `TypeInfo(...)` (クラス)        | PostgreSQLの基本型に関する情報を保持する | 確認 |
| `fetch(...)` (クラスメソッド)   | システムカタログにクエリを実行して型に関する情報を読み取る | 確認 |
| `register(...)`                 | 型情報をグローバルに、または指定されたコンテキストに登録する | 確認 |

#### `psycopg.types.TypesRegistry` (型情報クラス)

| 名前                            | 説明 | サポート |
| :------------------------------ | :--- | :------: |
| `TypesRegistry(...)` (クラス)   | データベース内の型に関する情報のコンテナ | 確認 |
| `get(...)`                      | 名前またはOIDで指定された型に関する情報を返す | 確認 |
| `get_oid(...)`                  | 名前でPostgreSQL型のOIDを返す | 確認 |
| `get_by_subtype(...)`           | 要素名またはOIDで `TypeInfo` サブクラスに関する情報を返す | 確認 |

#### JSONアダプタ

| 名前                            | 説明 | サポート |
| :------------------------------ | :--- | :------: |
| `Json(...)` (クラス)            | `obj` を `json` PostgreSQL値に変換するようにシグナルを送るラッパー | 確認 |
| `Jsonb(...)` (クラス)           | `obj` を `jsonb` PostgreSQL値に変換するようにシグナルを送るラッパー | 確認 |
| `set_json_dumps(...)`           | JSONシリアル化関数を設定して、JSONオブジェクトをデータベースに保存する | 確認 |
| `set_json_loads(...)`           | JSON解析関数を設定して、JSONオブジェクトをデータベースからフェッチする | 確認 |

### abc (psycopg.abc)

Psycopg abstract classes。
PythonからPostgres、またはその逆に必要な変換を実行するための抽象クラス。

#### `psycopg.abc.Dumper` (プロトコル)

PythonオブジェクトをPostgreSQL表現に変換するための形式プロトコル。部分的な実装は `psycopg.adapt.Dumper` で利用可能。

| 名前                            | 説明 | サポート |
| :------------------------------ | :--- | :------: |
| `Dumper(...)` (クラス)          | PythonオブジェクトをPostgreSQL表現に変換する | 確認 |
| `format` (クラス属性)           | このクラスの `dump()` メソッドが生成する形式 (`TEXT` または `BINARY`) | 確認 |
| `dump(...)` (抽象メソッド)      | オブジェクトをPostgreSQL表現に変換する | 確認 |
| `quote(...)`                    | オブジェクトをエスケープされた表現に変換する | 確認 |
| `oid` (属性)                    | サーバーに渡すOID（既知の場合）。それ以外の場合は0 | 確認 |
| `get_key(...)`                  | `obj` を表すためにダンプをアップグレードする代替キーを返す | 確認 |
| `upgrade(...)`                  | `obj` を管理する新しいダンプを返す | 確認 |

#### `psycopg.abc.Loader` (プロトコル)

OID `oid` を持つPostgreSQL値をPythonオブジェクトに変換するための形式プロトコル。部分的な実装は `psycopg.adapt.Loader` で利用可能。

| 名前                            | 説明 | サポート |
| :------------------------------ | :--- | :------: |
| `Loader(...)` (クラス)          | OID `oid` を持つPostgreSQL値をPythonオブジェクトに変換する | 確認 |
| `format` (クラス属性)           | このクラスの `load()` メソッドが変換できる形式 (`TEXT` または `BINARY`) | 確認 |
| `load(...)` (抽象メソッド)      | データベースから返されたデータをPythonオブジェクトに変換する | 確認 |

#### `psycopg.abc.AdaptContext` (プロトコル)

型がどのように適応されるかを記述するコンテキストを表すプロトコル。`Connection`, `Cursor`, `Transformer`, `AdaptersMap` などがこのプロトコルを実装。

| 名前                            | 説明 | サポート |
| :------------------------------ | :--- | :------: |
| `AdaptContext(...)` (クラス)    | 型がどのように適応されるかを記述するコンテキストを表す | 確認 |
| `adapters` (プロパティ)         | このオブジェクトが使用するアダプター構成 | 確認 |
| `connection` (プロパティ)       | このオブジェクトが使用する接続（利用可能な場合） | 確認 |

### pq (psycopg.pq)

libpqラッパーモジュール。

### crdb (psycopg.crdb)

CockroachDBサポート（CockroachDBは、クラウドネイティブ環境向けに設計されたオープンソースの分散SQLデータベース）。

### _dns (psycopg._dns)

接続する前にDNSを解決するためのユーティリティ。

以上
