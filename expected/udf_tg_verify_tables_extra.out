/* Test case: extra path - UDF tg_verify_tables() */
-- Test case: 3-5-1
--- Test setup: DDL of the Tsurugi
SELECT tg_execute_ddl('
  CREATE TABLE udf_test_table_int (col INT)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE udf_test_table_bigint (col BIGINT)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE udf_test_table_real (col REAL)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE udf_test_table_float (col FLOAT)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE udf_test_table_double (col DOUBLE)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE udf_test_table_double_precision (col DOUBLE PRECISION)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE udf_test_table_decimal (col DECIMAL)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE udf_test_table_decimal_p (col DECIMAL(5))
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE udf_test_table_decimal_ps (col DECIMAL(5, 1))
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE udf_test_table_decimal_max (col DECIMAL(*))
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

--- Test setup: DDL of the PostgreSQL
CREATE FOREIGN TABLE udf_test_table_int (
  col integer
) SERVER tsurugidb;
CREATE FOREIGN TABLE udf_test_table_bigint (
  col bigint
) SERVER tsurugidb;
CREATE FOREIGN TABLE udf_test_table_real (
  col real
) SERVER tsurugidb;
CREATE FOREIGN TABLE udf_test_table_float (
  col real
) SERVER tsurugidb;
CREATE FOREIGN TABLE udf_test_table_double (
  col double precision
) SERVER tsurugidb;
CREATE FOREIGN TABLE udf_test_table_double_precision (
  col double precision
) SERVER tsurugidb;
CREATE FOREIGN TABLE udf_test_table_decimal (
  col numeric
) SERVER tsurugidb;
CREATE FOREIGN TABLE udf_test_table_decimal_p (
  col numeric
) SERVER tsurugidb;
CREATE FOREIGN TABLE udf_test_table_decimal_ps (
  col numeric
) SERVER tsurugidb;
CREATE FOREIGN TABLE udf_test_table_decimal_max (
  col numeric
) SERVER tsurugidb;
--- Test
SELECT tg_verify_tables('tg_schema', 'tsurugidb', 'public', 'detail', true);
                  tg_verify_tables                  
----------------------------------------------------
 {                                                 +
     "verification": {                             +
         "remote_schema": "tg_schema",             +
         "server_name": "tsurugidb",               +
         "local_schema": "public",                 +
         "mode": "detail",                         +
         "tables_on_only_remote_schema": {         +
             "count": 0,                           +
             "list": []                            +
         },                                        +
         "foreign_tables_on_only_local_schema": {  +
             "count": 0,                           +
             "list": []                            +
         },                                        +
         "tables_that_need_to_be_altered": {       +
             "count": 0,                           +
             "list": []                            +
         },                                        +
         "available_foreign_table": {              +
             "count": 10,                          +
             "list": [                             +
                 "udf_test_table_bigint",          +
                 "udf_test_table_decimal",         +
                 "udf_test_table_decimal_max",     +
                 "udf_test_table_decimal_p",       +
                 "udf_test_table_decimal_ps",      +
                 "udf_test_table_double",          +
                 "udf_test_table_double_precision",+
                 "udf_test_table_float",           +
                 "udf_test_table_int",             +
                 "udf_test_table_real"             +
             ]                                     +
         }                                         +
     }                                             +
 }
(1 row)

--- Test teardown: DDL of the PostgreSQL
DROP FOREIGN TABLE udf_test_table_int;
DROP FOREIGN TABLE udf_test_table_bigint;
DROP FOREIGN TABLE udf_test_table_real;
DROP FOREIGN TABLE udf_test_table_float;
DROP FOREIGN TABLE udf_test_table_double;
DROP FOREIGN TABLE udf_test_table_double_precision;
DROP FOREIGN TABLE udf_test_table_decimal;
DROP FOREIGN TABLE udf_test_table_decimal_p;
DROP FOREIGN TABLE udf_test_table_decimal_ps;
DROP FOREIGN TABLE udf_test_table_decimal_max;
--- Test teardown: DDL of the Tsurugi
SELECT tg_execute_ddl('DROP TABLE udf_test_table_int', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE udf_test_table_bigint', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE udf_test_table_real', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE udf_test_table_float', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE udf_test_table_double', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE udf_test_table_double_precision', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE udf_test_table_decimal', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE udf_test_table_decimal_p', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE udf_test_table_decimal_ps', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE udf_test_table_decimal_max', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

-- Test case: 3-5-2
--- Test setup: DDL of the Tsurugi
SELECT tg_execute_ddl('
  CREATE TABLE udf_test_table_char (col CHAR)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE udf_test_table_char_len (col CHAR(64))
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE udf_test_table_character (col CHARACTER)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE udf_test_table_character_len (col CHARACTER(64))
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE udf_test_table_varchar (col VARCHAR)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE udf_test_table_varchar_len (col VARCHAR(64))
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE udf_test_table_char_varying (col CHAR VARYING)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE udf_test_table_char_varying_len (col CHAR VARYING(64))
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE udf_test_table_character_varying (col CHARACTER VARYING)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE udf_test_table_character_varying_len (col CHARACTER VARYING(64))
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

--- Test setup: DDL of the PostgreSQL
CREATE FOREIGN TABLE udf_test_table_char (
  col text
) SERVER tsurugidb;
CREATE FOREIGN TABLE udf_test_table_char_len (
  col text
) SERVER tsurugidb;
CREATE FOREIGN TABLE udf_test_table_character (
  col text
) SERVER tsurugidb;
CREATE FOREIGN TABLE udf_test_table_character_len (
  col text
) SERVER tsurugidb;
CREATE FOREIGN TABLE udf_test_table_varchar (
  col text
) SERVER tsurugidb;
CREATE FOREIGN TABLE udf_test_table_varchar_len (
  col text
) SERVER tsurugidb;
CREATE FOREIGN TABLE udf_test_table_char_varying (
  col text
) SERVER tsurugidb;
CREATE FOREIGN TABLE udf_test_table_char_varying_len (
  col text
) SERVER tsurugidb;
CREATE FOREIGN TABLE udf_test_table_character_varying (
  col text
) SERVER tsurugidb;
CREATE FOREIGN TABLE udf_test_table_character_varying_len (
  col text
) SERVER tsurugidb;
--- Test
SELECT tg_verify_tables('tg_schema', 'tsurugidb', 'public', 'detail', true);
                    tg_verify_tables                     
---------------------------------------------------------
 {                                                      +
     "verification": {                                  +
         "remote_schema": "tg_schema",                  +
         "server_name": "tsurugidb",                    +
         "local_schema": "public",                      +
         "mode": "detail",                              +
         "tables_on_only_remote_schema": {              +
             "count": 0,                                +
             "list": []                                 +
         },                                             +
         "foreign_tables_on_only_local_schema": {       +
             "count": 0,                                +
             "list": []                                 +
         },                                             +
         "tables_that_need_to_be_altered": {            +
             "count": 0,                                +
             "list": []                                 +
         },                                             +
         "available_foreign_table": {                   +
             "count": 10,                               +
             "list": [                                  +
                 "udf_test_table_char",                 +
                 "udf_test_table_char_len",             +
                 "udf_test_table_char_varying",         +
                 "udf_test_table_char_varying_len",     +
                 "udf_test_table_character",            +
                 "udf_test_table_character_len",        +
                 "udf_test_table_character_varying",    +
                 "udf_test_table_character_varying_len",+
                 "udf_test_table_varchar",              +
                 "udf_test_table_varchar_len"           +
             ]                                          +
         }                                              +
     }                                                  +
 }
(1 row)

--- Test teardown: DDL of the PostgreSQL
DROP FOREIGN TABLE udf_test_table_char;
DROP FOREIGN TABLE udf_test_table_char_len;
DROP FOREIGN TABLE udf_test_table_character;
DROP FOREIGN TABLE udf_test_table_character_len;
DROP FOREIGN TABLE udf_test_table_varchar;
DROP FOREIGN TABLE udf_test_table_varchar_len;
DROP FOREIGN TABLE udf_test_table_char_varying;
DROP FOREIGN TABLE udf_test_table_char_varying_len;
DROP FOREIGN TABLE udf_test_table_character_varying;
DROP FOREIGN TABLE udf_test_table_character_varying_len;
--- Test teardown: DDL of the Tsurugi
SELECT tg_execute_ddl('DROP TABLE udf_test_table_char', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE udf_test_table_char_len', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE udf_test_table_character', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE udf_test_table_character_len', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE udf_test_table_varchar', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE udf_test_table_varchar_len', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE udf_test_table_char_varying', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE udf_test_table_char_varying_len', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE udf_test_table_character_varying', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE udf_test_table_character_varying_len', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

-- Test case: 3-5-3
--- Test setup: DDL of the Tsurugi
SELECT tg_execute_ddl('
  CREATE TABLE udf_test_table_date (col DATE)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE udf_test_table_time (col TIME)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE udf_test_table_time_without_time_zone (col TIME)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE udf_test_table_timestamp (col TIMESTAMP)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE udf_test_table_timestamp_without_time_zone (col TIMESTAMP)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE udf_test_table_timetz (col TIME WITH TIME ZONE)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE udf_test_table_time_with_time_zone (col TIME WITH TIME ZONE)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE udf_test_table_timestamptz (col TIMESTAMP WITH TIME ZONE)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE udf_test_table_timestamp_with_time_zone (col TIMESTAMP WITH TIME ZONE)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

--- Test setup: DDL of the PostgreSQL
CREATE FOREIGN TABLE udf_test_table_date (
  col date
) SERVER tsurugidb;
CREATE FOREIGN TABLE udf_test_table_time (
  col time
) SERVER tsurugidb;
CREATE FOREIGN TABLE udf_test_table_time_without_time_zone (
  col time without time zone
) SERVER tsurugidb;
CREATE FOREIGN TABLE udf_test_table_timestamp (
  col timestamp
) SERVER tsurugidb;
CREATE FOREIGN TABLE udf_test_table_timestamp_without_time_zone (
  col timestamp without time zone
) SERVER tsurugidb;
CREATE FOREIGN TABLE udf_test_table_timetz (
  col timetz
) SERVER tsurugidb;
CREATE FOREIGN TABLE udf_test_table_time_with_time_zone (
  col time with time zone
) SERVER tsurugidb;
CREATE FOREIGN TABLE udf_test_table_timestamptz (
  col timestamptz
) SERVER tsurugidb;
CREATE FOREIGN TABLE udf_test_table_timestamp_with_time_zone (
  col timestamp with time zone
) SERVER tsurugidb;
--- Test
SELECT tg_verify_tables('tg_schema', 'tsurugidb', 'public', 'detail', true);
                       tg_verify_tables                        
---------------------------------------------------------------
 {                                                            +
     "verification": {                                        +
         "remote_schema": "tg_schema",                        +
         "server_name": "tsurugidb",                          +
         "local_schema": "public",                            +
         "mode": "detail",                                    +
         "tables_on_only_remote_schema": {                    +
             "count": 0,                                      +
             "list": []                                       +
         },                                                   +
         "foreign_tables_on_only_local_schema": {             +
             "count": 0,                                      +
             "list": []                                       +
         },                                                   +
         "tables_that_need_to_be_altered": {                  +
             "count": 0,                                      +
             "list": []                                       +
         },                                                   +
         "available_foreign_table": {                         +
             "count": 9,                                      +
             "list": [                                        +
                 "udf_test_table_date",                       +
                 "udf_test_table_time",                       +
                 "udf_test_table_time_with_time_zone",        +
                 "udf_test_table_time_without_time_zone",     +
                 "udf_test_table_timestamp",                  +
                 "udf_test_table_timestamp_with_time_zone",   +
                 "udf_test_table_timestamp_without_time_zone",+
                 "udf_test_table_timestamptz",                +
                 "udf_test_table_timetz"                      +
             ]                                                +
         }                                                    +
     }                                                        +
 }
(1 row)

--- Test teardown: DDL of the PostgreSQL
DROP FOREIGN TABLE udf_test_table_date;
DROP FOREIGN TABLE udf_test_table_time;
DROP FOREIGN TABLE udf_test_table_time_without_time_zone;
DROP FOREIGN TABLE udf_test_table_timestamp;
DROP FOREIGN TABLE udf_test_table_timestamp_without_time_zone;
DROP FOREIGN TABLE udf_test_table_timetz;
DROP FOREIGN TABLE udf_test_table_time_with_time_zone;
DROP FOREIGN TABLE udf_test_table_timestamptz;
DROP FOREIGN TABLE udf_test_table_timestamp_with_time_zone;
--- Test teardown: DDL of the Tsurugi
SELECT tg_execute_ddl('DROP TABLE udf_test_table_date', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE udf_test_table_time', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE udf_test_table_time_without_time_zone', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE udf_test_table_timestamp', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE udf_test_table_timestamp_without_time_zone', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE udf_test_table_timetz', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE udf_test_table_time_with_time_zone', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE udf_test_table_timestamptz', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE udf_test_table_timestamp_with_time_zone', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

-- Test case: 3-5-4
--- Test setup: DDL of the Tsurugi
SELECT tg_execute_ddl('
  CREATE TABLE udf_test_table_int (col INT)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE udf_test_table_bigint (col BIGINT)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE udf_test_table_real (col REAL)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE udf_test_table_float (col FLOAT)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE udf_test_table_double (col DOUBLE)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE udf_test_table_double_precision (col DOUBLE PRECISION)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE udf_test_table_decimal (col DECIMAL)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE udf_test_table_decimal_p (col DECIMAL(5))
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE udf_test_table_decimal_ps (col DECIMAL(5, 1))
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE udf_test_table_decimal_max (col DECIMAL(*))
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE udf_test_table_decimal_p2 (col DECIMAL(5))
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE udf_test_table_decimal_ps2 (col DECIMAL(5, 1))
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

--- Test setup: DDL of the PostgreSQL
CREATE FOREIGN TABLE udf_test_table_int (
  col numeric
) SERVER tsurugidb;
CREATE FOREIGN TABLE udf_test_table_bigint (
  col numeric
) SERVER tsurugidb;
CREATE FOREIGN TABLE udf_test_table_real (
  col numeric
) SERVER tsurugidb;
CREATE FOREIGN TABLE udf_test_table_float (
  col numeric
) SERVER tsurugidb;
CREATE FOREIGN TABLE udf_test_table_double (
  col numeric
) SERVER tsurugidb;
CREATE FOREIGN TABLE udf_test_table_double_precision (
  col numeric
) SERVER tsurugidb;
CREATE FOREIGN TABLE udf_test_table_decimal (
  col integer
) SERVER tsurugidb;
CREATE FOREIGN TABLE udf_test_table_decimal_p (
  col integer
) SERVER tsurugidb;
CREATE FOREIGN TABLE udf_test_table_decimal_ps (
  col integer
) SERVER tsurugidb;
CREATE FOREIGN TABLE udf_test_table_decimal_max (
  col integer
) SERVER tsurugidb;
CREATE FOREIGN TABLE udf_test_table_decimal_p2 (
  col numeric(5)
) SERVER tsurugidb;
CREATE FOREIGN TABLE udf_test_table_decimal_ps2 (
  col numeric(5, 1)
) SERVER tsurugidb;
--- Test
SELECT tg_verify_tables('tg_schema', 'tsurugidb', 'public', 'detail', true);
                  tg_verify_tables                  
----------------------------------------------------
 {                                                 +
     "verification": {                             +
         "remote_schema": "tg_schema",             +
         "server_name": "tsurugidb",               +
         "local_schema": "public",                 +
         "mode": "detail",                         +
         "tables_on_only_remote_schema": {         +
             "count": 0,                           +
             "list": []                            +
         },                                        +
         "foreign_tables_on_only_local_schema": {  +
             "count": 0,                           +
             "list": []                            +
         },                                        +
         "tables_that_need_to_be_altered": {       +
             "count": 12,                          +
             "list": [                             +
                 "udf_test_table_bigint",          +
                 "udf_test_table_decimal",         +
                 "udf_test_table_decimal_max",     +
                 "udf_test_table_decimal_p",       +
                 "udf_test_table_decimal_p2",      +
                 "udf_test_table_decimal_ps",      +
                 "udf_test_table_decimal_ps2",     +
                 "udf_test_table_double",          +
                 "udf_test_table_double_precision",+
                 "udf_test_table_float",           +
                 "udf_test_table_int",             +
                 "udf_test_table_real"             +
             ]                                     +
         },                                        +
         "available_foreign_table": {              +
             "count": 0,                           +
             "list": []                            +
         }                                         +
     }                                             +
 }
(1 row)

--- Test teardown: DDL of the PostgreSQL
DROP FOREIGN TABLE udf_test_table_int;
DROP FOREIGN TABLE udf_test_table_bigint;
DROP FOREIGN TABLE udf_test_table_real;
DROP FOREIGN TABLE udf_test_table_float;
DROP FOREIGN TABLE udf_test_table_double;
DROP FOREIGN TABLE udf_test_table_double_precision;
DROP FOREIGN TABLE udf_test_table_decimal;
DROP FOREIGN TABLE udf_test_table_decimal_p;
DROP FOREIGN TABLE udf_test_table_decimal_ps;
DROP FOREIGN TABLE udf_test_table_decimal_max;
DROP FOREIGN TABLE udf_test_table_decimal_p2;
DROP FOREIGN TABLE udf_test_table_decimal_ps2;
--- Test teardown: DDL of the Tsurugi
SELECT tg_execute_ddl('DROP TABLE udf_test_table_int', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE udf_test_table_bigint', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE udf_test_table_real', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE udf_test_table_float', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE udf_test_table_double', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE udf_test_table_double_precision', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE udf_test_table_decimal', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE udf_test_table_decimal_p', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE udf_test_table_decimal_ps', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE udf_test_table_decimal_max', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE udf_test_table_decimal_p2', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE udf_test_table_decimal_ps2', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

-- Test case: 3-5-5
--- Test setup: DDL of the Tsurugi
SELECT tg_execute_ddl('
  CREATE TABLE udf_test_table_char (col CHAR)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE udf_test_table_char_l (col CHAR(64))
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE udf_test_table_character (col CHARACTER)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE udf_test_table_character_l (col CHARACTER(64))
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE udf_test_table_varchar (col VARCHAR)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE udf_test_table_varchar_l (col VARCHAR(64))
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE udf_test_table_char_varying (col CHAR VARYING)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE udf_test_table_char_varying_l (col CHAR VARYING(64))
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE udf_test_table_character_varying (col CHARACTER VARYING)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE udf_test_table_character_varying_l (col CHARACTER VARYING(64))
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

--- Test setup: DDL of the PostgreSQL
CREATE FOREIGN TABLE udf_test_table_char (
  col character
) SERVER tsurugidb;
CREATE FOREIGN TABLE udf_test_table_char_l (
  col character(64)
) SERVER tsurugidb;
CREATE FOREIGN TABLE udf_test_table_character (
  col character
) SERVER tsurugidb;
CREATE FOREIGN TABLE udf_test_table_character_l (
  col character(64)
) SERVER tsurugidb;
CREATE FOREIGN TABLE udf_test_table_varchar (
  col varchar
) SERVER tsurugidb;
CREATE FOREIGN TABLE udf_test_table_varchar_l (
  col varchar(64)
) SERVER tsurugidb;
CREATE FOREIGN TABLE udf_test_table_char_varying (
  col varchar
) SERVER tsurugidb;
CREATE FOREIGN TABLE udf_test_table_char_varying_l (
  col varchar(64)
) SERVER tsurugidb;
CREATE FOREIGN TABLE udf_test_table_character_varying (
  col varchar
) SERVER tsurugidb;
CREATE FOREIGN TABLE udf_test_table_character_varying_l (
  col varchar(64)
) SERVER tsurugidb;
--- Test
SELECT tg_verify_tables('tg_schema', 'tsurugidb', 'public', 'detail', true);
                   tg_verify_tables                    
-------------------------------------------------------
 {                                                    +
     "verification": {                                +
         "remote_schema": "tg_schema",                +
         "server_name": "tsurugidb",                  +
         "local_schema": "public",                    +
         "mode": "detail",                            +
         "tables_on_only_remote_schema": {            +
             "count": 0,                              +
             "list": []                               +
         },                                           +
         "foreign_tables_on_only_local_schema": {     +
             "count": 0,                              +
             "list": []                               +
         },                                           +
         "tables_that_need_to_be_altered": {          +
             "count": 10,                             +
             "list": [                                +
                 "udf_test_table_char",               +
                 "udf_test_table_char_l",             +
                 "udf_test_table_char_varying",       +
                 "udf_test_table_char_varying_l",     +
                 "udf_test_table_character",          +
                 "udf_test_table_character_l",        +
                 "udf_test_table_character_varying",  +
                 "udf_test_table_character_varying_l",+
                 "udf_test_table_varchar",            +
                 "udf_test_table_varchar_l"           +
             ]                                        +
         },                                           +
         "available_foreign_table": {                 +
             "count": 0,                              +
             "list": []                               +
         }                                            +
     }                                                +
 }
(1 row)

--- Test teardown: DDL of the PostgreSQL
DROP FOREIGN TABLE udf_test_table_char;
DROP FOREIGN TABLE udf_test_table_char_l;
DROP FOREIGN TABLE udf_test_table_character;
DROP FOREIGN TABLE udf_test_table_character_l;
DROP FOREIGN TABLE udf_test_table_varchar;
DROP FOREIGN TABLE udf_test_table_varchar_l;
DROP FOREIGN TABLE udf_test_table_char_varying;
DROP FOREIGN TABLE udf_test_table_char_varying_l;
DROP FOREIGN TABLE udf_test_table_character_varying;
DROP FOREIGN TABLE udf_test_table_character_varying_l;
--- Test teardown: DDL of the Tsurugi
SELECT tg_execute_ddl('DROP TABLE udf_test_table_char', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE udf_test_table_char_l', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE udf_test_table_character', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE udf_test_table_character_l', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE udf_test_table_varchar', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE udf_test_table_varchar_l', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE udf_test_table_char_varying', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE udf_test_table_char_varying_l', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE udf_test_table_character_varying', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE udf_test_table_character_varying_l', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

-- Test case: 3-5-6
--- Test setup: DDL of the Tsurugi
SELECT tg_execute_ddl('
  CREATE TABLE udf_test_table_date (col DATE)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE udf_test_table_time (col TIME)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE udf_test_table_timestamp (col TIMESTAMP)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE udf_test_table_time_with_time_zone (col TIME WITH TIME ZONE)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE udf_test_table_timestamp_with_time_zone (col TIMESTAMP WITH TIME ZONE)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE udf_test_table_time_p (col TIME)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE udf_test_table_timestamp_p (col TIMESTAMP)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE udf_test_table_time_with_time_zone_p (col TIME WITH TIME ZONE)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE udf_test_table_timestamp_with_time_zone_p (col TIMESTAMP WITH TIME ZONE)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

--- Test setup: DDL of the PostgreSQL
CREATE FOREIGN TABLE udf_test_table_date (
  col time
) SERVER tsurugidb;
CREATE FOREIGN TABLE udf_test_table_time (
  col time with time zone
) SERVER tsurugidb;
CREATE FOREIGN TABLE udf_test_table_timestamp (
  col timestamp with time zone
) SERVER tsurugidb;
CREATE FOREIGN TABLE udf_test_table_time_with_time_zone (
  col time
) SERVER tsurugidb;
CREATE FOREIGN TABLE udf_test_table_timestamp_with_time_zone (
  col timestamp
) SERVER tsurugidb;
CREATE FOREIGN TABLE udf_test_table_time_p (
  col time(3)
) SERVER tsurugidb;
CREATE FOREIGN TABLE udf_test_table_timestamp_p (
  col timestamp(3)
) SERVER tsurugidb;
CREATE FOREIGN TABLE udf_test_table_time_with_time_zone_p (
  col time(3) with time zone
) SERVER tsurugidb;
CREATE FOREIGN TABLE udf_test_table_timestamp_with_time_zone_p (
  col timestamp(3) with time zone
) SERVER tsurugidb;
--- Test
SELECT tg_verify_tables('tg_schema', 'tsurugidb', 'public', 'detail', true);
                      tg_verify_tables                       
-------------------------------------------------------------
 {                                                          +
     "verification": {                                      +
         "remote_schema": "tg_schema",                      +
         "server_name": "tsurugidb",                        +
         "local_schema": "public",                          +
         "mode": "detail",                                  +
         "tables_on_only_remote_schema": {                  +
             "count": 0,                                    +
             "list": []                                     +
         },                                                 +
         "foreign_tables_on_only_local_schema": {           +
             "count": 0,                                    +
             "list": []                                     +
         },                                                 +
         "tables_that_need_to_be_altered": {                +
             "count": 9,                                    +
             "list": [                                      +
                 "udf_test_table_date",                     +
                 "udf_test_table_time",                     +
                 "udf_test_table_time_p",                   +
                 "udf_test_table_time_with_time_zone",      +
                 "udf_test_table_time_with_time_zone_p",    +
                 "udf_test_table_timestamp",                +
                 "udf_test_table_timestamp_p",              +
                 "udf_test_table_timestamp_with_time_zone", +
                 "udf_test_table_timestamp_with_time_zone_p"+
             ]                                              +
         },                                                 +
         "available_foreign_table": {                       +
             "count": 0,                                    +
             "list": []                                     +
         }                                                  +
     }                                                      +
 }
(1 row)

--- Test teardown: DDL of the PostgreSQL
DROP FOREIGN TABLE udf_test_table_date;
DROP FOREIGN TABLE udf_test_table_time;
DROP FOREIGN TABLE udf_test_table_timestamp;
DROP FOREIGN TABLE udf_test_table_time_with_time_zone;
DROP FOREIGN TABLE udf_test_table_timestamp_with_time_zone;
DROP FOREIGN TABLE udf_test_table_time_p;
DROP FOREIGN TABLE udf_test_table_timestamp_p;
DROP FOREIGN TABLE udf_test_table_time_with_time_zone_p;
DROP FOREIGN TABLE udf_test_table_timestamp_with_time_zone_p;
--- Test teardown: DDL of the Tsurugi
SELECT tg_execute_ddl('DROP TABLE udf_test_table_date', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE udf_test_table_time', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE udf_test_table_timestamp', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE udf_test_table_time_with_time_zone', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE udf_test_table_timestamp_with_time_zone', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE udf_test_table_time_p', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE udf_test_table_timestamp_p', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE udf_test_table_time_with_time_zone_p', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE udf_test_table_timestamp_with_time_zone_p', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

-- Test case: 3-5-7
--- Test setup: DDL of the Tsurugi
SELECT tg_execute_ddl('
  CREATE TABLE udf_test_table_binary (col BINARY)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE udf_test_table_binary_l (col BINARY(64))
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE udf_test_table_varbinary (col VARBINARY)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE udf_test_table_varbinary_l (col VARBINARY(64))
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE udf_test_table_binary_varying (col BINARY VARYING)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE udf_test_table_binary_varying_l (col BINARY VARYING(64))
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

--- Test setup: DDL of the PostgreSQL
CREATE FOREIGN TABLE udf_test_table_binary (
  col bytea
) SERVER tsurugidb;
CREATE FOREIGN TABLE udf_test_table_binary_l (
  col bytea
) SERVER tsurugidb;
CREATE FOREIGN TABLE udf_test_table_varbinary (
  col bytea
) SERVER tsurugidb;
CREATE FOREIGN TABLE udf_test_table_varbinary_l (
  col bytea
) SERVER tsurugidb;
CREATE FOREIGN TABLE udf_test_table_binary_varying (
  col bytea
) SERVER tsurugidb;
CREATE FOREIGN TABLE udf_test_table_binary_varying_l (
  col bytea
) SERVER tsurugidb;
--- Test
SELECT tg_verify_tables('tg_schema', 'tsurugidb', 'public', 'detail', true);
                  tg_verify_tables                  
----------------------------------------------------
 {                                                 +
     "verification": {                             +
         "remote_schema": "tg_schema",             +
         "server_name": "tsurugidb",               +
         "local_schema": "public",                 +
         "mode": "detail",                         +
         "tables_on_only_remote_schema": {         +
             "count": 0,                           +
             "list": []                            +
         },                                        +
         "foreign_tables_on_only_local_schema": {  +
             "count": 0,                           +
             "list": []                            +
         },                                        +
         "tables_that_need_to_be_altered": {       +
             "count": 0,                           +
             "list": []                            +
         },                                        +
         "available_foreign_table": {              +
             "count": 6,                           +
             "list": [                             +
                 "udf_test_table_binary",          +
                 "udf_test_table_binary_l",        +
                 "udf_test_table_binary_varying",  +
                 "udf_test_table_binary_varying_l",+
                 "udf_test_table_varbinary",       +
                 "udf_test_table_varbinary_l"      +
             ]                                     +
         }                                         +
     }                                             +
 }
(1 row)

--- Test teardown: DDL of the PostgreSQL
DROP FOREIGN TABLE udf_test_table_binary;
DROP FOREIGN TABLE udf_test_table_binary_l;
DROP FOREIGN TABLE udf_test_table_varbinary;
DROP FOREIGN TABLE udf_test_table_varbinary_l;
DROP FOREIGN TABLE udf_test_table_binary_varying;
DROP FOREIGN TABLE udf_test_table_binary_varying_l;
--- Test teardown: DDL of the Tsurugi
SELECT tg_execute_ddl('DROP TABLE udf_test_table_binary', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE udf_test_table_binary_l', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE udf_test_table_varbinary', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE udf_test_table_varbinary_l', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE udf_test_table_binary_varying', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE udf_test_table_binary_varying_l', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

-- Test case: 3-5-8
--- Test setup: DDL of the Tsurugi
SELECT tg_execute_ddl('
  CREATE TABLE udf_test_table_binary (col BINARY)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE udf_test_table_binary_l (col BINARY(64))
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE udf_test_table_varbinary (col VARBINARY)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE udf_test_table_varbinary_l (col VARBINARY(64))
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE udf_test_table_binary_varying (col BINARY VARYING)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE udf_test_table_binary_varying_l (col BINARY VARYING(64))
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

--- Test setup: DDL of the PostgreSQL
CREATE FOREIGN TABLE udf_test_table_binary (
  col varchar
) SERVER tsurugidb;
CREATE FOREIGN TABLE udf_test_table_binary_l (
  col varchar
) SERVER tsurugidb;
CREATE FOREIGN TABLE udf_test_table_varbinary (
  col varchar
) SERVER tsurugidb;
CREATE FOREIGN TABLE udf_test_table_varbinary_l (
  col varchar
) SERVER tsurugidb;
CREATE FOREIGN TABLE udf_test_table_binary_varying (
  col varchar
) SERVER tsurugidb;
CREATE FOREIGN TABLE udf_test_table_binary_varying_l (
  col varchar
) SERVER tsurugidb;
--- Test
SELECT tg_verify_tables('tg_schema', 'tsurugidb', 'public', 'detail', true);
                  tg_verify_tables                  
----------------------------------------------------
 {                                                 +
     "verification": {                             +
         "remote_schema": "tg_schema",             +
         "server_name": "tsurugidb",               +
         "local_schema": "public",                 +
         "mode": "detail",                         +
         "tables_on_only_remote_schema": {         +
             "count": 0,                           +
             "list": []                            +
         },                                        +
         "foreign_tables_on_only_local_schema": {  +
             "count": 0,                           +
             "list": []                            +
         },                                        +
         "tables_that_need_to_be_altered": {       +
             "count": 6,                           +
             "list": [                             +
                 "udf_test_table_binary",          +
                 "udf_test_table_binary_l",        +
                 "udf_test_table_binary_varying",  +
                 "udf_test_table_binary_varying_l",+
                 "udf_test_table_varbinary",       +
                 "udf_test_table_varbinary_l"      +
             ]                                     +
         },                                        +
         "available_foreign_table": {              +
             "count": 0,                           +
             "list": []                            +
         }                                         +
     }                                             +
 }
(1 row)

--- Test teardown: DDL of the PostgreSQL
DROP FOREIGN TABLE udf_test_table_binary;
DROP FOREIGN TABLE udf_test_table_binary_l;
DROP FOREIGN TABLE udf_test_table_varbinary;
DROP FOREIGN TABLE udf_test_table_varbinary_l;
DROP FOREIGN TABLE udf_test_table_binary_varying;
DROP FOREIGN TABLE udf_test_table_binary_varying_l;
--- Test teardown: DDL of the Tsurugi
SELECT tg_execute_ddl('DROP TABLE udf_test_table_binary', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE udf_test_table_binary_l', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE udf_test_table_varbinary', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE udf_test_table_varbinary_l', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE udf_test_table_binary_varying', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE udf_test_table_binary_varying_l', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

-- Test case: 3-5-9
--- Test setup: DDL of the Tsurugi
SELECT tg_execute_ddl('
  CREATE TABLE udf_test_table_boolean (col INT)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE udf_test_table_smallint (col INT)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE udf_test_table_numeric_p (col DECIMAL(5))
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE udf_test_table_varchar (col VARCHAR)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE udf_test_table_char (col CHAR)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

--- Test setup: DDL of the PostgreSQL
CREATE FOREIGN TABLE udf_test_table_boolean (
  col boolean
) SERVER tsurugidb;
CREATE FOREIGN TABLE udf_test_table_smallint (
  col smallint
) SERVER tsurugidb;
CREATE FOREIGN TABLE udf_test_table_numeric_p (col numeric(
  5)
) SERVER tsurugidb;
CREATE FOREIGN TABLE udf_test_table_varchar (
  col varchar
) SERVER tsurugidb;
CREATE FOREIGN TABLE udf_test_table_char (
  col char
) SERVER tsurugidb;
--- Test
SELECT tg_verify_tables('tg_schema', 'tsurugidb', 'public', 'detail', true);
                 tg_verify_tables                 
--------------------------------------------------
 {                                               +
     "verification": {                           +
         "remote_schema": "tg_schema",           +
         "server_name": "tsurugidb",             +
         "local_schema": "public",               +
         "mode": "detail",                       +
         "tables_on_only_remote_schema": {       +
             "count": 0,                         +
             "list": []                          +
         },                                      +
         "foreign_tables_on_only_local_schema": {+
             "count": 0,                         +
             "list": []                          +
         },                                      +
         "tables_that_need_to_be_altered": {     +
             "count": 5,                         +
             "list": [                           +
                 "udf_test_table_boolean",       +
                 "udf_test_table_char",          +
                 "udf_test_table_numeric_p",     +
                 "udf_test_table_smallint",      +
                 "udf_test_table_varchar"        +
             ]                                   +
         },                                      +
         "available_foreign_table": {            +
             "count": 0,                         +
             "list": []                          +
         }                                       +
     }                                           +
 }
(1 row)

--- Test teardown: DDL of the PostgreSQL
DROP FOREIGN TABLE udf_test_table_boolean;
DROP FOREIGN TABLE udf_test_table_smallint;
DROP FOREIGN TABLE udf_test_table_numeric_p;
DROP FOREIGN TABLE udf_test_table_varchar;
DROP FOREIGN TABLE udf_test_table_char;
--- Test teardown: DDL of the Tsurugi
SELECT tg_execute_ddl('DROP TABLE udf_test_table_boolean', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE udf_test_table_smallint', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE udf_test_table_numeric_p', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE udf_test_table_varchar', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE udf_test_table_char', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

-- Test case: 4-5-1
--- Test setup: DDL of the Tsurugi
SELECT tg_execute_ddl('
  CREATE TABLE udf_test_table_1 (id INT, name CHAR(64))
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

--- Test setup: DDL of the PostgreSQL
CREATE FOREIGN TABLE udf_test_table_1 (
  id integer, name text
) SERVER tsurugidb;
--- Test
SELECT tg_verify_tables('tg_schema', 'tsurugidb', 'public', 'summary', True);
                 tg_verify_tables                 
--------------------------------------------------
 {                                               +
     "verification": {                           +
         "remote_schema": "tg_schema",           +
         "server_name": "tsurugidb",             +
         "local_schema": "public",               +
         "mode": "summary",                      +
         "tables_on_only_remote_schema": {       +
             "count": 0                          +
         },                                      +
         "foreign_tables_on_only_local_schema": {+
             "count": 0                          +
         },                                      +
         "tables_that_need_to_be_altered": {     +
             "count": 0                          +
         },                                      +
         "available_foreign_table": {            +
             "count": 1                          +
         }                                       +
     }                                           +
 }
(1 row)

SELECT tg_verify_tables('tg_schema', 'tsurugidb', 'public', 'summary', TRUE);
                 tg_verify_tables                 
--------------------------------------------------
 {                                               +
     "verification": {                           +
         "remote_schema": "tg_schema",           +
         "server_name": "tsurugidb",             +
         "local_schema": "public",               +
         "mode": "summary",                      +
         "tables_on_only_remote_schema": {       +
             "count": 0                          +
         },                                      +
         "foreign_tables_on_only_local_schema": {+
             "count": 0                          +
         },                                      +
         "tables_that_need_to_be_altered": {     +
             "count": 0                          +
         },                                      +
         "available_foreign_table": {            +
             "count": 1                          +
         }                                       +
     }                                           +
 }
(1 row)

SELECT tg_verify_tables('tg_schema', 'tsurugidb', 'public', 'summary', False);
                                                                                                                                         tg_verify_tables                                                                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"verification":{"remote_schema":"tg_schema","server_name":"tsurugidb","local_schema":"public","mode":"summary","tables_on_only_remote_schema":{"count":0},"foreign_tables_on_only_local_schema":{"count":0},"tables_that_need_to_be_altered":{"count":0},"available_foreign_table":{"count":1}}}
(1 row)

SELECT tg_verify_tables('tg_schema', 'tsurugidb', 'public', 'summary', FALSE);
                                                                                                                                         tg_verify_tables                                                                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"verification":{"remote_schema":"tg_schema","server_name":"tsurugidb","local_schema":"public","mode":"summary","tables_on_only_remote_schema":{"count":0},"foreign_tables_on_only_local_schema":{"count":0},"tables_that_need_to_be_altered":{"count":0},"available_foreign_table":{"count":1}}}
(1 row)

--- Test teardown: DDL of the PostgreSQL
DROP FOREIGN TABLE udf_test_table_1;
--- Test teardown: DDL of the Tsurugi
SELECT tg_execute_ddl('DROP TABLE udf_test_table_1', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

-- Test case: 4-5-2
--- Test setup: DDL of the Tsurugi
SELECT tg_execute_ddl('
  CREATE TABLE udf_test_table_1 (id INT, name CHAR(64))
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

--- Test setup: DDL of the PostgreSQL
CREATE FOREIGN TABLE udf_test_table_1 (
  id integer, name text
) SERVER tsurugidb;
--- Test
SELECT tg_verify_tables('tg_schema', 'tsurugidb', 'public', 'summary', 't');
                 tg_verify_tables                 
--------------------------------------------------
 {                                               +
     "verification": {                           +
         "remote_schema": "tg_schema",           +
         "server_name": "tsurugidb",             +
         "local_schema": "public",               +
         "mode": "summary",                      +
         "tables_on_only_remote_schema": {       +
             "count": 0                          +
         },                                      +
         "foreign_tables_on_only_local_schema": {+
             "count": 0                          +
         },                                      +
         "tables_that_need_to_be_altered": {     +
             "count": 0                          +
         },                                      +
         "available_foreign_table": {            +
             "count": 1                          +
         }                                       +
     }                                           +
 }
(1 row)

SELECT tg_verify_tables('tg_schema', 'tsurugidb', 'public', 'summary', 'yes');
                 tg_verify_tables                 
--------------------------------------------------
 {                                               +
     "verification": {                           +
         "remote_schema": "tg_schema",           +
         "server_name": "tsurugidb",             +
         "local_schema": "public",               +
         "mode": "summary",                      +
         "tables_on_only_remote_schema": {       +
             "count": 0                          +
         },                                      +
         "foreign_tables_on_only_local_schema": {+
             "count": 0                          +
         },                                      +
         "tables_that_need_to_be_altered": {     +
             "count": 0                          +
         },                                      +
         "available_foreign_table": {            +
             "count": 1                          +
         }                                       +
     }                                           +
 }
(1 row)

SELECT tg_verify_tables('tg_schema', 'tsurugidb', 'public', 'summary', 'y');
                 tg_verify_tables                 
--------------------------------------------------
 {                                               +
     "verification": {                           +
         "remote_schema": "tg_schema",           +
         "server_name": "tsurugidb",             +
         "local_schema": "public",               +
         "mode": "summary",                      +
         "tables_on_only_remote_schema": {       +
             "count": 0                          +
         },                                      +
         "foreign_tables_on_only_local_schema": {+
             "count": 0                          +
         },                                      +
         "tables_that_need_to_be_altered": {     +
             "count": 0                          +
         },                                      +
         "available_foreign_table": {            +
             "count": 1                          +
         }                                       +
     }                                           +
 }
(1 row)

SELECT tg_verify_tables('tg_schema', 'tsurugidb', 'public', 'summary', 'on');
                 tg_verify_tables                 
--------------------------------------------------
 {                                               +
     "verification": {                           +
         "remote_schema": "tg_schema",           +
         "server_name": "tsurugidb",             +
         "local_schema": "public",               +
         "mode": "summary",                      +
         "tables_on_only_remote_schema": {       +
             "count": 0                          +
         },                                      +
         "foreign_tables_on_only_local_schema": {+
             "count": 0                          +
         },                                      +
         "tables_that_need_to_be_altered": {     +
             "count": 0                          +
         },                                      +
         "available_foreign_table": {            +
             "count": 1                          +
         }                                       +
     }                                           +
 }
(1 row)

SELECT tg_verify_tables('tg_schema', 'tsurugidb', 'public', 'summary', '1');
                 tg_verify_tables                 
--------------------------------------------------
 {                                               +
     "verification": {                           +
         "remote_schema": "tg_schema",           +
         "server_name": "tsurugidb",             +
         "local_schema": "public",               +
         "mode": "summary",                      +
         "tables_on_only_remote_schema": {       +
             "count": 0                          +
         },                                      +
         "foreign_tables_on_only_local_schema": {+
             "count": 0                          +
         },                                      +
         "tables_that_need_to_be_altered": {     +
             "count": 0                          +
         },                                      +
         "available_foreign_table": {            +
             "count": 1                          +
         }                                       +
     }                                           +
 }
(1 row)

SELECT tg_verify_tables('tg_schema', 'tsurugidb', 'public', 'summary', 'f');
                                                                                                                                         tg_verify_tables                                                                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"verification":{"remote_schema":"tg_schema","server_name":"tsurugidb","local_schema":"public","mode":"summary","tables_on_only_remote_schema":{"count":0},"foreign_tables_on_only_local_schema":{"count":0},"tables_that_need_to_be_altered":{"count":0},"available_foreign_table":{"count":1}}}
(1 row)

SELECT tg_verify_tables('tg_schema', 'tsurugidb', 'public', 'summary', 'no');
                                                                                                                                         tg_verify_tables                                                                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"verification":{"remote_schema":"tg_schema","server_name":"tsurugidb","local_schema":"public","mode":"summary","tables_on_only_remote_schema":{"count":0},"foreign_tables_on_only_local_schema":{"count":0},"tables_that_need_to_be_altered":{"count":0},"available_foreign_table":{"count":1}}}
(1 row)

SELECT tg_verify_tables('tg_schema', 'tsurugidb', 'public', 'summary', 'n');
                                                                                                                                         tg_verify_tables                                                                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"verification":{"remote_schema":"tg_schema","server_name":"tsurugidb","local_schema":"public","mode":"summary","tables_on_only_remote_schema":{"count":0},"foreign_tables_on_only_local_schema":{"count":0},"tables_that_need_to_be_altered":{"count":0},"available_foreign_table":{"count":1}}}
(1 row)

SELECT tg_verify_tables('tg_schema', 'tsurugidb', 'public', 'summary', 'off');
                                                                                                                                         tg_verify_tables                                                                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"verification":{"remote_schema":"tg_schema","server_name":"tsurugidb","local_schema":"public","mode":"summary","tables_on_only_remote_schema":{"count":0},"foreign_tables_on_only_local_schema":{"count":0},"tables_that_need_to_be_altered":{"count":0},"available_foreign_table":{"count":1}}}
(1 row)

SELECT tg_verify_tables('tg_schema', 'tsurugidb', 'public', 'summary', '0');
                                                                                                                                         tg_verify_tables                                                                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"verification":{"remote_schema":"tg_schema","server_name":"tsurugidb","local_schema":"public","mode":"summary","tables_on_only_remote_schema":{"count":0},"foreign_tables_on_only_local_schema":{"count":0},"tables_that_need_to_be_altered":{"count":0},"available_foreign_table":{"count":1}}}
(1 row)

--- Test teardown: DDL of the PostgreSQL
DROP FOREIGN TABLE udf_test_table_1;
--- Test teardown: DDL of the Tsurugi
SELECT tg_execute_ddl('DROP TABLE udf_test_table_1', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

-- Test case: 8-1-1
--- Test setup: DDL of the Tsurugi
DO $$
DECLARE
  TABLE_MAX CONSTANT INT := 100;
  COLUMN_MAX CONSTANT INT := 50;
  columns_def TEXT;
  i INT;
BEGIN
  SELECT string_agg(format('col_%s INT', n), ', ')
    INTO columns_def
  FROM generate_series(1, COLUMN_MAX) n;

  FOR i IN 1..TABLE_MAX LOOP
    EXECUTE format(
      'SELECT tg_execute_ddl(''CREATE TABLE IF NOT EXISTS udf_test_table_%s (%s)'', ''tsurugidb'')',
      to_char(i, 'FM0000'), columns_def);
    EXECUTE format(
      'CREATE FOREIGN TABLE IF NOT EXISTS udf_test_table_%s (%s) SERVER tsurugidb',
      to_char(i, 'FM0000'), columns_def);
  END LOOP;
END $$;
--- Test
SELECT tg_verify_tables('tg_schema', 'tsurugidb', 'public', 'detail', true);
                 tg_verify_tables                 
--------------------------------------------------
 {                                               +
     "verification": {                           +
         "remote_schema": "tg_schema",           +
         "server_name": "tsurugidb",             +
         "local_schema": "public",               +
         "mode": "detail",                       +
         "tables_on_only_remote_schema": {       +
             "count": 0,                         +
             "list": []                          +
         },                                      +
         "foreign_tables_on_only_local_schema": {+
             "count": 0,                         +
             "list": []                          +
         },                                      +
         "tables_that_need_to_be_altered": {     +
             "count": 0,                         +
             "list": []                          +
         },                                      +
         "available_foreign_table": {            +
             "count": 100,                       +
             "list": [                           +
                 "udf_test_table_0001",          +
                 "udf_test_table_0002",          +
                 "udf_test_table_0003",          +
                 "udf_test_table_0004",          +
                 "udf_test_table_0005",          +
                 "udf_test_table_0006",          +
                 "udf_test_table_0007",          +
                 "udf_test_table_0008",          +
                 "udf_test_table_0009",          +
                 "udf_test_table_0010",          +
                 "udf_test_table_0011",          +
                 "udf_test_table_0012",          +
                 "udf_test_table_0013",          +
                 "udf_test_table_0014",          +
                 "udf_test_table_0015",          +
                 "udf_test_table_0016",          +
                 "udf_test_table_0017",          +
                 "udf_test_table_0018",          +
                 "udf_test_table_0019",          +
                 "udf_test_table_0020",          +
                 "udf_test_table_0021",          +
                 "udf_test_table_0022",          +
                 "udf_test_table_0023",          +
                 "udf_test_table_0024",          +
                 "udf_test_table_0025",          +
                 "udf_test_table_0026",          +
                 "udf_test_table_0027",          +
                 "udf_test_table_0028",          +
                 "udf_test_table_0029",          +
                 "udf_test_table_0030",          +
                 "udf_test_table_0031",          +
                 "udf_test_table_0032",          +
                 "udf_test_table_0033",          +
                 "udf_test_table_0034",          +
                 "udf_test_table_0035",          +
                 "udf_test_table_0036",          +
                 "udf_test_table_0037",          +
                 "udf_test_table_0038",          +
                 "udf_test_table_0039",          +
                 "udf_test_table_0040",          +
                 "udf_test_table_0041",          +
                 "udf_test_table_0042",          +
                 "udf_test_table_0043",          +
                 "udf_test_table_0044",          +
                 "udf_test_table_0045",          +
                 "udf_test_table_0046",          +
                 "udf_test_table_0047",          +
                 "udf_test_table_0048",          +
                 "udf_test_table_0049",          +
                 "udf_test_table_0050",          +
                 "udf_test_table_0051",          +
                 "udf_test_table_0052",          +
                 "udf_test_table_0053",          +
                 "udf_test_table_0054",          +
                 "udf_test_table_0055",          +
                 "udf_test_table_0056",          +
                 "udf_test_table_0057",          +
                 "udf_test_table_0058",          +
                 "udf_test_table_0059",          +
                 "udf_test_table_0060",          +
                 "udf_test_table_0061",          +
                 "udf_test_table_0062",          +
                 "udf_test_table_0063",          +
                 "udf_test_table_0064",          +
                 "udf_test_table_0065",          +
                 "udf_test_table_0066",          +
                 "udf_test_table_0067",          +
                 "udf_test_table_0068",          +
                 "udf_test_table_0069",          +
                 "udf_test_table_0070",          +
                 "udf_test_table_0071",          +
                 "udf_test_table_0072",          +
                 "udf_test_table_0073",          +
                 "udf_test_table_0074",          +
                 "udf_test_table_0075",          +
                 "udf_test_table_0076",          +
                 "udf_test_table_0077",          +
                 "udf_test_table_0078",          +
                 "udf_test_table_0079",          +
                 "udf_test_table_0080",          +
                 "udf_test_table_0081",          +
                 "udf_test_table_0082",          +
                 "udf_test_table_0083",          +
                 "udf_test_table_0084",          +
                 "udf_test_table_0085",          +
                 "udf_test_table_0086",          +
                 "udf_test_table_0087",          +
                 "udf_test_table_0088",          +
                 "udf_test_table_0089",          +
                 "udf_test_table_0090",          +
                 "udf_test_table_0091",          +
                 "udf_test_table_0092",          +
                 "udf_test_table_0093",          +
                 "udf_test_table_0094",          +
                 "udf_test_table_0095",          +
                 "udf_test_table_0096",          +
                 "udf_test_table_0097",          +
                 "udf_test_table_0098",          +
                 "udf_test_table_0099",          +
                 "udf_test_table_0100"           +
             ]                                   +
         }                                       +
     }                                           +
 }
(1 row)

--- Test teardown: DDL of the Tsurugi/PostgreSQL
DO $$
DECLARE
  TABLE_MAX CONSTANT INT := 100;
  i INT;
BEGIN
  FOR i IN 1..TABLE_MAX LOOP
    EXECUTE format(
      'SELECT tg_execute_ddl(''DROP TABLE IF EXISTS udf_test_table_%s'', ''tsurugidb'')',
      to_char(i, 'FM0000'));
    EXECUTE format(
      'DROP FOREIGN TABLE IF EXISTS udf_test_table_%s',
      to_char(i, 'FM0000'));
  END LOOP;
END $$;
