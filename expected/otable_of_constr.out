CREATE EXTENSION IF NOT EXISTS ogawayama_fdw;
NOTICE:  extension "ogawayama_fdw" already exists, skipping
CREATE SERVER IF NOT EXISTS ogawayama FOREIGN DATA WRAPPER ogawayama_fdw;
NOTICE:  server "ogawayama" already exists, skipping
--error
CREATE TABLE test1 (
col1  int,
col2  bigint,
col3  real,
col4  double precision,
col5 char(20),
col6 varchar(20)
) tablespace tsurugi;
ERROR:  transaction::receive_message() CREATE TABLE failed. (7)
CREATE TABLE test2 (
col1  int PRIMARY KEY,
col2  bigint,
col3  real,
col4  double precision,
col5 char(20),
col6 varchar(20)
) tablespace tsurugi;
--error
CREATE TABLE test3 (
col1  int NOT NULL,
col2  bigint NOT NULL,
col3  real NOT NULL,
col4  double precision NOT NULL,
col5 char(20) NOT NULL,
col6 varchar(20) NOT NULL
) tablespace tsurugi;
ERROR:  transaction::receive_message() CREATE TABLE failed. (7)
CREATE TABLE test4_1 (
col1  int PRIMARY KEY NOT NULL,
col2  bigint NOT NULL,
col3  real NOT NULL,
col4  double precision NOT NULL,
col5 char(20) NOT NULL,
col6 varchar(20) NOT NULL
) tablespace tsurugi;
CREATE TABLE test4_2 (
col1  int NOT NULL,
col2  bigint NOT NULL,
col3  real NOT NULL,
col4  double precision NOT NULL PRIMARY KEY,
col5 char(20) NOT NULL,
col6 varchar(20) NOT NULL
) tablespace tsurugi;
CREATE TABLE test4_3 (
col1  int NOT NULL,
col2  bigint,
col3  real,
col4  double precision PRIMARY KEY,
col5 char(20),
col6 varchar(20)
) tablespace tsurugi;
CREATE TABLE test4_4 (
col1  int,
col2  bigint,
col3  real,
col4  double precision PRIMARY KEY NOT NULL,
col5 char(20),
col6 varchar(20)
) tablespace tsurugi;
CREATE TABLE test5 (
col1  int,
col2  bigint,
col3  real,
col4  double precision,
col5 char(20),
col6 varchar(20),
PRIMARY KEY(col5)
) tablespace tsurugi;
--error
CREATE TABLE test6 (
col1  int,
col2  bigint,
col3  real,
col4  double precision,
col5 char(20) PRIMARY KEY,
col6 varchar(20),
PRIMARY KEY(col1)
) tablespace tsurugi;
ERROR:  multiple primary keys for table "test6" are not allowed
LINE 8: PRIMARY KEY(col1)
        ^
CREATE TABLE test7_1 (
col1  int NOT NULL,
col2  bigint NOT NULL,
col3  real NOT NULL,
col4  double precision NOT NULL,
col5 char(20) NOT NULL,
col6 varchar(20) NOT NULL,
PRIMARY KEY(col2)
) tablespace tsurugi;
CREATE TABLE test7_2 (
col1  int,
col2  bigint,
col3  real,
col4  double precision,
col5 char(20),
col6 varchar(20) NOT NULL,
PRIMARY KEY(col2)
) tablespace tsurugi;
CREATE TABLE test7_3 (
col1  int,
col2  bigint NOT NULL,
col3  real,
col4  double precision,
col5 char(20),
col6 varchar(20),
PRIMARY KEY(col2)
) tablespace tsurugi;
--error
CREATE TABLE test8_1 (
col1  int NOT NULL,
col2  bigint NOT NULL PRIMARY KEY,
col3  real NOT NULL,
col4  double precision NOT NULL,
col5 char(20) NOT NULL,
col6 varchar(20) NOT NULL,
PRIMARY KEY(col4)
) tablespace tsurugi;
ERROR:  multiple primary keys for table "test8_1" are not allowed
LINE 8: PRIMARY KEY(col4)
        ^
--error
CREATE TABLE test8_2 (
col1  int NOT NULL,
col2  bigint PRIMARY KEY NOT NULL,
col3  real NOT NULL,
col4  double precision NOT NULL,
col5 char(20) NOT NULL,
col6 varchar(20) NOT NULL,
PRIMARY KEY(col3)
) tablespace tsurugi;
ERROR:  multiple primary keys for table "test8_2" are not allowed
LINE 8: PRIMARY KEY(col3)
        ^
CREATE TABLE test9 (
col1  int,
col2  bigint,
col3  real,
col4  double precision,
col5 char(20),
col6 varchar(20),
PRIMARY KEY(col1,col2,col3,col5)
) tablespace tsurugi;
--error
CREATE TABLE test10 (
col1  int,
col2  bigint PRIMARY KEY,
col3  real,
col4  double precision,
col5 char(20),
col6 varchar(20),
PRIMARY KEY(col1,col2)
) tablespace tsurugi;
ERROR:  multiple primary keys for table "test10" are not allowed
LINE 8: PRIMARY KEY(col1,col2)
        ^
CREATE TABLE test11_1 (
col1  int NOT NULL,
col2  bigint NOT NULL,
col3  real NOT NULL,
col4  double precision NOT NULL,
col5 char(20) NOT NULL,
col6 varchar(20) NOT NULL,
PRIMARY KEY(col1,col2,col3,col5,col6)
) tablespace tsurugi;
CREATE TABLE test11_2 (
col1  int NOT NULL,
col2  bigint NOT NULL,
col3  real NOT NULL,
col4  double precision,
col5 char(20) NOT NULL,
col6 varchar(20) NOT NULL,
PRIMARY KEY(col1,col2,col3,col5,col6)
) tablespace tsurugi;
CREATE TABLE test11_3 (
col1  int,
col2  bigint,
col3  real,
col4  double precision NOT NULL,
col5 char(20),
col6 varchar(20),
PRIMARY KEY(col1,col2,col3,col5,col6)
) tablespace tsurugi;
--error
CREATE TABLE test12_1 (
col1  int NOT NULL,
col2  bigint NOT NULL,
col3  real NOT NULL,
col4  double precision NOT NULL,
col5 char(20) NOT NULL,
col6 varchar(20) NOT NULL PRIMARY KEY,
PRIMARY KEY(col4,col8,col9,col5)
) tablespace tsurugi;
ERROR:  multiple primary keys for table "test12_1" are not allowed
LINE 8: PRIMARY KEY(col4,col8,col9,col5)
        ^
--error
CREATE TABLE test12_2 (
col1  int NOT NULL,
col2  bigint NOT NULL,
col3  real NOT NULL,
col4  double precision NOT NULL,
col5 char(20) NOT NULL,
col6 varchar(20) PRIMARY KEY NOT NULL,
PRIMARY KEY(col4,col8,col9,col5)
) tablespace tsurugi;
ERROR:  multiple primary keys for table "test12_2" are not allowed
LINE 8: PRIMARY KEY(col4,col8,col9,col5)
        ^
--error
CREATE FOREIGN TABLE test1 (
col1  int,
col2  bigint,
col3  real,
col4  double precision,
col5 char(20),
col6 varchar(20)
) SERVER ogawayama;
CREATE FOREIGN TABLE test2 (
col1  int,
col2  bigint,
col3  real,
col4  double precision,
col5 char(20),
col6 varchar(20)
) SERVER ogawayama;
--error
CREATE FOREIGN TABLE test3 (
col1  int NOT NULL,
col2  bigint NOT NULL,
col3  real NOT NULL,
col4  double precision NOT NULL,
col5 char(20) NOT NULL,
col6 varchar(20) NOT NULL
) SERVER ogawayama;
CREATE FOREIGN TABLE test4_1 (
col1  int NOT NULL,
col2  bigint NOT NULL,
col3  real NOT NULL,
col4  double precision NOT NULL,
col5 char(20) NOT NULL,
col6 varchar(20) NOT NULL
) SERVER ogawayama;
CREATE FOREIGN TABLE test4_2 (
col1  int NOT NULL,
col2  bigint NOT NULL,
col3  real NOT NULL,
col4  double precision NOT NULL,
col5 char(20) NOT NULL,
col6 varchar(20) NOT NULL
) SERVER ogawayama;
CREATE FOREIGN TABLE test4_3 (
col1  int NOT NULL,
col2  bigint,
col3  real,
col4  double precision,
col5 char(20),
col6 varchar(20)
) SERVER ogawayama;
CREATE FOREIGN TABLE test4_4 (
col1  int,
col2  bigint,
col3  real,
col4  double precision NOT NULL,
col5 char(20),
col6 varchar(20)
) SERVER ogawayama;
CREATE FOREIGN TABLE test5 (
col1  int,
col2  bigint,
col3  real,
col4  double precision,
col5 char(20),
col6 varchar(20)
) SERVER ogawayama;
--error
CREATE FOREIGN TABLE test6 (
col1  int,
col2  bigint,
col3  real,
col4  double precision,
col5 char(20),
col6 varchar(20)
) SERVER ogawayama;
CREATE FOREIGN TABLE test7_1 (
col1  int NOT NULL,
col2  bigint NOT NULL,
col3  real NOT NULL,
col4  double precision NOT NULL,
col5 char(20) NOT NULL,
col6 varchar(20) NOT NULL
) SERVER ogawayama;
CREATE FOREIGN TABLE test7_2 (
col1  int,
col2  bigint,
col3  real,
col4  double precision,
col5 char(20),
col6 varchar(20) NOT NULL
) SERVER ogawayama;
CREATE FOREIGN TABLE test7_3 (
col1  int,
col2  bigint NOT NULL,
col3  real,
col4  double precision,
col5 char(20),
col6 varchar(20)
) SERVER ogawayama;
--error
CREATE FOREIGN TABLE test8_1 (
col1  int NOT NULL,
col2  bigint NOT NULL,
col3  real NOT NULL,
col4  double precision NOT NULL,
col5 char(20) NOT NULL,
col6 varchar(20) NOT NULL
) SERVER ogawayama;
--error
CREATE FOREIGN TABLE test8_2 (
col1  int NOT NULL,
col2  bigint NOT NULL,
col3  real NOT NULL,
col4  double precision NOT NULL,
col5 char(20) NOT NULL,
col6 varchar(20) NOT NULL
) SERVER ogawayama;
CREATE FOREIGN TABLE test9 (
col1  int,
col2  bigint,
col3  real,
col4  double precision,
col5 char(20),
col6 varchar(20)
) SERVER ogawayama;
--error
CREATE FOREIGN TABLE test10 (
col1  int,
col2  bigint,
col3  real,
col4  double precision,
col5 char(20),
col6 varchar(20)
) SERVER ogawayama;
CREATE FOREIGN TABLE test11_1 (
col1  int NOT NULL,
col2  bigint NOT NULL,
col3  real NOT NULL,
col4  double precision NOT NULL,
col5 char(20) NOT NULL,
col6 varchar(20) NOT NULL
) SERVER ogawayama;
CREATE FOREIGN TABLE test11_2 (
col1  int NOT NULL,
col2  bigint NOT NULL,
col3  real NOT NULL,
col4  double precision,
col5 char(20) NOT NULL,
col6 varchar(20) NOT NULL
) SERVER ogawayama;
CREATE FOREIGN TABLE test11_3 (
col1  int,
col2  bigint,
col3  real,
col4  double precision NOT NULL,
col5 char(20),
col6 varchar(20)
) SERVER ogawayama;
--error
CREATE FOREIGN TABLE test12_1 (
col1  int NOT NULL,
col2  bigint NOT NULL,
col3  real NOT NULL,
col4  double precision NOT NULL,
col5 char(20) NOT NULL,
col6 varchar(20) NOT NULL
) SERVER ogawayama;
--error
CREATE FOREIGN TABLE test12_2 (
col1  int NOT NULL,
col2  bigint NOT NULL,
col3  real NOT NULL,
col4  double precision NOT NULL,
col5 char(20) NOT NULL,
col6 varchar(20) NOT NULL
) SERVER ogawayama;
--test1 all error
SELECT * from test1;
ERROR:  Transaction::execute_query() failed. (9)
INSERT INTO test1 VALUES (1,1000,3.24,-2.27,'A','ABCDEFABCDEF');
ERROR:  transaction::execute_statement() failed. (9)
SELECT * from test1;
ERROR:  Transaction::execute_query() failed. (9)
INSERT INTO test1 (col6) VALUES ('ABCDEFABCDEF');
ERROR:  transaction::execute_statement() failed. (9)
SELECT * from test1;
ERROR:  Transaction::execute_query() failed. (9)
--test2
SELECT * from test2;
 col1 | col2 | col3 | col4 | col5 | col6 
------+------+------+------+------+------
(0 rows)

--ok
INSERT INTO test2 VALUES (1,1000,3.24,-2.27,'ABC','ABCDEFABCDEF');
SELECT * from test2;
 col1 | col2 | col3 | col4  |         col5         |     col6     
------+------+------+-------+----------------------+--------------
    1 | 1000 | 3.24 | -2.27 | ABC                  | ABCDEFABCDEF
(1 row)

--PKEY col1 null error
INSERT INTO test2 (col2,col3,col4,col5,col6) VALUES (1000,3.24,-2.27,'ABC','ABCDEFABCDEF');
ERROR:  transaction::execute_statement() failed. (9)
SELECT * from test2;
 col1 | col2 | col3 | col4  |         col5         |     col6     
------+------+------+-------+----------------------+--------------
    1 | 1000 | 3.24 | -2.27 | ABC                  | ABCDEFABCDEF
(1 row)

--PKEY col1 not unique error
INSERT INTO test2 (col1) VALUES (1);
ERROR:  transaction::execute_statement() failed. (9)
SELECT * from test2;
 col1 | col2 | col3 | col4  |         col5         |     col6     
------+------+------+-------+----------------------+--------------
    1 | 1000 | 3.24 | -2.27 | ABC                  | ABCDEFABCDEF
(1 row)

--ok
INSERT INTO test2 (col1) VALUES (2);
SELECT * from test2;
 col1 | col2 | col3 | col4  |         col5         |     col6     
------+------+------+-------+----------------------+--------------
    1 | 1000 | 3.24 | -2.27 | ABC                  | ABCDEFABCDEF
    2 |      |      |       |                      | 
(2 rows)

--test3 all error
INSERT INTO test3 VALUES (1,1000,3.24,-2.27,'ABC','ABCDEFABCDEF');
ERROR:  transaction::execute_statement() failed. (9)
SELECT * from test3;
ERROR:  Transaction::execute_query() failed. (9)
INSERT INTO test3 (col2) VALUES (1);
ERROR:  transaction::execute_statement() failed. (9)
SELECT * from test3;
ERROR:  Transaction::execute_query() failed. (9)
--test4_1
SELECT * from test4_1;
 col1 | col2 | col3 | col4 | col5 | col6 
------+------+------+------+------+------
(0 rows)

--ok
INSERT INTO test4_1 VALUES (1,1000,3.24,-2.27,'ABC','ABCDEFABCDEF');
SELECT * from test4_1;
 col1 | col2 | col3 | col4  |         col5         |     col6     
------+------+------+-------+----------------------+--------------
    1 | 1000 | 3.24 | -2.27 | ABC                  | ABCDEFABCDEF
(1 row)

--NOT NULL constraint null error
INSERT INTO test4_1 (col1) VALUES (3);
ERROR:  transaction::execute_statement() failed. (9)
SELECT * from test4_1;
 col1 | col2 | col3 | col4  |         col5         |     col6     
------+------+------+-------+----------------------+--------------
    1 | 1000 | 3.24 | -2.27 | ABC                  | ABCDEFABCDEF
(1 row)

--PKEY col1 null error
INSERT INTO test4_1 (col3) VALUES (3.24);
ERROR:  transaction::execute_statement() failed. (9)
SELECT * from test4_1;
 col1 | col2 | col3 | col4  |         col5         |     col6     
------+------+------+-------+----------------------+--------------
    1 | 1000 | 3.24 | -2.27 | ABC                  | ABCDEFABCDEF
(1 row)

--PKEY col1 not unique error
INSERT INTO test4_1 VALUES (1,1000,3.24,-2.27,'ABC','ABCDEFABCDEF');
ERROR:  transaction::execute_statement() failed. (9)
SELECT * from test4_1;
 col1 | col2 | col3 | col4  |         col5         |     col6     
------+------+------+-------+----------------------+--------------
    1 | 1000 | 3.24 | -2.27 | ABC                  | ABCDEFABCDEF
(1 row)

--ok
INSERT INTO test4_1 VALUES (2,1000,3.24,-2.27,'ABC','ABCDEFABCDEF');
SELECT * from test4_1;
 col1 | col2 | col3 | col4  |         col5         |     col6     
------+------+------+-------+----------------------+--------------
    1 | 1000 | 3.24 | -2.27 | ABC                  | ABCDEFABCDEF
    2 | 1000 | 3.24 | -2.27 | ABC                  | ABCDEFABCDEF
(2 rows)

--test4_2
SELECT * from test4_2;
 col1 | col2 | col3 | col4 | col5 | col6 
------+------+------+------+------+------
(0 rows)

--ok
INSERT INTO test4_2 VALUES (1,1000,3.24,-2.27,'ABC','ABCDEFABCDEF');
SELECT * from test4_2;
 col1 | col2 | col3 | col4  |         col5         |     col6     
------+------+------+-------+----------------------+--------------
    1 | 1000 | 3.24 | -2.27 | ABC                  | ABCDEFABCDEF
(1 row)

--PKEY col4 null error
INSERT INTO test4_2 (col1,col2,col3,col5,col6) VALUES (1,1000,3.24,'ABC','ABCDEFABCDEF');
ERROR:  transaction::execute_statement() failed. (9)
SELECT * from test4_2;
 col1 | col2 | col3 | col4  |         col5         |     col6     
------+------+------+-------+----------------------+--------------
    1 | 1000 | 3.24 | -2.27 | ABC                  | ABCDEFABCDEF
(1 row)

--NOT NULL constraint null error
INSERT INTO test4_2 (col2,col3,col4,col5,col6) VALUES (1000,3.24,-2.27,'ABC','ABCDEFABCDEF');
ERROR:  transaction::execute_statement() failed. (9)
SELECT * from test4_2;
 col1 | col2 | col3 | col4  |         col5         |     col6     
------+------+------+-------+----------------------+--------------
    1 | 1000 | 3.24 | -2.27 | ABC                  | ABCDEFABCDEF
(1 row)

--PKEY col4 not unique error
INSERT INTO test4_2 VALUES (1,1000,3.24,-2.27,'ABC','ABCDEFABCDEF');
ERROR:  transaction::execute_statement() failed. (9)
SELECT * from test4_2;
 col1 | col2 | col3 | col4  |         col5         |     col6     
------+------+------+-------+----------------------+--------------
    1 | 1000 | 3.24 | -2.27 | ABC                  | ABCDEFABCDEF
(1 row)

--ok
INSERT INTO test4_2 VALUES (2,1000,3.24,-3.24,'ABC','ABCDEFABCDEF');
SELECT * from test4_2;
 col1 | col2 | col3 | col4  |         col5         |     col6     
------+------+------+-------+----------------------+--------------
    2 | 1000 | 3.24 | -3.24 | ABC                  | ABCDEFABCDEF
    1 | 1000 | 3.24 | -2.27 | ABC                  | ABCDEFABCDEF
(2 rows)

--test4_3
SELECT * from test4_3;
 col1 | col2 | col3 | col4 | col5 | col6 
------+------+------+------+------+------
(0 rows)

--ok
INSERT INTO test4_3 VALUES (1,1000,3.24,-2.27,'ABC','ABCDEFABCDEF');
SELECT * from test4_3;
 col1 | col2 | col3 | col4  |         col5         |     col6     
------+------+------+-------+----------------------+--------------
    1 | 1000 | 3.24 | -2.27 | ABC                  | ABCDEFABCDEF
(1 row)

--PKEY col4 null error
INSERT INTO test4_3 (col1) VALUES (1);
ERROR:  transaction::execute_statement() failed. (9)
SELECT * from test4_3;
 col1 | col2 | col3 | col4  |         col5         |     col6     
------+------+------+-------+----------------------+--------------
    1 | 1000 | 3.24 | -2.27 | ABC                  | ABCDEFABCDEF
(1 row)

--NOT NULL constraint null error
INSERT INTO test4_3 (col2,col3,col4,col5,col6) VALUES (1000,3.24,-2.27,'ABC','ABCDEFABCDEF');
ERROR:  transaction::execute_statement() failed. (9)
SELECT * from test4_3;
 col1 | col2 | col3 | col4  |         col5         |     col6     
------+------+------+-------+----------------------+--------------
    1 | 1000 | 3.24 | -2.27 | ABC                  | ABCDEFABCDEF
(1 row)

--PKEY col4 not unique error
INSERT INTO test4_3 (col1,col4) VALUES (1,-2.27);
ERROR:  transaction::execute_statement() failed. (9)
SELECT * from test4_3;
 col1 | col2 | col3 | col4  |         col5         |     col6     
------+------+------+-------+----------------------+--------------
    1 | 1000 | 3.24 | -2.27 | ABC                  | ABCDEFABCDEF
(1 row)

--ok
INSERT INTO test4_3 (col1,col4) VALUES (1,-3.24);
SELECT * from test4_3;
 col1 | col2 | col3 | col4  |         col5         |     col6     
------+------+------+-------+----------------------+--------------
    1 |      |      | -3.24 |                      | 
    1 | 1000 | 3.24 | -2.27 | ABC                  | ABCDEFABCDEF
(2 rows)

--test4_4
SELECT * from test4_4;
 col1 | col2 | col3 | col4 | col5 | col6 
------+------+------+------+------+------
(0 rows)

--ok
INSERT INTO test4_4 VALUES (1,1000,3.24,-2.27,'ABC','ABCDEFABCDEF');
SELECT * from test4_4;
 col1 | col2 | col3 | col4  |         col5         |     col6     
------+------+------+-------+----------------------+--------------
    1 | 1000 | 3.24 | -2.27 | ABC                  | ABCDEFABCDEF
(1 row)

--PKEY col4 null error
INSERT INTO test4_4 (col5) VALUES ('ABC');
ERROR:  transaction::execute_statement() failed. (9)
SELECT * from test4_4;
 col1 | col2 | col3 | col4  |         col5         |     col6     
------+------+------+-------+----------------------+--------------
    1 | 1000 | 3.24 | -2.27 | ABC                  | ABCDEFABCDEF
(1 row)

--NOT NULL constraint null error
INSERT INTO test4_4 (col6) VALUES ('ABCDEFABCDEF');
ERROR:  transaction::execute_statement() failed. (9)
SELECT * from test4_4;
 col1 | col2 | col3 | col4  |         col5         |     col6     
------+------+------+-------+----------------------+--------------
    1 | 1000 | 3.24 | -2.27 | ABC                  | ABCDEFABCDEF
(1 row)

--PKEY col4 not unique error
INSERT INTO test4_4 (col4) VALUES (-2.27);
ERROR:  transaction::execute_statement() failed. (9)
SELECT * from test4_4;
 col1 | col2 | col3 | col4  |         col5         |     col6     
------+------+------+-------+----------------------+--------------
    1 | 1000 | 3.24 | -2.27 | ABC                  | ABCDEFABCDEF
(1 row)

--ok
INSERT INTO test4_4 (col4) VALUES (-3.24);
SELECT * from test4_4;
 col1 | col2 | col3 | col4  |         col5         |     col6     
------+------+------+-------+----------------------+--------------
      |      |      | -3.24 |                      | 
    1 | 1000 | 3.24 | -2.27 | ABC                  | ABCDEFABCDEF
(2 rows)

--test5
SELECT * from test5;
 col1 | col2 | col3 | col4 | col5 | col6 
------+------+------+------+------+------
(0 rows)

--ok
INSERT INTO test5 VALUES (1,1000,3.24,-2.27,'ABC','ABCDEFABCDEF');
SELECT * from test5;
 col1 | col2 | col3 | col4  |         col5         |     col6     
------+------+------+-------+----------------------+--------------
    1 | 1000 | 3.24 | -2.27 | ABC                  | ABCDEFABCDEF
(1 row)

--PKEY col5 null error
INSERT INTO test5 (col1,col2,col3,col4,col6) VALUES (1,1000,3.24,-2.27,'ABCDEFABCDEF');
ERROR:  transaction::execute_statement() failed. (9)
SELECT * from test5;
 col1 | col2 | col3 | col4  |         col5         |     col6     
------+------+------+-------+----------------------+--------------
    1 | 1000 | 3.24 | -2.27 | ABC                  | ABCDEFABCDEF
(1 row)

--PKEY col5 not unique error
INSERT INTO test5 (col5) VALUES ('ABC');
ERROR:  transaction::execute_statement() failed. (9)
SELECT * from test5;
 col1 | col2 | col3 | col4  |         col5         |     col6     
------+------+------+-------+----------------------+--------------
    1 | 1000 | 3.24 | -2.27 | ABC                  | ABCDEFABCDEF
(1 row)

--ok
INSERT INTO test5 (col5) VALUES ('AAA');
SELECT * from test5;
 col1 | col2 | col3 | col4  |         col5         |     col6     
------+------+------+-------+----------------------+--------------
      |      |      |       | AAA                  | 
    1 | 1000 | 3.24 | -2.27 | ABC                  | ABCDEFABCDEF
(2 rows)

--test6 error
SELECT * from test6;
ERROR:  Transaction::execute_query() failed. (9)
--test7_1
SELECT * from test7_1;
 col1 | col2 | col3 | col4 | col5 | col6 
------+------+------+------+------+------
(0 rows)

--ok
INSERT INTO test7_1 VALUES (1,1000,3.24,-2.27,'ABC','ABCDEFABCDEF');
SELECT * from test7_1;
 col1 | col2 | col3 | col4  |         col5         |     col6     
------+------+------+-------+----------------------+--------------
    1 | 1000 | 3.24 | -2.27 | ABC                  | ABCDEFABCDEF
(1 row)

-- NOT NULL constraint null error
INSERT INTO test7_1 (col1,col2,col3,col4,col5) VALUES (1,1000,3.24,-2.27,'ABC');
ERROR:  transaction::execute_statement() failed. (9)
SELECT * from test7_1;
 col1 | col2 | col3 | col4  |         col5         |     col6     
------+------+------+-------+----------------------+--------------
    1 | 1000 | 3.24 | -2.27 | ABC                  | ABCDEFABCDEF
(1 row)

--PKEY col2 null error
INSERT INTO test7_1 (col1,col3,col4,col5,col6) VALUES (1,3.24,-2.27,'ABC','ABCDEFABCDEF');
ERROR:  transaction::execute_statement() failed. (9)
SELECT * from test7_1;
 col1 | col2 | col3 | col4  |         col5         |     col6     
------+------+------+-------+----------------------+--------------
    1 | 1000 | 3.24 | -2.27 | ABC                  | ABCDEFABCDEF
(1 row)

--PKEY col2 not unique error
INSERT INTO test7_1 VALUES (1,1000,3.24,-2.27,'ABC','ABCDEFABCDEF');
ERROR:  transaction::execute_statement() failed. (9)
SELECT * from test7_1;
 col1 | col2 | col3 | col4  |         col5         |     col6     
------+------+------+-------+----------------------+--------------
    1 | 1000 | 3.24 | -2.27 | ABC                  | ABCDEFABCDEF
(1 row)

--ok
INSERT INTO test7_1 VALUES (1,1001,3.24,-2.27,'ABC','ABCDEFABCDEF');
SELECT * from test7_1;
 col1 | col2 | col3 | col4  |         col5         |     col6     
------+------+------+-------+----------------------+--------------
    1 | 1000 | 3.24 | -2.27 | ABC                  | ABCDEFABCDEF
    1 | 1001 | 3.24 | -2.27 | ABC                  | ABCDEFABCDEF
(2 rows)

--test7_2
SELECT * from test7_2;
 col1 | col2 | col3 | col4 | col5 | col6 
------+------+------+------+------+------
(0 rows)

--ok
INSERT INTO test7_2 VALUES (1,1000,3.24,-2.27,'ABC','ABCDEFABCDEF');
SELECT * from test7_2;
 col1 | col2 | col3 | col4  |         col5         |     col6     
------+------+------+-------+----------------------+--------------
    1 | 1000 | 3.24 | -2.27 | ABC                  | ABCDEFABCDEF
(1 row)

-- NOT NULL constraint null error
INSERT INTO test7_2 (col2) VALUES (1000);
ERROR:  transaction::execute_statement() failed. (9)
SELECT * from test7_2;
 col1 | col2 | col3 | col4  |         col5         |     col6     
------+------+------+-------+----------------------+--------------
    1 | 1000 | 3.24 | -2.27 | ABC                  | ABCDEFABCDEF
(1 row)

--PKEY col2 null error
INSERT INTO test7_2 (col6) VALUES ('ABCDEFABCDEF');
ERROR:  transaction::execute_statement() failed. (9)
SELECT * from test7_2;
 col1 | col2 | col3 | col4  |         col5         |     col6     
------+------+------+-------+----------------------+--------------
    1 | 1000 | 3.24 | -2.27 | ABC                  | ABCDEFABCDEF
(1 row)

--PKEY col2 not unique error
INSERT INTO test7_2 (col2,col6) VALUES (1000,'ABCDEFABCDEF');
ERROR:  transaction::execute_statement() failed. (9)
SELECT * from test7_2;
 col1 | col2 | col3 | col4  |         col5         |     col6     
------+------+------+-------+----------------------+--------------
    1 | 1000 | 3.24 | -2.27 | ABC                  | ABCDEFABCDEF
(1 row)

--ok
INSERT INTO test7_2 (col2,col6) VALUES (1001,'ABCDEFABCDEF');
SELECT * from test7_2;
 col1 | col2 | col3 | col4  |         col5         |     col6     
------+------+------+-------+----------------------+--------------
    1 | 1000 | 3.24 | -2.27 | ABC                  | ABCDEFABCDEF
      | 1001 |      |       |                      | ABCDEFABCDEF
(2 rows)

--test7_3
SELECT * from test7_3;
 col1 | col2 | col3 | col4 | col5 | col6 
------+------+------+------+------+------
(0 rows)

--ok
INSERT INTO test7_3 VALUES (1,1000,3.24,-2.27,'ABC','ABCDEFABCDEF');
SELECT * from test7_3;
 col1 | col2 | col3 | col4  |         col5         |     col6     
------+------+------+-------+----------------------+--------------
    1 | 1000 | 3.24 | -2.27 | ABC                  | ABCDEFABCDEF
(1 row)

-- NOT NULL constraint null error
INSERT INTO test7_3 (col3) VALUES (3.24);
ERROR:  transaction::execute_statement() failed. (9)
SELECT * from test7_3;
 col1 | col2 | col3 | col4  |         col5         |     col6     
------+------+------+-------+----------------------+--------------
    1 | 1000 | 3.24 | -2.27 | ABC                  | ABCDEFABCDEF
(1 row)

--PKEY col2 null error
INSERT INTO test7_3 (col4) VALUES (-2.27);
ERROR:  transaction::execute_statement() failed. (9)
SELECT * from test7_3;
 col1 | col2 | col3 | col4  |         col5         |     col6     
------+------+------+-------+----------------------+--------------
    1 | 1000 | 3.24 | -2.27 | ABC                  | ABCDEFABCDEF
(1 row)

--PKEY col2 not unique error
INSERT INTO test7_3 (col2) VALUES (1000);
ERROR:  transaction::execute_statement() failed. (9)
SELECT * from test7_3;
 col1 | col2 | col3 | col4  |         col5         |     col6     
------+------+------+-------+----------------------+--------------
    1 | 1000 | 3.24 | -2.27 | ABC                  | ABCDEFABCDEF
(1 row)

--ok
INSERT INTO test7_3 (col2) VALUES (1001);
SELECT * from test7_3;
 col1 | col2 | col3 | col4  |         col5         |     col6     
------+------+------+-------+----------------------+--------------
    1 | 1000 | 3.24 | -2.27 | ABC                  | ABCDEFABCDEF
      | 1001 |      |       |                      | 
(2 rows)

--test8 all error
SELECT * from test8_1;
ERROR:  Transaction::execute_query() failed. (9)
SELECT * from test8_2;
ERROR:  Transaction::execute_query() failed. (9)
--test9
SELECT * from test9;
 col1 | col2 | col3 | col4 | col5 | col6 
------+------+------+------+------+------
(0 rows)

--ok
INSERT INTO test9 VALUES (1,1000,3.24,-2.27,'ABC','ABCDEFABCDEF');
SELECT * from test9;
 col1 | col2 | col3 | col4  |         col5         |     col6     
------+------+------+-------+----------------------+--------------
    1 | 1000 | 3.24 | -2.27 | ABC                  | ABCDEFABCDEF
(1 row)

--PKEY (col1,col2,col3,col5) null error
INSERT INTO test9 (col1,col2,col3) VALUES (2,1000,3.24);
ERROR:  transaction::execute_statement() failed. (9)
SELECT * from test9;
 col1 | col2 | col3 | col4  |         col5         |     col6     
------+------+------+-------+----------------------+--------------
    1 | 1000 | 3.24 | -2.27 | ABC                  | ABCDEFABCDEF
(1 row)

--PKEY (col1,col2,col3,col5) not unique error
INSERT INTO test9 (col1,col2,col3,col5) VALUES (1,1000,3.24,'ABC');
ERROR:  transaction::execute_statement() failed. (9)
SELECT * from test9;
 col1 | col2 | col3 | col4  |         col5         |     col6     
------+------+------+-------+----------------------+--------------
    1 | 1000 | 3.24 | -2.27 | ABC                  | ABCDEFABCDEF
(1 row)

--ok
INSERT INTO test9 (col1,col2,col3,col5) VALUES (1,1000,3.24,'A');
SELECT * from test9;
 col1 | col2 | col3 | col4  |         col5         |     col6     
------+------+------+-------+----------------------+--------------
    1 | 1000 | 3.24 |       | A                    | 
    1 | 1000 | 3.24 | -2.27 | ABC                  | ABCDEFABCDEF
(2 rows)

--test10 error
SELECT * from test10;
ERROR:  Transaction::execute_query() failed. (9)
--test11_1
SELECT * from test11_1;
 col1 | col2 | col3 | col4 | col5 | col6 
------+------+------+------+------+------
(0 rows)

--ok
INSERT INTO test11_1 VALUES (1,1000,3.24,-2.27,'ABC','ABCDEFABCDEF');
SELECT * from test11_1;
 col1 | col2 | col3 | col4  |         col5         |     col6     
------+------+------+-------+----------------------+--------------
    1 | 1000 | 3.24 | -2.27 | ABC                  | ABCDEFABCDEF
(1 row)

--NOT NULL constraint null error
INSERT INTO test11_1 (col1,col2,col3,col5,col6) VALUES (3,1000,3.24,'ABC','ABCDEFABCDEF');
ERROR:  transaction::execute_statement() failed. (9)
--PKEY (col1,col2,col3,col5,col6) null error
INSERT INTO test11_1 (col1,col3,col4,col5,col6) VALUES (1,3.24,-2.27,'ABC','ABCDEFABCDEF');
ERROR:  transaction::execute_statement() failed. (9)
SELECT * from test11_1;
 col1 | col2 | col3 | col4  |         col5         |     col6     
------+------+------+-------+----------------------+--------------
    1 | 1000 | 3.24 | -2.27 | ABC                  | ABCDEFABCDEF
(1 row)

--PKEY (col1,col2,col3,col5,col6) not unique error
INSERT INTO test11_1 VALUES (1,1000,3.24,-2.27,'ABC','ABCDEFABCDEF');
ERROR:  transaction::execute_statement() failed. (9)
SELECT * from test11_1;
 col1 | col2 | col3 | col4  |         col5         |     col6     
------+------+------+-------+----------------------+--------------
    1 | 1000 | 3.24 | -2.27 | ABC                  | ABCDEFABCDEF
(1 row)

--ok
INSERT INTO test11_1 VALUES (2,1000,3.24,-2.27,'ABC','ABCDEFABCDEF');
SELECT * from test11_1;
 col1 | col2 | col3 | col4  |         col5         |     col6     
------+------+------+-------+----------------------+--------------
    1 | 1000 | 3.24 | -2.27 | ABC                  | ABCDEFABCDEF
    2 | 1000 | 3.24 | -2.27 | ABC                  | ABCDEFABCDEF
(2 rows)

--test11_2
SELECT * from test11_2;
 col1 | col2 | col3 | col4 | col5 | col6 
------+------+------+------+------+------
(0 rows)

--ok
INSERT INTO test11_2 VALUES (1,1000,3.24,-2.27,'ABC','ABCDEFABCDEF');
SELECT * from test11_2;
 col1 | col2 | col3 | col4  |         col5         |     col6     
------+------+------+-------+----------------------+--------------
    1 | 1000 | 3.24 | -2.27 | ABC                  | ABCDEFABCDEF
(1 row)

--NOT NULL constraint null error
INSERT INTO test11_2 (col1,col2,col3,col5) VALUES (3,1000,3.24,'ABC');
ERROR:  transaction::execute_statement() failed. (9)
--PKEY (col1,col2,col3,col5,col6) null error
INSERT INTO test11_2 (col1,col2,col3,col6) VALUES (1,1000,3.24,'ABCDEFABCDEF');
ERROR:  transaction::execute_statement() failed. (9)
SELECT * from test11_2;
 col1 | col2 | col3 | col4  |         col5         |     col6     
------+------+------+-------+----------------------+--------------
    1 | 1000 | 3.24 | -2.27 | ABC                  | ABCDEFABCDEF
(1 row)

--PKEY (col1,col2,col3,col5,col6) not unique error
INSERT INTO test11_2 (col1,col2,col3,col5,col6) VALUES (1,1000,3.24,'ABC','ABCDEFABCDEF');
ERROR:  transaction::execute_statement() failed. (9)
SELECT * from test11_2;
 col1 | col2 | col3 | col4  |         col5         |     col6     
------+------+------+-------+----------------------+--------------
    1 | 1000 | 3.24 | -2.27 | ABC                  | ABCDEFABCDEF
(1 row)

--ok
INSERT INTO test11_2 (col1,col2,col3,col5,col6) VALUES (2,1000,3.24,'ABC','ABCDEFABCDEF');
SELECT * from test11_2;
 col1 | col2 | col3 | col4  |         col5         |     col6     
------+------+------+-------+----------------------+--------------
    1 | 1000 | 3.24 | -2.27 | ABC                  | ABCDEFABCDEF
    2 | 1000 | 3.24 |       | ABC                  | ABCDEFABCDEF
(2 rows)

--test11_3
SELECT * from test11_3;
 col1 | col2 | col3 | col4 | col5 | col6 
------+------+------+------+------+------
(0 rows)

--ok
INSERT INTO test11_3 VALUES (1,1000,3.24,-2.27,'ABC','ABCDEFABCDEF');
SELECT * from test11_3;
 col1 | col2 | col3 | col4  |         col5         |     col6     
------+------+------+-------+----------------------+--------------
    1 | 1000 | 3.24 | -2.27 | ABC                  | ABCDEFABCDEF
(1 row)

--NOT NULL constraint null error
INSERT INTO test11_3 (col1,col2,col3,col5,col6) VALUES (3,1000,3.24,'ABC','ABCDEFABCDEF');
ERROR:  transaction::execute_statement() failed. (9)
--PKEY (col1,col2,col3,col5,col6) null error
INSERT INTO test11_3 (col1,col2,col3,col4,col5) VALUES (1,1001,3.24,-2.27,'ABC');
ERROR:  transaction::execute_statement() failed. (9)
SELECT * from test11_3;
 col1 | col2 | col3 | col4  |         col5         |     col6     
------+------+------+-------+----------------------+--------------
    1 | 1000 | 3.24 | -2.27 | ABC                  | ABCDEFABCDEF
(1 row)

--PKEY (col1,col2,col3,col5,col6) not unique error
INSERT INTO test11_3 VALUES (1,1000,3.24,-2.27,'ABC','ABCDEFABCDEF');
ERROR:  transaction::execute_statement() failed. (9)
SELECT * from test11_3;
 col1 | col2 | col3 | col4  |         col5         |     col6     
------+------+------+-------+----------------------+--------------
    1 | 1000 | 3.24 | -2.27 | ABC                  | ABCDEFABCDEF
(1 row)

--ok
INSERT INTO test11_3 VALUES (2,1000,3.24,-2.27,'ABC','ABCDEFABCDEF');
SELECT * from test11_3;
 col1 | col2 | col3 | col4  |         col5         |     col6     
------+------+------+-------+----------------------+--------------
    1 | 1000 | 3.24 | -2.27 | ABC                  | ABCDEFABCDEF
    2 | 1000 | 3.24 | -2.27 | ABC                  | ABCDEFABCDEF
(2 rows)

--test12 error
SELECT * from test12_1;
ERROR:  Transaction::execute_query() failed. (9)
SELECT * from test12_2;
ERROR:  Transaction::execute_query() failed. (9)
