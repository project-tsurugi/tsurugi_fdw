/* Test case: unhappy path - Unsupported data types */
-- Numeric Types - integer
--- Test setup: DDL of the Tsurugi
SELECT tg_execute_ddl('
  CREATE TABLE fdw_type_int (c INT)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

--- Test setup: DDL of the PostgreSQL
CREATE FOREIGN TABLE fdw_type_int (
  c integer
) SERVER tsurugidb;
--- Test
INSERT INTO fdw_type_int VALUES (2147483648);
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the statement on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: VALUE_EVALUATION_EXCEPTION (SQL-02011: An error occurred in evaluating values. error:lost_precision)
CONTEXT:  SQL query: INSERT INTO fdw_type_int VALUES (2147483648)
INSERT INTO fdw_type_int VALUES (-2147483649);
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the statement on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: VALUE_EVALUATION_EXCEPTION (SQL-02011: An error occurred in evaluating values. error:lost_precision)
CONTEXT:  SQL query: INSERT INTO fdw_type_int VALUES (-2147483649)
INSERT INTO fdw_type_int VALUES (2.1);  -- see tsurugi-issues#736
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the statement on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: VALUE_EVALUATION_EXCEPTION (SQL-02011: An error occurred in evaluating values. error:lost_precision)
CONTEXT:  SQL query: INSERT INTO fdw_type_int VALUES (2.1)
INSERT INTO fdw_type_int VALUES ('invalid');
ERROR:  invalid input syntax for type integer: "invalid"
LINE 1: INSERT INTO fdw_type_int VALUES ('invalid');
                                         ^
INSERT INTO fdw_type_int VALUES (0);
UPDATE fdw_type_int SET c = 2147483648;
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the statement on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: VALUE_EVALUATION_EXCEPTION (SQL-02011: an error (lost_precision) occurred:[diagnostic(code=lost_precision, message='value loses precision by conversion', args=['2147483648', '2147483647'])])
CONTEXT:  SQL query: UPDATE fdw_type_int SET c = 2147483648
UPDATE fdw_type_int SET c = 1 + 2147483648;
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the statement on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: VALUE_EVALUATION_EXCEPTION (SQL-02011: error in evaluating expression: lost_precision: value loses precision by conversion)
CONTEXT:  SQL query: UPDATE fdw_type_int SET c = 1 + 2147483648
UPDATE fdw_type_int SET c = -2147483649;
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the statement on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: VALUE_EVALUATION_EXCEPTION (SQL-02011: an error (lost_precision) occurred:[diagnostic(code=lost_precision, message='value loses precision by conversion', args=['-2147483649', '-2147483648'])])
CONTEXT:  SQL query: UPDATE fdw_type_int SET c = -2147483649
UPDATE fdw_type_int SET c = -1 - -2147483649;
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the statement on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: VALUE_EVALUATION_EXCEPTION (SQL-02011: error in evaluating expression: lost_precision: value loses precision by conversion)
CONTEXT:  SQL query: UPDATE fdw_type_int SET c = -1 - -2147483649
UPDATE fdw_type_int SET invalid = 2 WHERE c >= 1;
ERROR:  column "invalid" of relation "fdw_type_int" does not exist
LINE 1: UPDATE fdw_type_int SET invalid = 2 WHERE c >= 1;
                                ^
UPDATE fdw_type_int SET c = 2 WHERE invalid = 1;
ERROR:  column "invalid" does not exist
LINE 1: UPDATE fdw_type_int SET c = 2 WHERE invalid = 1;
                                            ^
DELETE FROM fdw_type_int WHERE invalid >= 1;
ERROR:  column "invalid" does not exist
LINE 1: DELETE FROM fdw_type_int WHERE invalid >= 1;
                                       ^
--- Test teardown: DDL of the PostgreSQL
DROP FOREIGN TABLE fdw_type_int;
--- Test teardown: DDL of the Tsurugi
SELECT tg_execute_ddl('DROP TABLE fdw_type_int', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

-- Numeric Types - bigint
--- Test setup: DDL of the Tsurugi
SELECT tg_execute_ddl('
  CREATE TABLE fdw_type_bigint (c BIGINT)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

--- Test setup: DDL of the PostgreSQL
CREATE FOREIGN TABLE fdw_type_bigint (
  c bigint
) SERVER tsurugidb;
--- Test
INSERT INTO fdw_type_bigint VALUES (9223372036854775808);
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the statement on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: VALUE_EVALUATION_EXCEPTION (SQL-02011: An error occurred in evaluating values. error:lost_precision)
CONTEXT:  SQL query: INSERT INTO fdw_type_bigint VALUES (9223372036854775808)
INSERT INTO fdw_type_bigint VALUES (-9223372036854775809);
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the statement on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: VALUE_EVALUATION_EXCEPTION (SQL-02011: An error occurred in evaluating values. error:lost_precision)
CONTEXT:  SQL query: INSERT INTO fdw_type_bigint VALUES (-9223372036854775809)
INSERT INTO fdw_type_bigint VALUES (2.1);  -- see tsurugi-issues#736
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the statement on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: VALUE_EVALUATION_EXCEPTION (SQL-02011: An error occurred in evaluating values. error:lost_precision)
CONTEXT:  SQL query: INSERT INTO fdw_type_bigint VALUES (2.1)
INSERT INTO fdw_type_bigint VALUES ('invalid');
ERROR:  invalid input syntax for type bigint: "invalid"
LINE 1: INSERT INTO fdw_type_bigint VALUES ('invalid');
                                            ^
INSERT INTO fdw_type_bigint VALUES (0);
UPDATE fdw_type_bigint SET c = 9223372036854775808;
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the statement on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: VALUE_EVALUATION_EXCEPTION (SQL-02011: an error (lost_precision) occurred:[diagnostic(code=lost_precision, message='value loses precision by conversion', args=['9223372036854775808', '9223372036854775807'])])
CONTEXT:  SQL query: UPDATE fdw_type_bigint SET c = 9223372036854775808
UPDATE fdw_type_bigint SET c = 1 + 9223372036854775808;
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the statement on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: VALUE_EVALUATION_EXCEPTION (SQL-02011: error in evaluating expression: lost_precision: value loses precision by conversion)
CONTEXT:  SQL query: UPDATE fdw_type_bigint SET c = 1 + 9223372036854775808
UPDATE fdw_type_bigint SET c = -9223372036854775809;
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the statement on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: VALUE_EVALUATION_EXCEPTION (SQL-02011: an error (lost_precision) occurred:[diagnostic(code=lost_precision, message='value loses precision by conversion', args=['-9223372036854775809', '-9223372036854775808'])])
CONTEXT:  SQL query: UPDATE fdw_type_bigint SET c = -9223372036854775809
UPDATE fdw_type_bigint SET c = -1 - -9223372036854775809;
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the statement on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: VALUE_EVALUATION_EXCEPTION (SQL-02011: error in evaluating expression: lost_precision: value loses precision by conversion)
CONTEXT:  SQL query: UPDATE fdw_type_bigint SET c = -1 - -9223372036854775809
UPDATE fdw_type_bigint SET invalid = 2 WHERE c >= 1;
ERROR:  column "invalid" of relation "fdw_type_bigint" does not exist
LINE 1: UPDATE fdw_type_bigint SET invalid = 2 WHERE c >= 1;
                                   ^
UPDATE fdw_type_bigint SET c = 2 WHERE invalid = 1;
ERROR:  column "invalid" does not exist
LINE 1: UPDATE fdw_type_bigint SET c = 2 WHERE invalid = 1;
                                               ^
DELETE FROM fdw_type_bigint WHERE invalid >= 1;
ERROR:  column "invalid" does not exist
LINE 1: DELETE FROM fdw_type_bigint WHERE invalid >= 1;
                                          ^
--- Test teardown: DDL of the PostgreSQL
DROP FOREIGN TABLE fdw_type_bigint;
--- Test teardown: DDL of the Tsurugi
SELECT tg_execute_ddl('DROP TABLE fdw_type_bigint', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

-- Numeric Types - decimal
--- Test setup: DDL of the Tsurugi
SELECT tg_execute_ddl('
  CREATE TABLE fdw_type_decimal (c DECIMAL)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

--- Test setup: DDL of the PostgreSQL
CREATE FOREIGN TABLE fdw_type_decimal (
  c decimal
) SERVER tsurugidb;
--- Test
INSERT INTO fdw_type_decimal VALUES ('invalid');
ERROR:  invalid input syntax for type numeric: "invalid"
LINE 1: INSERT INTO fdw_type_decimal VALUES ('invalid');
                                             ^
UPDATE fdw_type_decimal SET invalid = 2 WHERE c >= 1;
ERROR:  column "invalid" of relation "fdw_type_decimal" does not exist
LINE 1: UPDATE fdw_type_decimal SET invalid = 2 WHERE c >= 1;
                                    ^
UPDATE fdw_type_decimal SET c = 2 WHERE invalid = 1;
ERROR:  column "invalid" does not exist
LINE 1: UPDATE fdw_type_decimal SET c = 2 WHERE invalid = 1;
                                                ^
DELETE FROM fdw_type_decimal WHERE invalid >= 1;
ERROR:  column "invalid" does not exist
LINE 1: DELETE FROM fdw_type_decimal WHERE invalid >= 1;
                                           ^
--- Test teardown: DDL of the PostgreSQL
DROP FOREIGN TABLE fdw_type_decimal;
--- Test teardown: DDL of the Tsurugi
SELECT tg_execute_ddl('DROP TABLE fdw_type_decimal', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

-- Numeric Types - decimal(5)
--- Test setup: DDL of the Tsurugi
SELECT tg_execute_ddl('
  CREATE TABLE fdw_type_decimal_p (c DECIMAL(5))
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

--- Test setup: DDL of the PostgreSQL
CREATE FOREIGN TABLE fdw_type_decimal_p (
  c decimal(5)
) SERVER tsurugidb;
--- Test
INSERT INTO fdw_type_decimal_p VALUES (123456);
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the statement on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: VALUE_EVALUATION_EXCEPTION (SQL-02011: An error occurred in evaluating values. error:lost_precision)
CONTEXT:  SQL query: INSERT INTO fdw_type_decimal_p VALUES (123456)
INSERT INTO fdw_type_decimal_p VALUES ('invalid');
ERROR:  invalid input syntax for type numeric: "invalid"
LINE 1: INSERT INTO fdw_type_decimal_p VALUES ('invalid');
                                               ^
UPDATE fdw_type_decimal_p SET invalid = 2 WHERE c >= 1;
ERROR:  column "invalid" of relation "fdw_type_decimal_p" does not exist
LINE 1: UPDATE fdw_type_decimal_p SET invalid = 2 WHERE c >= 1;
                                      ^
UPDATE fdw_type_decimal_p SET c = 2 WHERE invalid = 1;
ERROR:  column "invalid" does not exist
LINE 1: UPDATE fdw_type_decimal_p SET c = 2 WHERE invalid = 1;
                                                  ^
DELETE FROM fdw_type_decimal_p WHERE invalid >= 1;
ERROR:  column "invalid" does not exist
LINE 1: DELETE FROM fdw_type_decimal_p WHERE invalid >= 1;
                                             ^
--- Test teardown: DDL of the PostgreSQL
DROP FOREIGN TABLE fdw_type_decimal_p;
--- Test teardown: DDL of the Tsurugi
SELECT tg_execute_ddl('DROP TABLE fdw_type_decimal_p', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

-- Numeric Types - decimal(5, 2)
--- Test setup: DDL of the Tsurugi
SELECT tg_execute_ddl('
  CREATE TABLE fdw_type_decimal_ps (c DECIMAL(5, 2))
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

--- Test setup: DDL of the PostgreSQL
CREATE FOREIGN TABLE fdw_type_decimal_ps (
  c decimal(5, 2)
) SERVER tsurugidb;
--- Test
INSERT INTO fdw_type_decimal_ps VALUES (1234);
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the statement on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: VALUE_EVALUATION_EXCEPTION (SQL-02011: An error occurred in evaluating values. error:lost_precision)
CONTEXT:  SQL query: INSERT INTO fdw_type_decimal_ps VALUES (1234)
INSERT INTO fdw_type_decimal_ps VALUES (1234.56);
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the statement on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: VALUE_EVALUATION_EXCEPTION (SQL-02011: An error occurred in evaluating values. error:lost_precision)
CONTEXT:  SQL query: INSERT INTO fdw_type_decimal_ps VALUES (1234.56)
INSERT INTO fdw_type_decimal_ps VALUES (123.567);
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the statement on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: VALUE_EVALUATION_EXCEPTION (SQL-02011: An error occurred in evaluating values. error:lost_precision)
CONTEXT:  SQL query: INSERT INTO fdw_type_decimal_ps VALUES (123.567)
INSERT INTO fdw_type_decimal_ps VALUES ('invalid');
ERROR:  invalid input syntax for type numeric: "invalid"
LINE 1: INSERT INTO fdw_type_decimal_ps VALUES ('invalid');
                                                ^
UPDATE fdw_type_decimal_ps SET invalid = 2 WHERE c >= 1;
ERROR:  column "invalid" of relation "fdw_type_decimal_ps" does not exist
LINE 1: UPDATE fdw_type_decimal_ps SET invalid = 2 WHERE c >= 1;
                                       ^
UPDATE fdw_type_decimal_ps SET c = 2 WHERE invalid = 1;
ERROR:  column "invalid" does not exist
LINE 1: UPDATE fdw_type_decimal_ps SET c = 2 WHERE invalid = 1;
                                                   ^
DELETE FROM fdw_type_decimal_ps WHERE invalid >= 1;
ERROR:  column "invalid" does not exist
LINE 1: DELETE FROM fdw_type_decimal_ps WHERE invalid >= 1;
                                              ^
--- Test teardown: DDL of the PostgreSQL
DROP FOREIGN TABLE fdw_type_decimal_ps;
--- Test teardown: DDL of the Tsurugi
SELECT tg_execute_ddl('DROP TABLE fdw_type_decimal_ps', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

-- Numeric Types - decimal(38, 0)
--- Test setup: DDL of the Tsurugi
SELECT tg_execute_ddl('
  CREATE TABLE fdw_type_decimal_ps0 (c DECIMAL(38, 0))
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

--- Test setup: DDL of the PostgreSQL
CREATE FOREIGN TABLE fdw_type_decimal_ps0 (
  c decimal(38, 0)
) SERVER tsurugidb;
--- Test
INSERT INTO fdw_type_decimal_ps0
  VALUES (100000000000000000000000000000000000000);
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the statement on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: VALUE_ANALYZE_EXCEPTION (SQL-03005: compile failed with error:unsupported_decimal_value message:"invalid decimal value '100000000000000000000000000000000000000' (inexact value by rounding)" location:<input>:2:11+39)
CONTEXT:  SQL query: INSERT INTO fdw_type_decimal_ps0
  VALUES (100000000000000000000000000000000000000)
INSERT INTO fdw_type_decimal_ps0
  VALUES (340282366920938463463374607431768211455);
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the statement on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: VALUE_ANALYZE_EXCEPTION (SQL-03005: compile failed with error:unsupported_decimal_value message:"invalid decimal value '340282366920938463463374607431768211455' (inexact value by rounding)" location:<input>:2:11+39)
CONTEXT:  SQL query: INSERT INTO fdw_type_decimal_ps0
  VALUES (340282366920938463463374607431768211455)
INSERT INTO fdw_type_decimal_ps0
  VALUES (340282366920938463463374607431768211456);
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the statement on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: VALUE_ANALYZE_EXCEPTION (SQL-03005: compile failed with error:unsupported_decimal_value message:"invalid decimal value '340282366920938463463374607431768211456' (inexact value by rounding)" location:<input>:2:11+39)
CONTEXT:  SQL query: INSERT INTO fdw_type_decimal_ps0
  VALUES (340282366920938463463374607431768211456)
--- Test teardown: DDL of the PostgreSQL
DROP FOREIGN TABLE fdw_type_decimal_ps0;
--- Test teardown: DDL of the Tsurugi
SELECT tg_execute_ddl('DROP TABLE fdw_type_decimal_ps0', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

-- Numeric Types - decimal(38, 38)
--- Test setup: DDL of the Tsurugi
SELECT tg_execute_ddl('
  CREATE TABLE fdw_type_decimal_ps38 (c DECIMAL(38, 38))
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

--- Test setup: DDL of the PostgreSQL
CREATE FOREIGN TABLE fdw_type_decimal_ps38 (
  c decimal(38, 38)
) SERVER tsurugidb;
--- Test
INSERT INTO fdw_type_decimal_ps38 VALUES (1);
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the statement on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: VALUE_EVALUATION_EXCEPTION (SQL-02011: An error occurred in evaluating values. error:lost_precision)
CONTEXT:  SQL query: INSERT INTO fdw_type_decimal_ps38 VALUES (1)
INSERT INTO fdw_type_decimal_ps38
  VALUES (0.000000000000000000000000000000000000001);
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the statement on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: VALUE_ANALYZE_EXCEPTION (SQL-03005: compile failed with error:unsupported_decimal_value message:"invalid decimal value '0.000000000000000000000000000000000000001' (inexact value by rounding)" location:<input>:2:11+41)
CONTEXT:  SQL query: INSERT INTO fdw_type_decimal_ps38
  VALUES (0.000000000000000000000000000000000000001)
INSERT INTO fdw_type_decimal_ps38
  VALUES (0.340282366920938463463374607431768211455);
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the statement on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: VALUE_ANALYZE_EXCEPTION (SQL-03005: compile failed with error:unsupported_decimal_value message:"invalid decimal value '0.340282366920938463463374607431768211455' (inexact value by rounding)" location:<input>:2:11+41)
CONTEXT:  SQL query: INSERT INTO fdw_type_decimal_ps38
  VALUES (0.340282366920938463463374607431768211455)
INSERT INTO fdw_type_decimal_ps38
  VALUES (0.340282366920938463463374607431768211456);
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the statement on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: VALUE_ANALYZE_EXCEPTION (SQL-03005: compile failed with error:unsupported_decimal_value message:"invalid decimal value '0.340282366920938463463374607431768211456' (inexact value by rounding)" location:<input>:2:11+41)
CONTEXT:  SQL query: INSERT INTO fdw_type_decimal_ps38
  VALUES (0.340282366920938463463374607431768211456)
--- Test teardown: DDL of the PostgreSQL
DROP FOREIGN TABLE fdw_type_decimal_ps38;
--- Test teardown: DDL of the Tsurugi
SELECT tg_execute_ddl('DROP TABLE fdw_type_decimal_ps38', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

-- Numeric Types - numeric
--- Test setup: DDL of the Tsurugi
SELECT tg_execute_ddl('
  CREATE TABLE fdw_type_numeric (c NUMERIC)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

--- Test setup: DDL of the PostgreSQL
CREATE FOREIGN TABLE fdw_type_numeric (
  c numeric
) SERVER tsurugidb;
--- Test
INSERT INTO fdw_type_numeric VALUES ('invalid');
ERROR:  invalid input syntax for type numeric: "invalid"
LINE 1: INSERT INTO fdw_type_numeric VALUES ('invalid');
                                             ^
UPDATE fdw_type_numeric SET invalid = 2 WHERE c >= 1;
ERROR:  column "invalid" of relation "fdw_type_numeric" does not exist
LINE 1: UPDATE fdw_type_numeric SET invalid = 2 WHERE c >= 1;
                                    ^
UPDATE fdw_type_numeric SET c = 2 WHERE invalid = 1;
ERROR:  column "invalid" does not exist
LINE 1: UPDATE fdw_type_numeric SET c = 2 WHERE invalid = 1;
                                                ^
DELETE FROM fdw_type_numeric WHERE invalid >= 1;
ERROR:  column "invalid" does not exist
LINE 1: DELETE FROM fdw_type_numeric WHERE invalid >= 1;
                                           ^
--- Test teardown: DDL of the PostgreSQL
DROP FOREIGN TABLE fdw_type_numeric;
--- Test teardown: DDL of the Tsurugi
SELECT tg_execute_ddl('DROP TABLE fdw_type_numeric', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

-- Numeric Types - numeric(5)
--- Test setup: DDL of the Tsurugi
SELECT tg_execute_ddl('
  CREATE TABLE fdw_type_numeric_p (c NUMERIC(5))
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

--- Test setup: DDL of the PostgreSQL
CREATE FOREIGN TABLE fdw_type_numeric_p (
  c numeric(5)
) SERVER tsurugidb;
--- Test
INSERT INTO fdw_type_numeric_p VALUES (123456);
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the statement on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: VALUE_EVALUATION_EXCEPTION (SQL-02011: An error occurred in evaluating values. error:lost_precision)
CONTEXT:  SQL query: INSERT INTO fdw_type_numeric_p VALUES (123456)
INSERT INTO fdw_type_numeric_p VALUES ('invalid');
ERROR:  invalid input syntax for type numeric: "invalid"
LINE 1: INSERT INTO fdw_type_numeric_p VALUES ('invalid');
                                               ^
UPDATE fdw_type_numeric_p SET invalid = 2 WHERE c >= 1;
ERROR:  column "invalid" of relation "fdw_type_numeric_p" does not exist
LINE 1: UPDATE fdw_type_numeric_p SET invalid = 2 WHERE c >= 1;
                                      ^
UPDATE fdw_type_numeric_p SET c = 2 WHERE invalid = 1;
ERROR:  column "invalid" does not exist
LINE 1: UPDATE fdw_type_numeric_p SET c = 2 WHERE invalid = 1;
                                                  ^
DELETE FROM fdw_type_numeric_p WHERE invalid >= 1;
ERROR:  column "invalid" does not exist
LINE 1: DELETE FROM fdw_type_numeric_p WHERE invalid >= 1;
                                             ^
--- Test teardown: DDL of the PostgreSQL
DROP FOREIGN TABLE fdw_type_numeric_p;
--- Test teardown: DDL of the Tsurugi
SELECT tg_execute_ddl('DROP TABLE fdw_type_numeric_p', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

-- Numeric Types - numeric(5, 2)
--- Test setup: DDL of the Tsurugi
SELECT tg_execute_ddl('
  CREATE TABLE fdw_type_numeric_ps (c NUMERIC(5, 2))
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

--- Test setup: DDL of the PostgreSQL
CREATE FOREIGN TABLE fdw_type_numeric_ps (
  c numeric(5, 2)
) SERVER tsurugidb;
--- Test
INSERT INTO fdw_type_numeric_ps VALUES (1234);
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the statement on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: VALUE_EVALUATION_EXCEPTION (SQL-02011: An error occurred in evaluating values. error:lost_precision)
CONTEXT:  SQL query: INSERT INTO fdw_type_numeric_ps VALUES (1234)
INSERT INTO fdw_type_numeric_ps VALUES (1234.56);
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the statement on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: VALUE_EVALUATION_EXCEPTION (SQL-02011: An error occurred in evaluating values. error:lost_precision)
CONTEXT:  SQL query: INSERT INTO fdw_type_numeric_ps VALUES (1234.56)
INSERT INTO fdw_type_numeric_ps VALUES (123.567);
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the statement on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: VALUE_EVALUATION_EXCEPTION (SQL-02011: An error occurred in evaluating values. error:lost_precision)
CONTEXT:  SQL query: INSERT INTO fdw_type_numeric_ps VALUES (123.567)
INSERT INTO fdw_type_numeric_ps VALUES ('invalid');
ERROR:  invalid input syntax for type numeric: "invalid"
LINE 1: INSERT INTO fdw_type_numeric_ps VALUES ('invalid');
                                                ^
UPDATE fdw_type_numeric_ps SET invalid = 2 WHERE c >= 1;
ERROR:  column "invalid" of relation "fdw_type_numeric_ps" does not exist
LINE 1: UPDATE fdw_type_numeric_ps SET invalid = 2 WHERE c >= 1;
                                       ^
UPDATE fdw_type_numeric_ps SET c = 2 WHERE invalid = 1;
ERROR:  column "invalid" does not exist
LINE 1: UPDATE fdw_type_numeric_ps SET c = 2 WHERE invalid = 1;
                                                   ^
DELETE FROM fdw_type_numeric_ps WHERE invalid >= 1;
ERROR:  column "invalid" does not exist
LINE 1: DELETE FROM fdw_type_numeric_ps WHERE invalid >= 1;
                                              ^
INSERT INTO fdw_type_numeric_ps VALUES (ceiling(-95.3));
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the statement on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: SYMBOL_ANALYZE_EXCEPTION (SQL-03004: compile failed with error:function_not_found message:"function not found: ceiling(decimal(*, 1))" location:<input>:1:41+14)
CONTEXT:  SQL query: INSERT INTO fdw_type_numeric_ps VALUES (ceiling(-95.3))
INSERT INTO fdw_type_numeric_ps VALUES (CAST(cbrt(27.0) AS DECIMAL(5, 2)));
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the statement on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: SYMBOL_ANALYZE_EXCEPTION (SQL-03004: compile failed with error:function_not_found message:"function not found: cbrt(decimal(*, 1))" location:<input>:1:46+10)
CONTEXT:  SQL query: INSERT INTO fdw_type_numeric_ps VALUES (CAST(cbrt(27.0) AS DECIMAL(5, 2)))
INSERT INTO fdw_type_numeric_ps VALUES (CAST(degrees(0.5) AS DECIMAL(5, 2)));
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the statement on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: SYMBOL_ANALYZE_EXCEPTION (SQL-03004: compile failed with error:function_not_found message:"function not found: degrees(decimal(*, 1))" location:<input>:1:46+12)
CONTEXT:  SQL query: INSERT INTO fdw_type_numeric_ps VALUES (CAST(degrees(0.5) AS DECIMAL(5, 2)))
INSERT INTO fdw_type_numeric_ps VALUES (div(9,4));
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the statement on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: SYMBOL_ANALYZE_EXCEPTION (SQL-03004: compile failed with error:function_not_found message:"function not found: div(int8(), int8())" location:<input>:1:41+8)
CONTEXT:  SQL query: INSERT INTO fdw_type_numeric_ps VALUES (div(9,4))
INSERT INTO fdw_type_numeric_ps VALUES (CAST(exp(1.0) AS DECIMAL(5, 2)));
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the statement on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: SYMBOL_ANALYZE_EXCEPTION (SQL-03004: compile failed with error:function_not_found message:"function not found: exp(decimal(*, 1))" location:<input>:1:46+8)
CONTEXT:  SQL query: INSERT INTO fdw_type_numeric_ps VALUES (CAST(exp(1.0) AS DECIMAL(5, 2)))
INSERT INTO fdw_type_numeric_ps VALUES (factorial(5));
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the statement on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: SYMBOL_ANALYZE_EXCEPTION (SQL-03004: compile failed with error:function_not_found message:"function not found: factorial(int8())" location:<input>:1:41+12)
CONTEXT:  SQL query: INSERT INTO fdw_type_numeric_ps VALUES (factorial(5))
INSERT INTO fdw_type_numeric_ps VALUES (CAST(ln(2.0) AS DECIMAL(5, 2)));
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the statement on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: SYMBOL_ANALYZE_EXCEPTION (SQL-03004: compile failed with error:function_not_found message:"function not found: ln(decimal(*, 1))" location:<input>:1:46+7)
CONTEXT:  SQL query: INSERT INTO fdw_type_numeric_ps VALUES (CAST(ln(2.0) AS DECIMAL(5, 2)))
INSERT INTO fdw_type_numeric_ps VALUES (log(100.0));
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the statement on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: SYMBOL_ANALYZE_EXCEPTION (SQL-03004: compile failed with error:function_not_found message:"function not found: log(decimal(*, 1))" location:<input>:1:41+10)
CONTEXT:  SQL query: INSERT INTO fdw_type_numeric_ps VALUES (log(100.0))
INSERT INTO fdw_type_numeric_ps VALUES (log10(100.0));
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the statement on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: SYMBOL_ANALYZE_EXCEPTION (SQL-03004: compile failed with error:function_not_found message:"function not found: log10(decimal(*, 1))" location:<input>:1:41+12)
CONTEXT:  SQL query: INSERT INTO fdw_type_numeric_ps VALUES (log10(100.0))
INSERT INTO fdw_type_numeric_ps VALUES (log(2.0, 64.0));
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the statement on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: SYMBOL_ANALYZE_EXCEPTION (SQL-03004: compile failed with error:function_not_found message:"function not found: log(decimal(*, 1), decimal(*, 1))" location:<input>:1:41+14)
CONTEXT:  SQL query: INSERT INTO fdw_type_numeric_ps VALUES (log(2.0, 64.0))
INSERT INTO fdw_type_numeric_ps VALUES (CAST(pi() AS DECIMAL(5, 2)));
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the statement on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: SYMBOL_ANALYZE_EXCEPTION (SQL-03004: compile failed with error:function_not_found message:"function not found: pi()" location:<input>:1:46+4)
CONTEXT:  SQL query: INSERT INTO fdw_type_numeric_ps VALUES (CAST(pi() AS DECIMAL(5, 2)))
INSERT INTO fdw_type_numeric_ps VALUES (power(9.0, 3.0));
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the statement on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: SYMBOL_ANALYZE_EXCEPTION (SQL-03004: compile failed with error:function_not_found message:"function not found: power(decimal(*, 1), decimal(*, 1))" location:<input>:1:41+15)
CONTEXT:  SQL query: INSERT INTO fdw_type_numeric_ps VALUES (power(9.0, 3.0))
INSERT INTO fdw_type_numeric_ps VALUES (CAST(radians(45.0) AS DECIMAL(5, 2)));
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the statement on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: SYMBOL_ANALYZE_EXCEPTION (SQL-03004: compile failed with error:function_not_found message:"function not found: radians(decimal(*, 1))" location:<input>:1:46+13)
CONTEXT:  SQL query: INSERT INTO fdw_type_numeric_ps VALUES (CAST(radians(45.0) AS DECIMAL(5, 2)))
INSERT INTO fdw_type_numeric_ps VALUES (sign(-8.4));
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the statement on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: SYMBOL_ANALYZE_EXCEPTION (SQL-03004: compile failed with error:function_not_found message:"function not found: sign(decimal(*, 1))" location:<input>:1:41+10)
CONTEXT:  SQL query: INSERT INTO fdw_type_numeric_ps VALUES (sign(-8.4))
INSERT INTO fdw_type_numeric_ps VALUES (CAST(scale(8.41) AS DECIMAL(5, 2)));
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the statement on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: SYMBOL_ANALYZE_EXCEPTION (SQL-03004: compile failed with error:function_not_found message:"function not found: scale(decimal(*, 2))" location:<input>:1:46+11)
CONTEXT:  SQL query: INSERT INTO fdw_type_numeric_ps VALUES (CAST(scale(8.41) AS DECIMAL(5, 2)))
INSERT INTO fdw_type_numeric_ps VALUES (CAST(sqrt(2.0) AS DECIMAL(5, 2)));
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the statement on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: SYMBOL_ANALYZE_EXCEPTION (SQL-03004: compile failed with error:function_not_found message:"function not found: sqrt(decimal(*, 1))" location:<input>:1:46+9)
CONTEXT:  SQL query: INSERT INTO fdw_type_numeric_ps VALUES (CAST(sqrt(2.0) AS DECIMAL(5, 2)))
INSERT INTO fdw_type_numeric_ps VALUES (trunc(42.8));
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the statement on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: SYMBOL_ANALYZE_EXCEPTION (SQL-03004: compile failed with error:function_not_found message:"function not found: trunc(decimal(*, 1))" location:<input>:1:41+11)
CONTEXT:  SQL query: INSERT INTO fdw_type_numeric_ps VALUES (trunc(42.8))
INSERT INTO fdw_type_numeric_ps VALUES (trunc(42.4382, 2));
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the statement on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: SYMBOL_ANALYZE_EXCEPTION (SQL-03004: compile failed with error:function_not_found message:"function not found: trunc(decimal(*, 4), int8())" location:<input>:1:41+17)
CONTEXT:  SQL query: INSERT INTO fdw_type_numeric_ps VALUES (trunc(42.4382, 2))
INSERT INTO fdw_type_numeric_ps
  VALUES (CAST(width_bucket(5.35, 0.024, 5, 2, 5) AS DECIMAL(5, 2)));
ERROR:  function width_bucket(numeric, numeric, integer, integer, integer) does not exist
LINE 2:   VALUES (CAST(width_bucket(5.35, 0.024, 5, 2, 5) AS DECIMAL...
                       ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
--- Test teardown: DDL of the PostgreSQL
DROP FOREIGN TABLE fdw_type_numeric_ps;
--- Test teardown: DDL of the Tsurugi
SELECT tg_execute_ddl('DROP TABLE fdw_type_numeric_ps', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

-- Numeric Types - numeric(38, 0)
--- Test setup: DDL of the Tsurugi
SELECT tg_execute_ddl('
  CREATE TABLE fdw_type_numeric_ps0 (c NUMERIC(38, 0))
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

--- Test setup: DDL of the PostgreSQL
CREATE FOREIGN TABLE fdw_type_numeric_ps0 (
  c numeric(38, 0)
) SERVER tsurugidb;
--- Test
INSERT INTO fdw_type_numeric_ps0
  VALUES (100000000000000000000000000000000000000);
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the statement on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: VALUE_ANALYZE_EXCEPTION (SQL-03005: compile failed with error:unsupported_decimal_value message:"invalid decimal value '100000000000000000000000000000000000000' (inexact value by rounding)" location:<input>:2:11+39)
CONTEXT:  SQL query: INSERT INTO fdw_type_numeric_ps0
  VALUES (100000000000000000000000000000000000000)
INSERT INTO fdw_type_numeric_ps0
  VALUES (340282366920938463463374607431768211455);
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the statement on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: VALUE_ANALYZE_EXCEPTION (SQL-03005: compile failed with error:unsupported_decimal_value message:"invalid decimal value '340282366920938463463374607431768211455' (inexact value by rounding)" location:<input>:2:11+39)
CONTEXT:  SQL query: INSERT INTO fdw_type_numeric_ps0
  VALUES (340282366920938463463374607431768211455)
INSERT INTO fdw_type_numeric_ps0
  VALUES (340282366920938463463374607431768211456);
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the statement on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: VALUE_ANALYZE_EXCEPTION (SQL-03005: compile failed with error:unsupported_decimal_value message:"invalid decimal value '340282366920938463463374607431768211456' (inexact value by rounding)" location:<input>:2:11+39)
CONTEXT:  SQL query: INSERT INTO fdw_type_numeric_ps0
  VALUES (340282366920938463463374607431768211456)
--- Test teardown: DDL of the PostgreSQL
DROP FOREIGN TABLE fdw_type_numeric_ps0;
--- Test teardown: DDL of the Tsurugi
SELECT tg_execute_ddl('DROP TABLE fdw_type_numeric_ps0', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

-- Numeric Types - numeric(38, 38)
--- Test setup: DDL of the Tsurugi
SELECT tg_execute_ddl('
  CREATE TABLE fdw_type_numeric_ps38 (c NUMERIC(38, 38))
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

--- Test setup: DDL of the PostgreSQL
CREATE FOREIGN TABLE fdw_type_numeric_ps38 (
  c numeric(38, 38)
) SERVER tsurugidb;
--- Test
INSERT INTO fdw_type_numeric_ps38 VALUES (1);
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the statement on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: VALUE_EVALUATION_EXCEPTION (SQL-02011: An error occurred in evaluating values. error:lost_precision)
CONTEXT:  SQL query: INSERT INTO fdw_type_numeric_ps38 VALUES (1)
INSERT INTO fdw_type_numeric_ps38
  VALUES (0.000000000000000000000000000000000000001);
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the statement on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: VALUE_ANALYZE_EXCEPTION (SQL-03005: compile failed with error:unsupported_decimal_value message:"invalid decimal value '0.000000000000000000000000000000000000001' (inexact value by rounding)" location:<input>:2:11+41)
CONTEXT:  SQL query: INSERT INTO fdw_type_numeric_ps38
  VALUES (0.000000000000000000000000000000000000001)
INSERT INTO fdw_type_numeric_ps38
  VALUES (0.340282366920938463463374607431768211455);
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the statement on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: VALUE_ANALYZE_EXCEPTION (SQL-03005: compile failed with error:unsupported_decimal_value message:"invalid decimal value '0.340282366920938463463374607431768211455' (inexact value by rounding)" location:<input>:2:11+41)
CONTEXT:  SQL query: INSERT INTO fdw_type_numeric_ps38
  VALUES (0.340282366920938463463374607431768211455)
INSERT INTO fdw_type_numeric_ps38
  VALUES (0.340282366920938463463374607431768211456);
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the statement on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: VALUE_ANALYZE_EXCEPTION (SQL-03005: compile failed with error:unsupported_decimal_value message:"invalid decimal value '0.340282366920938463463374607431768211456' (inexact value by rounding)" location:<input>:2:11+41)
CONTEXT:  SQL query: INSERT INTO fdw_type_numeric_ps38
  VALUES (0.340282366920938463463374607431768211456)
--- Test teardown: DDL of the PostgreSQL
DROP FOREIGN TABLE fdw_type_numeric_ps38;
--- Test teardown: DDL of the Tsurugi
SELECT tg_execute_ddl('DROP TABLE fdw_type_numeric_ps38', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

-- Numeric Types - real
--- Test setup: DDL of the Tsurugi
SELECT tg_execute_ddl('
  CREATE TABLE fdw_type_real (c REAL)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

--- Test setup: DDL of the PostgreSQL
CREATE FOREIGN TABLE fdw_type_real (
  c real
) SERVER tsurugidb;
--- Test
INSERT INTO fdw_type_real VALUES ('invalid');
ERROR:  invalid input syntax for type real: "invalid"
LINE 1: INSERT INTO fdw_type_real VALUES ('invalid');
                                          ^
UPDATE fdw_type_real SET invalid = 2 WHERE c >= 1;
ERROR:  column "invalid" of relation "fdw_type_real" does not exist
LINE 1: UPDATE fdw_type_real SET invalid = 2 WHERE c >= 1;
                                 ^
UPDATE fdw_type_real SET c = 2 WHERE invalid = 1;
ERROR:  column "invalid" does not exist
LINE 1: UPDATE fdw_type_real SET c = 2 WHERE invalid = 1;
                                             ^
DELETE FROM fdw_type_real WHERE invalid >= 1;
ERROR:  column "invalid" does not exist
LINE 1: DELETE FROM fdw_type_real WHERE invalid >= 1;
                                        ^
--- Test teardown: DDL of the PostgreSQL
DROP FOREIGN TABLE fdw_type_real;
--- Test teardown: DDL of the Tsurugi
SELECT tg_execute_ddl('DROP TABLE fdw_type_real', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

-- Numeric Types - double precision
--- Test setup: DDL of the Tsurugi
SELECT tg_execute_ddl('
  CREATE TABLE fdw_type_double (c DOUBLE)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

--- Test setup: DDL of the PostgreSQL
CREATE FOREIGN TABLE fdw_type_double (
  c double precision
) SERVER tsurugidb;
--- Test
INSERT INTO fdw_type_double VALUES ('invalid');
ERROR:  invalid input syntax for type double precision: "invalid"
LINE 1: INSERT INTO fdw_type_double VALUES ('invalid');
                                            ^
UPDATE fdw_type_double SET invalid = 2 WHERE c >= 1;
ERROR:  column "invalid" of relation "fdw_type_double" does not exist
LINE 1: UPDATE fdw_type_double SET invalid = 2 WHERE c >= 1;
                                   ^
UPDATE fdw_type_double SET c = 2 WHERE invalid = 1;
ERROR:  column "invalid" does not exist
LINE 1: UPDATE fdw_type_double SET c = 2 WHERE invalid = 1;
                                               ^
DELETE FROM fdw_type_double WHERE invalid >= 1;
ERROR:  column "invalid" does not exist
LINE 1: DELETE FROM fdw_type_double WHERE invalid >= 1;
                                          ^
--- Test teardown: DDL of the PostgreSQL
DROP FOREIGN TABLE fdw_type_double;
--- Test teardown: DDL of the Tsurugi
SELECT tg_execute_ddl('DROP TABLE fdw_type_double', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

-- Character Types - char
--- Test setup: DDL of the Tsurugi
SELECT tg_execute_ddl('
  CREATE TABLE fdw_type_char (c CHAR)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

--- Test setup: DDL of the PostgreSQL
CREATE FOREIGN TABLE fdw_type_char (
  c char
) SERVER tsurugidb;
--- Test
INSERT INTO fdw_type_char VALUES ('iX');
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the statement on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: VALUE_TOO_LONG_EXCEPTION (SQL-02058: evaluated value was too long to write)
CONTEXT:  SQL query: INSERT INTO fdw_type_char VALUES ('iX')
INSERT INTO fdw_type_char VALUES ('i');
UPDATE fdw_type_char SET c = 'uX';
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the statement on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: VALUE_TOO_LONG_EXCEPTION (SQL-02058: evaluated value was too long)
CONTEXT:  SQL query: UPDATE fdw_type_char SET c = 'uX'
UPDATE fdw_type_char SET invalid = 'u' WHERE c = 'i';
ERROR:  column "invalid" of relation "fdw_type_char" does not exist
LINE 1: UPDATE fdw_type_char SET invalid = 'u' WHERE c = 'i';
                                 ^
UPDATE fdw_type_char SET c = 'u' WHERE invalid = 'i';
ERROR:  column "invalid" does not exist
LINE 1: UPDATE fdw_type_char SET c = 'u' WHERE invalid = 'i';
                                               ^
DELETE FROM fdw_type_char WHERE invalid = 'i';
ERROR:  column "invalid" does not exist
LINE 1: DELETE FROM fdw_type_char WHERE invalid = 'i';
                                        ^
--- Test teardown: DDL of the PostgreSQL
DROP FOREIGN TABLE fdw_type_char;
--- Test teardown: DDL of the Tsurugi
SELECT tg_execute_ddl('DROP TABLE fdw_type_char', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

-- Character Types - char(length)
--- Test setup: DDL of the Tsurugi
SELECT tg_execute_ddl('
  CREATE TABLE fdw_type_char_l (c CHAR(10))
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

--- Test setup: DDL of the PostgreSQL
CREATE FOREIGN TABLE fdw_type_char_l (
  c char(10)
) SERVER tsurugidb;
--- Test
INSERT INTO fdw_type_char_l VALUES ('insert_valX');
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the statement on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: VALUE_TOO_LONG_EXCEPTION (SQL-02058: evaluated value was too long to write)
CONTEXT:  SQL query: INSERT INTO fdw_type_char_l VALUES ('insert_valX')
INSERT INTO fdw_type_char_l VALUES ('insert_val');
UPDATE fdw_type_char_l SET c = 'update_valX';
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the statement on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: VALUE_TOO_LONG_EXCEPTION (SQL-02058: evaluated value was too long)
CONTEXT:  SQL query: UPDATE fdw_type_char_l SET c = 'update_valX'
UPDATE fdw_type_char_l SET invalid = 'update_val' WHERE c = 'insert_val';
ERROR:  column "invalid" of relation "fdw_type_char_l" does not exist
LINE 1: UPDATE fdw_type_char_l SET invalid = 'update_val' WHERE c = ...
                                   ^
UPDATE fdw_type_char_l SET c = 'update_valX' WHERE invalid = 'insert_val';
ERROR:  column "invalid" does not exist
LINE 1: ...PDATE fdw_type_char_l SET c = 'update_valX' WHERE invalid = ...
                                                             ^
DELETE FROM fdw_type_char_l WHERE c = 'update_valX';
DELETE FROM fdw_type_char_l WHERE invalid = 'insert_val';
ERROR:  column "invalid" does not exist
LINE 1: DELETE FROM fdw_type_char_l WHERE invalid = 'insert_val';
                                          ^
--- Test teardown: DDL of the PostgreSQL
DROP FOREIGN TABLE fdw_type_char_l;
--- Test teardown: DDL of the Tsurugi
SELECT tg_execute_ddl('DROP TABLE fdw_type_char_l', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

-- Character Types - varchar(length)
--- Test setup: DDL of the Tsurugi
SELECT tg_execute_ddl('
  CREATE TABLE fdw_type_varchar_l (c VARCHAR(10))
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

--- Test setup: DDL of the PostgreSQL
CREATE FOREIGN TABLE fdw_type_varchar_l (
  c varchar(10)
) SERVER tsurugidb;
--- Test
INSERT INTO fdw_type_varchar_l VALUES ('insert_valX');
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the statement on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: VALUE_TOO_LONG_EXCEPTION (SQL-02058: evaluated value was too long to write)
CONTEXT:  SQL query: INSERT INTO fdw_type_varchar_l VALUES ('insert_valX')
INSERT INTO fdw_type_varchar_l VALUES ('insert_val');
UPDATE fdw_type_varchar_l SET c = 'update_valX';
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the statement on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: VALUE_TOO_LONG_EXCEPTION (SQL-02058: evaluated value was too long)
CONTEXT:  SQL query: UPDATE fdw_type_varchar_l SET c = 'update_valX'
UPDATE fdw_type_varchar_l SET invalid = 'update_val' WHERE c = 'insert_val';
ERROR:  column "invalid" of relation "fdw_type_varchar_l" does not exist
LINE 1: UPDATE fdw_type_varchar_l SET invalid = 'update_val' WHERE c...
                                      ^
UPDATE fdw_type_varchar_l SET c = 'update_valX' WHERE invalid = 'insert_val';
ERROR:  column "invalid" does not exist
LINE 1: ...TE fdw_type_varchar_l SET c = 'update_valX' WHERE invalid = ...
                                                             ^
DELETE FROM fdw_type_varchar_l WHERE c = 'update_valX';
DELETE FROM fdw_type_varchar_l WHERE invalid = 'insert_val';
ERROR:  column "invalid" does not exist
LINE 1: DELETE FROM fdw_type_varchar_l WHERE invalid = 'insert_val';
                                             ^
--- Test teardown: DDL of the PostgreSQL
DROP FOREIGN TABLE fdw_type_varchar_l;
--- Test teardown: DDL of the Tsurugi
SELECT tg_execute_ddl('DROP TABLE fdw_type_varchar_l', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

-- Date/Time Types - date
--- Test setup: DDL of the Tsurugi
SELECT tg_execute_ddl('
  CREATE TABLE fdw_type_date (c DATE)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

--- Test setup: DDL of the PostgreSQL
CREATE FOREIGN TABLE fdw_type_date (
  c date
) SERVER tsurugidb;
--- Test
SET DATESTYLE TO 'default';
INSERT INTO fdw_type_date VALUES (date '01:02:03.456');
ERROR:  invalid input syntax for type date: "01:02:03.456"
LINE 1: INSERT INTO fdw_type_date VALUES (date '01:02:03.456');
                                               ^
INSERT INTO fdw_type_date VALUES (time '01:02:03.456');
ERROR:  column "c" is of type date but expression is of type time without time zone
LINE 1: INSERT INTO fdw_type_date VALUES (time '01:02:03.456');
                                               ^
HINT:  You will need to rewrite or cast the expression.
INSERT INTO fdw_type_date VALUES (date '2021-02-30');
ERROR:  date/time field value out of range: "2021-02-30"
LINE 1: INSERT INTO fdw_type_date VALUES (date '2021-02-30');
                                               ^
INSERT INTO fdw_type_date VALUES (date 'invalid');
ERROR:  invalid input syntax for type date: "invalid"
LINE 1: INSERT INTO fdw_type_date VALUES (date 'invalid');
                                               ^
SET DATESTYLE TO ISO, YMD;
INSERT INTO fdw_type_date VALUES (date '1/8/1999');
ERROR:  date/time field value out of range: "1/8/1999"
LINE 1: INSERT INTO fdw_type_date VALUES (date '1/8/1999');
                                               ^
HINT:  Perhaps you need a different "datestyle" setting.
INSERT INTO fdw_type_date VALUES (date '1/18/1999');
ERROR:  date/time field value out of range: "1/18/1999"
LINE 1: INSERT INTO fdw_type_date VALUES (date '1/18/1999');
                                               ^
HINT:  Perhaps you need a different "datestyle" setting.
INSERT INTO fdw_type_date VALUES (date '08-Jan-99');
ERROR:  date/time field value out of range: "08-Jan-99"
LINE 1: INSERT INTO fdw_type_date VALUES (date '08-Jan-99');
                                               ^
HINT:  Perhaps you need a different "datestyle" setting.
INSERT INTO fdw_type_date VALUES (date 'Jan-08-99');
ERROR:  date/time field value out of range: "Jan-08-99"
LINE 1: INSERT INTO fdw_type_date VALUES (date 'Jan-08-99');
                                               ^
HINT:  Perhaps you need a different "datestyle" setting.
INSERT INTO fdw_type_date VALUES (date 'January 8, 99 BC');
ERROR:  date/time field value out of range: "January 8, 99 BC"
LINE 1: INSERT INTO fdw_type_date VALUES (date 'January 8, 99 BC');
                                               ^
HINT:  Perhaps you need a different "datestyle" setting.
SET DATESTYLE TO 'default';
--- Test teardown: DDL of the PostgreSQL
DROP FOREIGN TABLE fdw_type_date;
--- Test teardown: DDL of the Tsurugi
SELECT tg_execute_ddl('DROP TABLE fdw_type_date', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

-- Date/Time Types - time
--- Test setup: DDL of the Tsurugi
SELECT tg_execute_ddl('
  CREATE TABLE fdw_type_time (c TIME)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

--- Test setup: DDL of the PostgreSQL
CREATE FOREIGN TABLE fdw_type_time (
  c time
) SERVER tsurugidb;
--- Test
INSERT INTO fdw_type_time VALUES (date '2025/01/01');
ERROR:  column "c" is of type time without time zone but expression is of type date
LINE 1: INSERT INTO fdw_type_time VALUES (date '2025/01/01');
                                               ^
HINT:  You will need to rewrite or cast the expression.
INSERT INTO fdw_type_time VALUES (time '2025/01/01');
ERROR:  invalid input syntax for type time: "2025/01/01"
LINE 1: INSERT INTO fdw_type_time VALUES (time '2025/01/01');
                                               ^
INSERT INTO fdw_type_time VALUES (time '25:00:00');
ERROR:  date/time field value out of range: "25:00:00"
LINE 1: INSERT INTO fdw_type_time VALUES (time '25:00:00');
                                               ^
INSERT INTO fdw_type_time VALUES (time '050607.890123456');
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the statement on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: VALUE_ANALYZE_EXCEPTION (SQL-03005: compile failed with error:unsupported_string_value message:"invalid time literal: 050607.890123456 (syntax error, unexpected <DECIMAL>, expecting <INTEGER> or + or - or Z)" location:<input>:1:40+18)
CONTEXT:  SQL query: INSERT INTO fdw_type_time VALUES (time '050607.890123456')
INSERT INTO fdw_type_time VALUES (time 'invalid');
ERROR:  invalid input syntax for type time: "invalid"
LINE 1: INSERT INTO fdw_type_time VALUES (time 'invalid');
                                               ^
--- Test teardown: DDL of the PostgreSQL
DROP FOREIGN TABLE fdw_type_time;
--- Test teardown: DDL of the Tsurugi
SELECT tg_execute_ddl('DROP TABLE fdw_type_time', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

-- Date/Time Types - timestamp
--- Test setup: DDL of the Tsurugi
SELECT tg_execute_ddl('
  CREATE TABLE fdw_type_timestamp (c TIMESTAMP)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

--- Test setup: DDL of the PostgreSQL
CREATE FOREIGN TABLE fdw_type_timestamp (
  c timestamp
) SERVER tsurugidb;
--- Test
INSERT INTO fdw_type_timestamp VALUES (timestamp '01:02:03.456');
ERROR:  invalid input syntax for type timestamp: "01:02:03.456"
LINE 1: INSERT INTO fdw_type_timestamp VALUES (timestamp '01:02:03.4...
                                                         ^
INSERT INTO fdw_type_timestamp VALUES (date '2021-02-30');
ERROR:  date/time field value out of range: "2021-02-30"
LINE 1: INSERT INTO fdw_type_timestamp VALUES (date '2021-02-30');
                                                    ^
INSERT INTO fdw_type_timestamp VALUES (timestamp '2021-02-30 04:05:06.789');
ERROR:  date/time field value out of range: "2021-02-30 04:05:06.789"
LINE 1: INSERT INTO fdw_type_timestamp VALUES (timestamp '2021-02-30...
                                                         ^
INSERT INTO fdw_type_timestamp VALUES (timestamp '2025-01-01 25:00:00');
ERROR:  date/time field value out of range: "2025-01-01 25:00:00"
LINE 1: INSERT INTO fdw_type_timestamp VALUES (timestamp '2025-01-01...
                                                         ^
INSERT INTO fdw_type_timestamp VALUES (timestamp '2025/01/01');
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the statement on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: VALUE_ANALYZE_EXCEPTION (SQL-03005: compile failed with error:unsupported_string_value message:"invalid datetime literal: 2025/01/01 (syntax error, unexpected <ERROR>, expecting : or -)" location:<input>:1:50+12)
CONTEXT:  SQL query: INSERT INTO fdw_type_timestamp VALUES (timestamp '2025/01/01')
INSERT INTO fdw_type_timestamp VALUES (timestamp '2025/01/01 12:00');
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the statement on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: VALUE_ANALYZE_EXCEPTION (SQL-03005: compile failed with error:unsupported_string_value message:"invalid datetime literal: 2025/01/01 12:00 (syntax error, unexpected <ERROR>, expecting : or -)" location:<input>:1:50+18)
CONTEXT:  SQL query: INSERT INTO fdw_type_timestamp VALUES (timestamp '2025/01/01 12:00')
INSERT INTO fdw_type_timestamp VALUES (timestamp 'invalid');
ERROR:  invalid input syntax for type timestamp: "invalid"
LINE 1: INSERT INTO fdw_type_timestamp VALUES (timestamp 'invalid');
                                                         ^
SET DATESTYLE TO ISO, YMD;
INSERT INTO fdw_type_timestamp VALUES (timestamp '1/8/1999 01:02:03');
ERROR:  date/time field value out of range: "1/8/1999 01:02:03"
LINE 1: INSERT INTO fdw_type_timestamp VALUES (timestamp '1/8/1999 0...
                                                         ^
HINT:  Perhaps you need a different "datestyle" setting.
INSERT INTO fdw_type_timestamp VALUES (timestamp '1/18/1999 01:02:03');
ERROR:  date/time field value out of range: "1/18/1999 01:02:03"
LINE 1: INSERT INTO fdw_type_timestamp VALUES (timestamp '1/18/1999 ...
                                                         ^
HINT:  Perhaps you need a different "datestyle" setting.
INSERT INTO fdw_type_timestamp VALUES (timestamp '08-Jan-99 01:02:03');
ERROR:  date/time field value out of range: "08-Jan-99 01:02:03"
LINE 1: INSERT INTO fdw_type_timestamp VALUES (timestamp '08-Jan-99 ...
                                                         ^
HINT:  Perhaps you need a different "datestyle" setting.
INSERT INTO fdw_type_timestamp VALUES (timestamp 'Jan-08-99 01:02:03');
ERROR:  date/time field value out of range: "Jan-08-99 01:02:03"
LINE 1: INSERT INTO fdw_type_timestamp VALUES (timestamp 'Jan-08-99 ...
                                                         ^
HINT:  Perhaps you need a different "datestyle" setting.
INSERT INTO fdw_type_timestamp VALUES (timestamp 'January 8, 99 BC 01:02:03');
ERROR:  date/time field value out of range: "January 8, 99 BC 01:02:03"
LINE 1: INSERT INTO fdw_type_timestamp VALUES (timestamp 'January 8,...
                                                         ^
HINT:  Perhaps you need a different "datestyle" setting.
SET DATESTYLE TO 'default';
--- Test teardown: DDL of the PostgreSQL
DROP FOREIGN TABLE fdw_type_timestamp;
--- Test teardown: DDL of the Tsurugi
SELECT tg_execute_ddl('DROP TABLE fdw_type_timestamp', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

-- Date/Time Types - timestamp without time zone
--- Test setup: DDL of the Tsurugi
SELECT tg_execute_ddl('
  CREATE TABLE fdw_type_timestamp_wo_tz (c TIMESTAMP WITHOUT TIME ZONE)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

--- Test setup: DDL of the PostgreSQL
CREATE FOREIGN TABLE fdw_type_timestamp_wo_tz (
  c timestamp without time zone
) SERVER tsurugidb;
--- Test
INSERT INTO fdw_type_timestamp_wo_tz
  VALUES (timestamp without time zone '01:02:03.456');
ERROR:  invalid input syntax for type timestamp: "01:02:03.456"
LINE 2:   VALUES (timestamp without time zone '01:02:03.456');
                                              ^
INSERT INTO fdw_type_timestamp_wo_tz
  VALUES (date '2021-02-30');
ERROR:  date/time field value out of range: "2021-02-30"
LINE 2:   VALUES (date '2021-02-30');
                       ^
INSERT INTO fdw_type_timestamp_wo_tz
  VALUES (timestamp without time zone '2021-02-30 04:05:06.789');
ERROR:  date/time field value out of range: "2021-02-30 04:05:06.789"
LINE 2:   VALUES (timestamp without time zone '2021-02-30 04:05:06.7...
                                              ^
INSERT INTO fdw_type_timestamp_wo_tz
  VALUES (timestamp without time zone '2025-01-01 25:00:00');
ERROR:  date/time field value out of range: "2025-01-01 25:00:00"
LINE 2:   VALUES (timestamp without time zone '2025-01-01 25:00:00')...
                                              ^
INSERT INTO fdw_type_timestamp_wo_tz
  VALUES (timestamp without time zone '2025/01/01');
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the statement on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: VALUE_ANALYZE_EXCEPTION (SQL-03005: compile failed with error:unsupported_string_value message:"invalid datetime literal: 2025/01/01 (syntax error, unexpected <ERROR>, expecting : or -)" location:<input>:2:39+12)
CONTEXT:  SQL query: INSERT INTO fdw_type_timestamp_wo_tz
  VALUES (timestamp without time zone '2025/01/01')
INSERT INTO fdw_type_timestamp_wo_tz
  VALUES (timestamp without time zone '2025/01/01 12:00');
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the statement on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: VALUE_ANALYZE_EXCEPTION (SQL-03005: compile failed with error:unsupported_string_value message:"invalid datetime literal: 2025/01/01 12:00 (syntax error, unexpected <ERROR>, expecting : or -)" location:<input>:2:39+18)
CONTEXT:  SQL query: INSERT INTO fdw_type_timestamp_wo_tz
  VALUES (timestamp without time zone '2025/01/01 12:00')
INSERT INTO fdw_type_timestamp_wo_tz
  VALUES (timestamp without time zone 'invalid');
ERROR:  invalid input syntax for type timestamp: "invalid"
LINE 2:   VALUES (timestamp without time zone 'invalid');
                                              ^
SET DATESTYLE TO ISO, YMD;
INSERT INTO fdw_type_timestamp_wo_tz
  VALUES (timestamp without time zone '1/8/1999 01:02:03');
ERROR:  date/time field value out of range: "1/8/1999 01:02:03"
LINE 2:   VALUES (timestamp without time zone '1/8/1999 01:02:03');
                                              ^
HINT:  Perhaps you need a different "datestyle" setting.
INSERT INTO fdw_type_timestamp_wo_tz
  VALUES (timestamp without time zone '1/18/1999 01:02:03');
ERROR:  date/time field value out of range: "1/18/1999 01:02:03"
LINE 2:   VALUES (timestamp without time zone '1/18/1999 01:02:03');
                                              ^
HINT:  Perhaps you need a different "datestyle" setting.
INSERT INTO fdw_type_timestamp_wo_tz
  VALUES (timestamp without time zone '08-Jan-99 01:02:03');
ERROR:  date/time field value out of range: "08-Jan-99 01:02:03"
LINE 2:   VALUES (timestamp without time zone '08-Jan-99 01:02:03');
                                              ^
HINT:  Perhaps you need a different "datestyle" setting.
INSERT INTO fdw_type_timestamp_wo_tz
  VALUES (timestamp without time zone 'Jan-08-99 01:02:03');
ERROR:  date/time field value out of range: "Jan-08-99 01:02:03"
LINE 2:   VALUES (timestamp without time zone 'Jan-08-99 01:02:03');
                                              ^
HINT:  Perhaps you need a different "datestyle" setting.
INSERT INTO fdw_type_timestamp_wo_tz
  VALUES (timestamp without time zone 'January 8, 99 BC 01:02:03');
ERROR:  date/time field value out of range: "January 8, 99 BC 01:02:03"
LINE 2:   VALUES (timestamp without time zone 'January 8, 99 BC 01:0...
                                              ^
HINT:  Perhaps you need a different "datestyle" setting.
SET DATESTYLE TO 'default';
--- Test teardown: DDL of the PostgreSQL
DROP FOREIGN TABLE fdw_type_timestamp_wo_tz;
--- Test teardown: DDL of the Tsurugi
SELECT tg_execute_ddl('DROP TABLE fdw_type_timestamp_wo_tz', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

-- Date/Time Types - timestamp with time zone
--- Test setup: DDL of the Tsurugi
SELECT tg_execute_ddl('
  CREATE TABLE fdw_type_timestamp_tz (c TIMESTAMP WITH TIME ZONE)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

--- Test setup: DDL of the PostgreSQL
CREATE FOREIGN TABLE fdw_type_timestamp_tz (
  c timestamp with time zone
) SERVER tsurugidb;
--- Test
INSERT INTO fdw_type_timestamp_tz
  VALUES (time with time zone '04:05:06.789+9:00');
ERROR:  column "c" is of type timestamp with time zone but expression is of type time with time zone
LINE 2:   VALUES (time with time zone '04:05:06.789+9:00');
                                      ^
HINT:  You will need to rewrite or cast the expression.
INSERT INTO fdw_type_timestamp_tz
  VALUES (timestamp with time zone '2025-01-01 12:00-16:00');
ERROR:  time zone displacement out of range: "2025-01-01 12:00-16:00"
LINE 2:   VALUES (timestamp with time zone '2025-01-01 12:00-16:00')...
                                           ^
INSERT INTO fdw_type_timestamp_tz
  VALUES (timestamp with time zone '2025-01-01 12:00+16:00');
ERROR:  time zone displacement out of range: "2025-01-01 12:00+16:00"
LINE 2:   VALUES (timestamp with time zone '2025-01-01 12:00+16:00')...
                                           ^
INSERT INTO fdw_type_timestamp_tz
  VALUES (timestamp with time zone '2021-02-30 04:05:06.789+9:00');
ERROR:  date/time field value out of range: "2021-02-30 04:05:06.789+9:00"
LINE 2:   VALUES (timestamp with time zone '2021-02-30 04:05:06.789+...
                                           ^
INSERT INTO fdw_type_timestamp_tz
  VALUES (timestamp with time zone 'invalid+tz');
ERROR:  invalid input syntax for type timestamp with time zone: "invalid+tz"
LINE 2:   VALUES (timestamp with time zone 'invalid+tz');
                                           ^
SET DATESTYLE TO ISO, YMD;
INSERT INTO fdw_type_timestamp_tz
  VALUES (timestamp with time zone '1/8/1999 01:02:03+0900');
ERROR:  date/time field value out of range: "1/8/1999 01:02:03+0900"
LINE 2:   VALUES (timestamp with time zone '1/8/1999 01:02:03+0900')...
                                           ^
HINT:  Perhaps you need a different "datestyle" setting.
INSERT INTO fdw_type_timestamp_tz
  VALUES (timestamp with time zone '1/18/1999 01:02:03+0900');
ERROR:  date/time field value out of range: "1/18/1999 01:02:03+0900"
LINE 2:   VALUES (timestamp with time zone '1/18/1999 01:02:03+0900'...
                                           ^
HINT:  Perhaps you need a different "datestyle" setting.
INSERT INTO fdw_type_timestamp_tz
  VALUES (timestamp with time zone '08-Jan-99 01:02:03+0900');
ERROR:  date/time field value out of range: "08-Jan-99 01:02:03+0900"
LINE 2:   VALUES (timestamp with time zone '08-Jan-99 01:02:03+0900'...
                                           ^
HINT:  Perhaps you need a different "datestyle" setting.
INSERT INTO fdw_type_timestamp_tz
  VALUES (timestamp with time zone 'Jan-08-99 01:02:03+0900');
ERROR:  date/time field value out of range: "Jan-08-99 01:02:03+0900"
LINE 2:   VALUES (timestamp with time zone 'Jan-08-99 01:02:03+0900'...
                                           ^
HINT:  Perhaps you need a different "datestyle" setting.
INSERT INTO fdw_type_timestamp_tz
  VALUES (timestamp with time zone 'January 8, 99 BC 01:02:03+0900');
ERROR:  date/time field value out of range: "January 8, 99 BC 01:02:03+0900"
LINE 2:   VALUES (timestamp with time zone 'January 8, 99 BC 01:02:0...
                                           ^
HINT:  Perhaps you need a different "datestyle" setting.
INSERT INTO fdw_type_timestamp_tz
  VALUES (timestamp with time zone '2025-01-01 12:01:02.34567 UTC');
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the statement on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: VALUE_ANALYZE_EXCEPTION (SQL-03005: compile failed with error:unsupported_string_value message:"invalid datetime literal: 2025-01-01 12:01:02.34567 UTC (syntax error, unexpected <WHITESPACE>, expecting <END_OF_FILE> or + or - or Z)" location:<input>:2:36+31)
CONTEXT:  SQL query: INSERT INTO fdw_type_timestamp_tz
  VALUES (timestamp with time zone '2025-01-01 12:01:02.34567 UTC')
INSERT INTO fdw_type_timestamp_tz
  VALUES (timestamp with time zone '2025-01-01 12:01:02.34567 Universal');
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the statement on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: VALUE_ANALYZE_EXCEPTION (SQL-03005: compile failed with error:unsupported_string_value message:"invalid datetime literal: 2025-01-01 12:01:02.34567 Universal (syntax error, unexpected <WHITESPACE>, expecting <END_OF_FILE> or + or - or Z)" location:<input>:2:36+37)
CONTEXT:  SQL query: INSERT INTO fdw_type_timestamp_tz
  VALUES (timestamp with time zone '2025-01-01 12:01:02.34567 Universal')
INSERT INTO fdw_type_timestamp_tz
  VALUES (timestamp with time zone '2025-01-01 12:00');
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the statement on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: VALUE_ANALYZE_EXCEPTION (SQL-03005: compile failed with error:unsupported_string_value message:"invalid datetime literal: 2025-01-01 12:00 (syntax error, unexpected <END_OF_FILE>, expecting :)" location:<input>:2:36+18)
CONTEXT:  SQL query: INSERT INTO fdw_type_timestamp_tz
  VALUES (timestamp with time zone '2025-01-01 12:00')
SET DATESTYLE TO 'default';
--- Test teardown: DDL of the PostgreSQL
DROP FOREIGN TABLE fdw_type_timestamp_tz;
--- Test teardown: DDL of the Tsurugi
SELECT tg_execute_ddl('DROP TABLE fdw_type_timestamp_tz', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

-- Binary Types - bytea
--- Test setup: DDL of the Tsurugi
SELECT tg_execute_ddl('
  CREATE TABLE fdw_type_bytea (c VARBINARY)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

--- Test setup: DDL of the PostgreSQL
CREATE FOREIGN TABLE fdw_type_bytea (
  c bytea
) SERVER tsurugidb;
--- Test
INSERT INTO fdw_type_bytea VALUES (' \x00');
ERROR:  invalid input syntax for type bytea
LINE 1: INSERT INTO fdw_type_bytea VALUES (' \x00');
                                           ^
INSERT INTO fdw_type_bytea VALUES ('\x00 ');
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the statement on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: VALUE_EVALUATION_EXCEPTION (SQL-02011: An error occurred in evaluating values. error:format_error)
CONTEXT:  SQL query: INSERT INTO fdw_type_bytea VALUES ('\x00 ')
INSERT INTO fdw_type_bytea VALUES ('\x00\x23');
ERROR:  invalid hexadecimal digit: "\"
LINE 1: INSERT INTO fdw_type_bytea VALUES ('\x00\x23');
                                           ^
INSERT INTO fdw_type_bytea VALUES ('\x0');
ERROR:  invalid hexadecimal data: odd number of digits
LINE 1: INSERT INTO fdw_type_bytea VALUES ('\x0');
                                           ^
INSERT INTO fdw_type_bytea VALUES ('\x001');
ERROR:  invalid hexadecimal data: odd number of digits
LINE 1: INSERT INTO fdw_type_bytea VALUES ('\x001');
                                           ^
INSERT INTO fdw_type_bytea VALUES ('abc');
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the statement on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: VALUE_EVALUATION_EXCEPTION (SQL-02011: An error occurred in evaluating values. error:format_error)
CONTEXT:  SQL query: INSERT INTO fdw_type_bytea VALUES ('abc')
INSERT INTO fdw_type_bytea VALUES ('\xqw');
ERROR:  invalid hexadecimal digit: "q"
LINE 1: INSERT INTO fdw_type_bytea VALUES ('\xqw');
                                           ^
SELECT * FROM fdw_type_bytea WHERE c = ' \x00' ORDER BY c;
ERROR:  invalid input syntax for type bytea
LINE 1: SELECT * FROM fdw_type_bytea WHERE c = ' \x00' ORDER BY c;
                                               ^
SELECT * FROM fdw_type_bytea WHERE c = '\x00 ' ORDER BY c;
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the query on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: TYPE_ANALYZE_EXCEPTION (SQL-03003: compile failed with error:inconsistent_type message:"character-varying(*) (expected: {octet_string})" location:<input>:1:40+7)
CONTEXT:  SQL query: SELECT * FROM fdw_type_bytea WHERE c = '\x00 ' ORDER BY c
SELECT * FROM fdw_type_bytea WHERE c = '\x00\x23' ORDER BY c;
ERROR:  invalid hexadecimal digit: "\"
LINE 1: SELECT * FROM fdw_type_bytea WHERE c = '\x00\x23' ORDER BY c...
                                               ^
SELECT * FROM fdw_type_bytea WHERE c = '\x0' ORDER BY c;
ERROR:  invalid hexadecimal data: odd number of digits
LINE 1: SELECT * FROM fdw_type_bytea WHERE c = '\x0' ORDER BY c;
                                               ^
SELECT * FROM fdw_type_bytea WHERE c = '\x001' ORDER BY c;
ERROR:  invalid hexadecimal data: odd number of digits
LINE 1: SELECT * FROM fdw_type_bytea WHERE c = '\x001' ORDER BY c;
                                               ^
SELECT * FROM fdw_type_bytea WHERE c = 'abc' ORDER BY c;
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the query on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: TYPE_ANALYZE_EXCEPTION (SQL-03003: compile failed with error:inconsistent_type message:"character-varying(*) (expected: {octet_string})" location:<input>:1:40+5)
CONTEXT:  SQL query: SELECT * FROM fdw_type_bytea WHERE c = 'abc' ORDER BY c
SELECT * FROM fdw_type_bytea WHERE c = '' ORDER BY c;
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the query on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: TYPE_ANALYZE_EXCEPTION (SQL-03003: compile failed with error:inconsistent_type message:"character-varying(*) (expected: {octet_string})" location:<input>:1:40+2)
CONTEXT:  SQL query: SELECT * FROM fdw_type_bytea WHERE c = '' ORDER BY c
SELECT * FROM fdw_type_bytea WHERE c = '\xqw' ORDER BY c;
ERROR:  invalid hexadecimal digit: "q"
LINE 1: SELECT * FROM fdw_type_bytea WHERE c = '\xqw' ORDER BY c;
                                               ^
INSERT INTO fdw_type_bytea VALUES ('\x7f');
UPDATE fdw_type_bytea SET c = '\x31' WHERE c = ' \x00';
ERROR:  invalid input syntax for type bytea
LINE 1: UPDATE fdw_type_bytea SET c = '\x31' WHERE c = ' \x00';
                                                       ^
UPDATE fdw_type_bytea SET c = '\x31' WHERE c = '\x00 ';
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the statement on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: TYPE_ANALYZE_EXCEPTION (SQL-03003: compile failed with error:inconsistent_type message:"character-varying(*) (expected: {octet_string})" location:<input>:1:47+7)
CONTEXT:  SQL query: UPDATE fdw_type_bytea SET c = X'31' WHERE c = '\x00 '
UPDATE fdw_type_bytea SET c = '\x31' WHERE c = '\x00\x23';
ERROR:  invalid hexadecimal digit: "\"
LINE 1: UPDATE fdw_type_bytea SET c = '\x31' WHERE c = '\x00\x23';
                                                       ^
UPDATE fdw_type_bytea SET c = '\x31' WHERE c = '\x0';
ERROR:  invalid hexadecimal data: odd number of digits
LINE 1: UPDATE fdw_type_bytea SET c = '\x31' WHERE c = '\x0';
                                                       ^
UPDATE fdw_type_bytea SET c = '\x31' WHERE c = '\x001';
ERROR:  invalid hexadecimal data: odd number of digits
LINE 1: UPDATE fdw_type_bytea SET c = '\x31' WHERE c = '\x001';
                                                       ^
UPDATE fdw_type_bytea SET c = '\x31' WHERE c = 'abc';
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the statement on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: TYPE_ANALYZE_EXCEPTION (SQL-03003: compile failed with error:inconsistent_type message:"character-varying(*) (expected: {octet_string})" location:<input>:1:47+5)
CONTEXT:  SQL query: UPDATE fdw_type_bytea SET c = X'31' WHERE c = 'abc'
UPDATE fdw_type_bytea SET c = '\x31' WHERE c = '';
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the statement on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: TYPE_ANALYZE_EXCEPTION (SQL-03003: compile failed with error:inconsistent_type message:"character-varying(*) (expected: {octet_string})" location:<input>:1:47+2)
CONTEXT:  SQL query: UPDATE fdw_type_bytea SET c = X'31' WHERE c = ''
UPDATE fdw_type_bytea SET c = '\x31' WHERE c = '\xqw';
ERROR:  invalid hexadecimal digit: "q"
LINE 1: UPDATE fdw_type_bytea SET c = '\x31' WHERE c = '\xqw';
                                                       ^
UPDATE fdw_type_bytea SET c = ' \x00';
ERROR:  invalid input syntax for type bytea
LINE 1: UPDATE fdw_type_bytea SET c = ' \x00';
                                      ^
UPDATE fdw_type_bytea SET c = '\x00 ';
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the statement on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: VALUE_EVALUATION_EXCEPTION (SQL-02011: an error (format_error) occurred:[diagnostic(code=format_error, message='invalid hexadecimal string passed for conversion', args=['\x00 '])])
CONTEXT:  SQL query: UPDATE fdw_type_bytea SET c = '\x00 '
UPDATE fdw_type_bytea SET c = '\x00\x23';
ERROR:  invalid hexadecimal digit: "\"
LINE 1: UPDATE fdw_type_bytea SET c = '\x00\x23';
                                      ^
UPDATE fdw_type_bytea SET c = '\x0';
ERROR:  invalid hexadecimal data: odd number of digits
LINE 1: UPDATE fdw_type_bytea SET c = '\x0';
                                      ^
UPDATE fdw_type_bytea SET c = '\x001';
ERROR:  invalid hexadecimal data: odd number of digits
LINE 1: UPDATE fdw_type_bytea SET c = '\x001';
                                      ^
UPDATE fdw_type_bytea SET c = 'abc';
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the statement on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: VALUE_EVALUATION_EXCEPTION (SQL-02011: an error (format_error) occurred:[diagnostic(code=format_error, message='invalid hexadecimal string passed for conversion', args=['abc'])])
CONTEXT:  SQL query: UPDATE fdw_type_bytea SET c = 'abc'
UPDATE fdw_type_bytea SET c = '\xqw';
ERROR:  invalid hexadecimal digit: "q"
LINE 1: UPDATE fdw_type_bytea SET c = '\xqw';
                                      ^
DELETE FROM fdw_type_bytea WHERE c = ' \x00';
ERROR:  invalid input syntax for type bytea
LINE 1: DELETE FROM fdw_type_bytea WHERE c = ' \x00';
                                             ^
DELETE FROM fdw_type_bytea WHERE c = '\x00 ';
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the statement on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: TYPE_ANALYZE_EXCEPTION (SQL-03003: compile failed with error:inconsistent_type message:"character-varying(*) (expected: {octet_string})" location:<input>:1:38+7)
CONTEXT:  SQL query: DELETE FROM fdw_type_bytea WHERE c = '\x00 '
DELETE FROM fdw_type_bytea WHERE c = '\x00\x23';
ERROR:  invalid hexadecimal digit: "\"
LINE 1: DELETE FROM fdw_type_bytea WHERE c = '\x00\x23';
                                             ^
DELETE FROM fdw_type_bytea WHERE c = '\x0';
ERROR:  invalid hexadecimal data: odd number of digits
LINE 1: DELETE FROM fdw_type_bytea WHERE c = '\x0';
                                             ^
DELETE FROM fdw_type_bytea WHERE c = '\x001';
ERROR:  invalid hexadecimal data: odd number of digits
LINE 1: DELETE FROM fdw_type_bytea WHERE c = '\x001';
                                             ^
DELETE FROM fdw_type_bytea WHERE c = 'abc';
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the statement on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: TYPE_ANALYZE_EXCEPTION (SQL-03003: compile failed with error:inconsistent_type message:"character-varying(*) (expected: {octet_string})" location:<input>:1:38+5)
CONTEXT:  SQL query: DELETE FROM fdw_type_bytea WHERE c = 'abc'
DELETE FROM fdw_type_bytea WHERE c = '';
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the statement on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: TYPE_ANALYZE_EXCEPTION (SQL-03003: compile failed with error:inconsistent_type message:"character-varying(*) (expected: {octet_string})" location:<input>:1:38+2)
CONTEXT:  SQL query: DELETE FROM fdw_type_bytea WHERE c = ''
DELETE FROM fdw_type_bytea WHERE c = '\xqw';
ERROR:  invalid hexadecimal digit: "q"
LINE 1: DELETE FROM fdw_type_bytea WHERE c = '\xqw';
                                             ^
--- Test teardown: DDL of the PostgreSQL
DROP FOREIGN TABLE fdw_type_bytea;
--- Test teardown: DDL of the Tsurugi
SELECT tg_execute_ddl('DROP TABLE fdw_type_bytea', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

-- Unsupported Types - serial
--- Test setup: DDL of the Tsurugi
SELECT tg_execute_ddl('
  CREATE TABLE fdw_type_unsupported (c1 INTEGER, c2 CHAR(14))
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

--- Test setup: DDL of the PostgreSQL
CREATE FOREIGN TABLE fdw_type_unsupported (c1 serial, c2 char(14)) SERVER tsurugidb;
--- Test
INSERT INTO fdw_type_unsupported (c2) VALUES ('serial is null');
SELECT * FROM fdw_type_unsupported;
 c1 |       c2       
----+----------------
    | serial is null
(1 row)

--- Test teardown: DDL of the PostgreSQL
DROP FOREIGN TABLE fdw_type_unsupported;
--- Test teardown: DDL of the Tsurugi
SELECT tg_execute_ddl('DROP TABLE fdw_type_unsupported', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

-- Unsupported Types - bigserial
--- Test setup: DDL of the Tsurugi
SELECT tg_execute_ddl('
  CREATE TABLE fdw_type_unsupported (c1 BIGINT, c2 CHAR(14))
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

--- Test setup: DDL of the PostgreSQL
CREATE FOREIGN TABLE fdw_type_unsupported (c1 bigserial, c2 char(14))
  SERVER tsurugidb;
-- Test
INSERT INTO fdw_type_unsupported (c2) VALUES ('serial is null');
SELECT * FROM fdw_type_unsupported;
 c1 |       c2       
----+----------------
    | serial is null
(1 row)

--- Test teardown: DDL of the PostgreSQL
DROP FOREIGN TABLE fdw_type_unsupported;
--- Test teardown: DDL of the Tsurugi
SELECT tg_execute_ddl('DROP TABLE fdw_type_unsupported', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

-- Unsupported Types - bit
--- Test setup: DDL of the Tsurugi
SELECT tg_execute_ddl('
  CREATE TABLE fdw_type_unsupported (c BINARY(4))
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

--- Test setup: DDL of the PostgreSQL
CREATE FOREIGN TABLE fdw_type_unsupported (c bit(4)) SERVER tsurugidb;
--- Test
INSERT INTO fdw_type_unsupported VALUES (B'1010');
ERROR:  tsurugi_fdw : unrecognized type oid: 1560
INSERT INTO fdw_type_unsupported VALUES ('1010');
ERROR:  tsurugi_fdw : unrecognized type oid: 1560
SELECT * FROM fdw_type_unsupported;
ERROR:  tsurugi_fdw : unrecognized type oid: 1560
--- Test teardown: DDL of the PostgreSQL
DROP FOREIGN TABLE fdw_type_unsupported;
--- Test teardown: DDL of the Tsurugi
SELECT tg_execute_ddl('DROP TABLE fdw_type_unsupported', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

-- Unsupported Types - bit varying
--- Test setup: DDL of the Tsurugi
SELECT tg_execute_ddl('
  CREATE TABLE fdw_type_unsupported (c VARBINARY(4))
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

--- Test setup: DDL of the PostgreSQL
CREATE FOREIGN TABLE fdw_type_unsupported (c bit varying(4)) SERVER tsurugidb;
--- Test
INSERT INTO fdw_type_unsupported VALUES (B'1010');
ERROR:  tsurugi_fdw : unrecognized type oid: 1562
INSERT INTO fdw_type_unsupported VALUES ('1010');
ERROR:  tsurugi_fdw : unrecognized type oid: 1562
SELECT * FROM fdw_type_unsupported;
ERROR:  tsurugi_fdw : unrecognized type oid: 1562
--- Test teardown: DDL of the PostgreSQL
DROP FOREIGN TABLE fdw_type_unsupported;
--- Test teardown: DDL of the Tsurugi
SELECT tg_execute_ddl('DROP TABLE fdw_type_unsupported', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

-- Unsupported Types - boolean
--- Test setup: DDL of the Tsurugi
SELECT tg_execute_ddl('
  CREATE TABLE fdw_type_unsupported (c DECIMAL(1))
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

--- Test setup: DDL of the PostgreSQL
CREATE FOREIGN TABLE fdw_type_unsupported (c boolean) SERVER tsurugidb;
--- Test
INSERT INTO fdw_type_unsupported VALUES (true::boolean);
ERROR:  tsurugi_fdw : unrecognized type oid: 16
INSERT INTO fdw_type_unsupported VALUES (true);
ERROR:  tsurugi_fdw : unrecognized type oid: 16
SELECT * FROM fdw_type_unsupported;
ERROR:  tsurugi_fdw : unrecognized type oid: 16
--- Test teardown: DDL of the PostgreSQL
DROP FOREIGN TABLE fdw_type_unsupported;
--- Test teardown: DDL of the Tsurugi
SELECT tg_execute_ddl('DROP TABLE fdw_type_unsupported', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

-- Unsupported Types - box
--- Test setup: DDL of the Tsurugi
SELECT tg_execute_ddl('
  CREATE TABLE fdw_type_unsupported (c VARCHAR)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

--- Test setup: DDL of the PostgreSQL
CREATE FOREIGN TABLE fdw_type_unsupported (c box) SERVER tsurugidb;
--- Test
INSERT INTO fdw_type_unsupported VALUES ('(1,2),(3,4)'::box);
ERROR:  tsurugi_fdw : unrecognized type oid: 603
INSERT INTO fdw_type_unsupported VALUES ('(1,2),(3,4)');
ERROR:  tsurugi_fdw : unrecognized type oid: 603
SELECT * FROM fdw_type_unsupported;
ERROR:  tsurugi_fdw : unrecognized type oid: 603
--- Test teardown: DDL of the PostgreSQL
DROP FOREIGN TABLE fdw_type_unsupported;
--- Test teardown: DDL of the Tsurugi
SELECT tg_execute_ddl('DROP TABLE fdw_type_unsupported', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

-- Unsupported Types - cidr
--- Test setup: DDL of the Tsurugi
SELECT tg_execute_ddl('
  CREATE TABLE fdw_type_unsupported (c VARCHAR)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

--- Test setup: DDL of the PostgreSQL
CREATE FOREIGN TABLE fdw_type_unsupported (c cidr) SERVER tsurugidb;
--- Test
INSERT INTO fdw_type_unsupported VALUES ('192.168.0.0/24'::cidr);
ERROR:  tsurugi_fdw : unrecognized type oid: 650
INSERT INTO fdw_type_unsupported VALUES ('192.168.0.0/24');
ERROR:  tsurugi_fdw : unrecognized type oid: 650
SELECT * FROM fdw_type_unsupported;
ERROR:  tsurugi_fdw : unrecognized type oid: 650
--- Test teardown: DDL of the PostgreSQL
DROP FOREIGN TABLE fdw_type_unsupported;
--- Test teardown: DDL of the Tsurugi
SELECT tg_execute_ddl('DROP TABLE fdw_type_unsupported', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

-- Unsupported Types - circle
--- Test setup: DDL of the Tsurugi
SELECT tg_execute_ddl('
  CREATE TABLE fdw_type_unsupported (c VARCHAR)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

--- Test setup: DDL of the PostgreSQL
CREATE FOREIGN TABLE fdw_type_unsupported (c circle) SERVER tsurugidb;
--- Test
INSERT INTO fdw_type_unsupported VALUES ('<(3,4),5>'::circle);
ERROR:  tsurugi_fdw : unrecognized type oid: 718
INSERT INTO fdw_type_unsupported VALUES ('<(3,4),5>');
ERROR:  tsurugi_fdw : unrecognized type oid: 718
SELECT * FROM fdw_type_unsupported;
ERROR:  tsurugi_fdw : unrecognized type oid: 718
--- Test teardown: DDL of the PostgreSQL
DROP FOREIGN TABLE fdw_type_unsupported;
--- Test teardown: DDL of the Tsurugi
SELECT tg_execute_ddl('DROP TABLE fdw_type_unsupported', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

-- Unsupported Types - inet
--- Test setup: DDL of the Tsurugi
SELECT tg_execute_ddl('
  CREATE TABLE fdw_type_unsupported (c VARCHAR)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

--- Test setup: DDL of the PostgreSQL
CREATE FOREIGN TABLE fdw_type_unsupported (c inet) SERVER tsurugidb;
--- Test
INSERT INTO fdw_type_unsupported VALUES ('192.168.0.1'::inet);
ERROR:  tsurugi_fdw : unrecognized type oid: 869
INSERT INTO fdw_type_unsupported VALUES ('192.168.0.1');
ERROR:  tsurugi_fdw : unrecognized type oid: 869
SELECT * FROM fdw_type_unsupported;
ERROR:  tsurugi_fdw : unrecognized type oid: 869
--- Test teardown: DDL of the PostgreSQL
DROP FOREIGN TABLE fdw_type_unsupported;
--- Test teardown: DDL of the Tsurugi
SELECT tg_execute_ddl('DROP TABLE fdw_type_unsupported', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

-- Unsupported Types - interval
--- Test setup: DDL of the Tsurugi
SELECT tg_execute_ddl('
  CREATE TABLE fdw_type_unsupported (c VARCHAR)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

--- Test setup: DDL of the PostgreSQL
CREATE FOREIGN TABLE fdw_type_unsupported (c interval) SERVER tsurugidb;
--- Test
INSERT INTO fdw_type_unsupported VALUES ('1 day'::interval);
ERROR:  tsurugi_fdw : unrecognized type oid: 1186
INSERT INTO fdw_type_unsupported VALUES ('1 day');
ERROR:  tsurugi_fdw : unrecognized type oid: 1186
SELECT * FROM fdw_type_unsupported;
ERROR:  tsurugi_fdw : unrecognized type oid: 1186
--- Test teardown: DDL of the PostgreSQL
DROP FOREIGN TABLE fdw_type_unsupported;
--- Test teardown: DDL of the Tsurugi
SELECT tg_execute_ddl('DROP TABLE fdw_type_unsupported', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

-- Unsupported Types - json
--- Test setup: DDL of the Tsurugi
SELECT tg_execute_ddl('
  CREATE TABLE fdw_type_unsupported (c VARCHAR)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

--- Test setup: DDL of the PostgreSQL
CREATE FOREIGN TABLE fdw_type_unsupported (c json) SERVER tsurugidb;
--- Test
INSERT INTO fdw_type_unsupported VALUES ('{"key":"value"}'::json);
ERROR:  tsurugi_fdw : unrecognized type oid: 114
INSERT INTO fdw_type_unsupported VALUES ('{"key":"value"}');
ERROR:  tsurugi_fdw : unrecognized type oid: 114
SELECT * FROM fdw_type_unsupported;
ERROR:  tsurugi_fdw : unrecognized type oid: 114
--- Test teardown: DDL of the PostgreSQL
DROP FOREIGN TABLE fdw_type_unsupported;
--- Test teardown: DDL of the Tsurugi
SELECT tg_execute_ddl('DROP TABLE fdw_type_unsupported', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

-- Unsupported Types - jsonb
--- Test setup: DDL of the Tsurugi
SELECT tg_execute_ddl('
  CREATE TABLE fdw_type_unsupported (c VARCHAR)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

--- Test setup: DDL of the PostgreSQL
CREATE FOREIGN TABLE fdw_type_unsupported (c jsonb) SERVER tsurugidb;
--- Test
INSERT INTO fdw_type_unsupported VALUES ('{"key":"value"}'::jsonb);
ERROR:  tsurugi_fdw : unrecognized type oid: 3802
INSERT INTO fdw_type_unsupported VALUES ('{"key":"value"}');
ERROR:  tsurugi_fdw : unrecognized type oid: 3802
SELECT * FROM fdw_type_unsupported;
ERROR:  tsurugi_fdw : unrecognized type oid: 3802
--- Test teardown: DDL of the PostgreSQL
DROP FOREIGN TABLE fdw_type_unsupported;
--- Test teardown: DDL of the Tsurugi
SELECT tg_execute_ddl('DROP TABLE fdw_type_unsupported', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

-- Unsupported Types - line
--- Test setup: DDL of the Tsurugi
SELECT tg_execute_ddl('
  CREATE TABLE fdw_type_unsupported (c VARCHAR)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

--- Test setup: DDL of the PostgreSQL
CREATE FOREIGN TABLE fdw_type_unsupported (c line) SERVER tsurugidb;
--- Test
INSERT INTO fdw_type_unsupported VALUES ('{1,2,3}'::line);
ERROR:  tsurugi_fdw : unrecognized type oid: 628
INSERT INTO fdw_type_unsupported VALUES ('{1,2,3}');
ERROR:  tsurugi_fdw : unrecognized type oid: 628
SELECT * FROM fdw_type_unsupported;
ERROR:  tsurugi_fdw : unrecognized type oid: 628
--- Test teardown: DDL of the PostgreSQL
DROP FOREIGN TABLE fdw_type_unsupported;
--- Test teardown: DDL of the Tsurugi
SELECT tg_execute_ddl('DROP TABLE fdw_type_unsupported', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

-- Unsupported Types - lseg
--- Test setup: DDL of the Tsurugi
SELECT tg_execute_ddl('
  CREATE TABLE fdw_type_unsupported (c VARCHAR)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

--- Test setup: DDL of the PostgreSQL
CREATE FOREIGN TABLE fdw_type_unsupported (c lseg) SERVER tsurugidb;
--- Test
INSERT INTO fdw_type_unsupported VALUES ('[(1,2),(3,4)]'::lseg);
ERROR:  tsurugi_fdw : unrecognized type oid: 601
INSERT INTO fdw_type_unsupported VALUES ('[(1,2),(3,4)]');
ERROR:  tsurugi_fdw : unrecognized type oid: 601
SELECT * FROM fdw_type_unsupported;
ERROR:  tsurugi_fdw : unrecognized type oid: 601
--- Test teardown: DDL of the PostgreSQL
DROP FOREIGN TABLE fdw_type_unsupported;
--- Test teardown: DDL of the Tsurugi
SELECT tg_execute_ddl('DROP TABLE fdw_type_unsupported', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

-- Unsupported Types - macaddr
--- Test setup: DDL of the Tsurugi
SELECT tg_execute_ddl('
  CREATE TABLE fdw_type_unsupported (c VARCHAR)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

--- Test setup: DDL of the PostgreSQL
CREATE FOREIGN TABLE fdw_type_unsupported (c macaddr) SERVER tsurugidb;
--- Test
INSERT INTO fdw_type_unsupported VALUES ('08:00:2b:01:02:03'::macaddr);
ERROR:  tsurugi_fdw : unrecognized type oid: 829
INSERT INTO fdw_type_unsupported VALUES ('08:00:2b:01:02:03');
ERROR:  tsurugi_fdw : unrecognized type oid: 829
SELECT * FROM fdw_type_unsupported;
ERROR:  tsurugi_fdw : unrecognized type oid: 829
--- Test teardown: DDL of the PostgreSQL
DROP FOREIGN TABLE fdw_type_unsupported;
--- Test teardown: DDL of the Tsurugi
SELECT tg_execute_ddl('DROP TABLE fdw_type_unsupported', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

-- Unsupported Types - macaddr8
--- Test setup: DDL of the Tsurugi
SELECT tg_execute_ddl('
  CREATE TABLE fdw_type_unsupported (c VARCHAR)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

--- Test setup: DDL of the PostgreSQL
CREATE FOREIGN TABLE fdw_type_unsupported (c macaddr8) SERVER tsurugidb;
--- Test
INSERT INTO fdw_type_unsupported VALUES ('08:00:2b:01:02:03:04:05'::macaddr8);
ERROR:  tsurugi_fdw : unrecognized type oid: 774
INSERT INTO fdw_type_unsupported VALUES ('08:00:2b:01:02:03:04:05');
ERROR:  tsurugi_fdw : unrecognized type oid: 774
SELECT * FROM fdw_type_unsupported;
ERROR:  tsurugi_fdw : unrecognized type oid: 774
--- Test teardown: DDL of the PostgreSQL
DROP FOREIGN TABLE fdw_type_unsupported;
--- Test teardown: DDL of the Tsurugi
SELECT tg_execute_ddl('DROP TABLE fdw_type_unsupported', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

-- Unsupported Types - money
--- Test setup: DDL of the Tsurugi
SELECT tg_execute_ddl('
  CREATE TABLE fdw_type_unsupported (c VARCHAR)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

--- Test setup: DDL of the PostgreSQL
CREATE FOREIGN TABLE fdw_type_unsupported (c money) SERVER tsurugidb;
--- Test
INSERT INTO fdw_type_unsupported VALUES ('$123.45'::money);
ERROR:  tsurugi_fdw : unrecognized type oid: 790
INSERT INTO fdw_type_unsupported VALUES ('$123.45');
ERROR:  tsurugi_fdw : unrecognized type oid: 790
SELECT * FROM fdw_type_unsupported;
ERROR:  tsurugi_fdw : unrecognized type oid: 790
--- Test teardown: DDL of the PostgreSQL
DROP FOREIGN TABLE fdw_type_unsupported;
--- Test teardown: DDL of the Tsurugi
SELECT tg_execute_ddl('DROP TABLE fdw_type_unsupported', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

-- Unsupported Types - path
--- Test setup: DDL of the Tsurugi
SELECT tg_execute_ddl('
  CREATE TABLE fdw_type_unsupported (c VARCHAR)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

--- Test setup: DDL of the PostgreSQL
CREATE FOREIGN TABLE fdw_type_unsupported (c path) SERVER tsurugidb;
--- Test
INSERT INTO fdw_type_unsupported VALUES ('[(1,2),(3,4)]'::path);
ERROR:  tsurugi_fdw : unrecognized type oid: 602
INSERT INTO fdw_type_unsupported VALUES ('[(1,2),(3,4)]');
ERROR:  tsurugi_fdw : unrecognized type oid: 602
SELECT * FROM fdw_type_unsupported;
ERROR:  tsurugi_fdw : unrecognized type oid: 602
--- Test teardown: DDL of the PostgreSQL
DROP FOREIGN TABLE fdw_type_unsupported;
--- Test teardown: DDL of the Tsurugi
SELECT tg_execute_ddl('DROP TABLE fdw_type_unsupported', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

-- Unsupported Types - pg_lsn
--- Test setup: DDL of the Tsurugi
SELECT tg_execute_ddl('
  CREATE TABLE fdw_type_unsupported (c VARCHAR)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

--- Test setup: DDL of the PostgreSQL
CREATE FOREIGN TABLE fdw_type_unsupported (c pg_lsn) SERVER tsurugidb;
--- Test
INSERT INTO fdw_type_unsupported VALUES ('16/B374D848'::pg_lsn);
ERROR:  tsurugi_fdw : unrecognized type oid: 3220
INSERT INTO fdw_type_unsupported VALUES ('16/B374D848');
ERROR:  tsurugi_fdw : unrecognized type oid: 3220
SELECT * FROM fdw_type_unsupported;
ERROR:  tsurugi_fdw : unrecognized type oid: 3220
--- Test teardown: DDL of the PostgreSQL
DROP FOREIGN TABLE fdw_type_unsupported;
--- Test teardown: DDL of the Tsurugi
SELECT tg_execute_ddl('DROP TABLE fdw_type_unsupported', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

-- Unsupported Types - point
--- Test setup: DDL of the Tsurugi
SELECT tg_execute_ddl('
  CREATE TABLE fdw_type_unsupported (c VARCHAR)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

--- Test setup: DDL of the PostgreSQL
CREATE FOREIGN TABLE fdw_type_unsupported (c point) SERVER tsurugidb;
--- Test
INSERT INTO fdw_type_unsupported VALUES ('(1,2)'::point);
ERROR:  tsurugi_fdw : unrecognized type oid: 600
INSERT INTO fdw_type_unsupported VALUES ('(1,2)');
ERROR:  tsurugi_fdw : unrecognized type oid: 600
SELECT * FROM fdw_type_unsupported;
ERROR:  tsurugi_fdw : unrecognized type oid: 600
--- Test teardown: DDL of the PostgreSQL
DROP FOREIGN TABLE fdw_type_unsupported;
--- Test teardown: DDL of the Tsurugi
SELECT tg_execute_ddl('DROP TABLE fdw_type_unsupported', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

-- Unsupported Types - polygon
--- Test setup: DDL of the Tsurugi
SELECT tg_execute_ddl('
  CREATE TABLE fdw_type_unsupported (c VARCHAR)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

--- Test setup: DDL of the PostgreSQL
CREATE FOREIGN TABLE fdw_type_unsupported (c polygon) SERVER tsurugidb;
--- Test
INSERT INTO fdw_type_unsupported VALUES ('((1,2),(3,4),(5,6))'::polygon);
ERROR:  tsurugi_fdw : unrecognized type oid: 604
INSERT INTO fdw_type_unsupported VALUES ('((1,2),(3,4),(5,6))');
ERROR:  tsurugi_fdw : unrecognized type oid: 604
SELECT * FROM fdw_type_unsupported;
ERROR:  tsurugi_fdw : unrecognized type oid: 604
--- Test teardown: DDL of the PostgreSQL
DROP FOREIGN TABLE fdw_type_unsupported;
--- Test teardown: DDL of the Tsurugi
SELECT tg_execute_ddl('DROP TABLE fdw_type_unsupported', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

-- Unsupported Types - smallint
--- Test setup: DDL of the Tsurugi
SELECT tg_execute_ddl('
  CREATE TABLE fdw_type_unsupported (c DECIMAL(5))
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

--- Test setup: DDL of the PostgreSQL
CREATE FOREIGN TABLE fdw_type_unsupported (c smallint) SERVER tsurugidb;
--- Test
INSERT INTO fdw_type_unsupported VALUES (1::smallint);
ERROR:  Failed to execute remote SQL.
HINT:  Failed to execute the statement on Tsurugi. error: SERVER_ERROR(13)
Tsurugi Error: UNSUPPORTED_RUNTIME_FEATURE_EXCEPTION (SQL-02050: unsupported expression)
CONTEXT:  SQL query: INSERT INTO fdw_type_unsupported VALUES (1::smallint)
INSERT INTO fdw_type_unsupported VALUES (1);
SELECT * FROM fdw_type_unsupported;
 c 
---
 1
(1 row)

--- Test teardown: DDL of the PostgreSQL
DROP FOREIGN TABLE fdw_type_unsupported;
--- Test teardown: DDL of the Tsurugi
SELECT tg_execute_ddl('DROP TABLE fdw_type_unsupported', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

-- Unsupported Types - tsquery
--- Test setup: DDL of the Tsurugi
SELECT tg_execute_ddl('
  CREATE TABLE fdw_type_unsupported (c VARCHAR)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

--- Test setup: DDL of the PostgreSQL
CREATE FOREIGN TABLE fdw_type_unsupported (c tsquery) SERVER tsurugidb;
--- Test
INSERT INTO fdw_type_unsupported VALUES ('value'::tsquery);
ERROR:  tsurugi_fdw : unrecognized type oid: 3615
INSERT INTO fdw_type_unsupported VALUES ('value');
ERROR:  tsurugi_fdw : unrecognized type oid: 3615
SELECT * FROM fdw_type_unsupported;
ERROR:  tsurugi_fdw : unrecognized type oid: 3615
--- Test teardown: DDL of the PostgreSQL
DROP FOREIGN TABLE fdw_type_unsupported;
--- Test teardown: DDL of the Tsurugi
SELECT tg_execute_ddl('DROP TABLE fdw_type_unsupported', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

-- Unsupported Types - tsvector
--- Test setup: DDL of the Tsurugi
SELECT tg_execute_ddl('
  CREATE TABLE fdw_type_unsupported (c VARCHAR)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

--- Test setup: DDL of the PostgreSQL
CREATE FOREIGN TABLE fdw_type_unsupported (c tsvector) SERVER tsurugidb;
--- Test
INSERT INTO fdw_type_unsupported VALUES ('value:1'::tsvector);
ERROR:  tsurugi_fdw : unrecognized type oid: 3614
INSERT INTO fdw_type_unsupported VALUES ('value:1');
ERROR:  tsurugi_fdw : unrecognized type oid: 3614
SELECT * FROM fdw_type_unsupported;
ERROR:  tsurugi_fdw : unrecognized type oid: 3614
--- Test teardown: DDL of the PostgreSQL
DROP FOREIGN TABLE fdw_type_unsupported;
--- Test teardown: DDL of the Tsurugi
SELECT tg_execute_ddl('DROP TABLE fdw_type_unsupported', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

-- Unsupported Types - txid_snapshot
--- Test setup: DDL of the Tsurugi
SELECT tg_execute_ddl('
  CREATE TABLE fdw_type_unsupported (c VARCHAR)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

--- Test setup: DDL of the PostgreSQL
CREATE FOREIGN TABLE fdw_type_unsupported (c txid_snapshot) SERVER tsurugidb;
--- Test
INSERT INTO fdw_type_unsupported VALUES ('10:20:10,14,15'::txid_snapshot);
ERROR:  tsurugi_fdw : unrecognized type oid: 2970
INSERT INTO fdw_type_unsupported VALUES ('10:20:10,14,15');
ERROR:  tsurugi_fdw : unrecognized type oid: 2970
SELECT * FROM fdw_type_unsupported;
ERROR:  tsurugi_fdw : unrecognized type oid: 2970
--- Test teardown: DDL of the PostgreSQL
DROP FOREIGN TABLE fdw_type_unsupported;
--- Test teardown: DDL of the Tsurugi
SELECT tg_execute_ddl('DROP TABLE fdw_type_unsupported', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

-- Unsupported Types - uuid
--- Test setup: DDL of the Tsurugi
SELECT tg_execute_ddl('
  CREATE TABLE fdw_type_unsupported (c VARCHAR)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

--- Test setup: DDL of the PostgreSQL
CREATE FOREIGN TABLE fdw_type_unsupported (c uuid) SERVER tsurugidb;
--- Test
INSERT INTO fdw_type_unsupported VALUES ('f3d4b1ce-f2e0-49ce-8cd4-da5c8f29bff2'::uuid);
ERROR:  tsurugi_fdw : unrecognized type oid: 2950
INSERT INTO fdw_type_unsupported VALUES ('f3d4b1ce-f2e0-49ce-8cd4-da5c8f29bff2');
ERROR:  tsurugi_fdw : unrecognized type oid: 2950
SELECT * FROM fdw_type_unsupported;
ERROR:  tsurugi_fdw : unrecognized type oid: 2950
--- Test teardown: DDL of the PostgreSQL
DROP FOREIGN TABLE fdw_type_unsupported;
--- Test teardown: DDL of the Tsurugi
SELECT tg_execute_ddl('DROP TABLE fdw_type_unsupported', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

-- Unsupported Types - Table Joins
--- Test setup: DDL of the Tsurugi
SELECT tg_execute_ddl('
  CREATE TABLE fdw_type_unsupported_1 (c1 INT, c2 VARCHAR)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE fdw_type_unsupported_2 (c1 INT, c2 VARCHAR)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

--- Test setup: DDL of the PostgreSQL
CREATE FOREIGN TABLE fdw_type_unsupported_1 (c1 integer, c2 text) SERVER tsurugidb;
CREATE FOREIGN TABLE fdw_type_unsupported_2 (c1 integer, c2 json) SERVER tsurugidb;
--- Test
INSERT INTO fdw_type_unsupported_1 VALUES (1, 'col');
SELECT * FROM fdw_type_unsupported_1;
 c1 | c2  
----+-----
  1 | col
(1 row)

SELECT * FROM fdw_type_unsupported_2;
ERROR:  tsurugi_fdw : unrecognized type oid: 114
SELECT * FROM fdw_type_unsupported_1 u1
  LEFT OUTER JOIN fdw_type_unsupported_2 u2 ON u1.c1 = u2.c1;
ERROR:  tsurugi_fdw : unrecognized type oid: 114
--- Test teardown: DDL of the PostgreSQL
DROP FOREIGN TABLE fdw_type_unsupported_1;
DROP FOREIGN TABLE fdw_type_unsupported_2;
--- Test teardown: DDL of the Tsurugi
SELECT tg_execute_ddl('DROP TABLE fdw_type_unsupported_1', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE fdw_type_unsupported_2', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

