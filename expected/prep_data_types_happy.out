/* Test case: happy path - Supported data types (preparation) */
-- Test setup: PostgreSQL environment
SET timezone TO 'UTC';
-- Test setup: DDL of the Tsurugi
SELECT tg_execute_ddl('
  CREATE TABLE fdw_type_int (c INT)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE fdw_type_bigint (c BIGINT)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE fdw_type_decimal (c DECIMAL)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE fdw_type_decimal_p (c DECIMAL(5))
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE fdw_type_decimal_ps (c DECIMAL(5, 2))
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE fdw_type_decimal_ps0 (c DECIMAL(38, 0))
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE fdw_type_decimal_ps38 (c DECIMAL(38, 38))
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE fdw_type_numeric (c NUMERIC)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE fdw_type_numeric_p (c NUMERIC(5))
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE fdw_type_numeric_ps (c NUMERIC(5, 2))
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE fdw_type_numeric_ps0 (c NUMERIC(38, 0))
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE fdw_type_numeric_ps38 (c NUMERIC(38, 38))
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE fdw_type_real (c REAL)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE fdw_type_double (c DOUBLE)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE fdw_type_char (c CHAR)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE fdw_type_char_l (c CHAR(10))
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE fdw_type_varchar (c VARCHAR)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE fdw_type_varchar_l (c VARCHAR(10))
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE fdw_type_text (c VARCHAR)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE fdw_type_date (c DATE)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE fdw_type_time (c TIME)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE fdw_type_time_tz (c TIME WITH TIME ZONE)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE fdw_type_timestamp (c TIMESTAMP)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE fdw_type_timestamp_wo_tz (c TIMESTAMP WITHOUT TIME ZONE)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

SELECT tg_execute_ddl('
  CREATE TABLE fdw_type_timestamp_tz (c TIMESTAMP WITH TIME ZONE)
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

-- Test setup: DDL of the PostgreSQL
CREATE FOREIGN TABLE fdw_type_int (
  c integer
) SERVER tsurugidb;
CREATE FOREIGN TABLE fdw_type_bigint (
  c bigint
) SERVER tsurugidb;
CREATE FOREIGN TABLE fdw_type_decimal (
  c decimal
) SERVER tsurugidb;
CREATE FOREIGN TABLE fdw_type_decimal_p (
  c decimal(5)
) SERVER tsurugidb;
CREATE FOREIGN TABLE fdw_type_decimal_ps (
  c decimal(5, 2)
) SERVER tsurugidb;
CREATE FOREIGN TABLE fdw_type_decimal_ps0 (
  c decimal(38, 0)
) SERVER tsurugidb;
CREATE FOREIGN TABLE fdw_type_decimal_ps38 (
  c decimal(38, 38)
) SERVER tsurugidb;
CREATE FOREIGN TABLE fdw_type_numeric (
  c numeric
) SERVER tsurugidb;
CREATE FOREIGN TABLE fdw_type_numeric_p (
  c numeric(5)
) SERVER tsurugidb;
CREATE FOREIGN TABLE fdw_type_numeric_ps (
  c numeric(5, 2)
) SERVER tsurugidb;
CREATE FOREIGN TABLE fdw_type_numeric_ps0 (
  c numeric(38, 0)
) SERVER tsurugidb;
CREATE FOREIGN TABLE fdw_type_numeric_ps38 (
  c numeric(38, 38)
) SERVER tsurugidb;
CREATE FOREIGN TABLE fdw_type_real (
  c real
) SERVER tsurugidb;
CREATE FOREIGN TABLE fdw_type_double (
  c double precision
) SERVER tsurugidb;
CREATE FOREIGN TABLE fdw_type_char (
  c char
) SERVER tsurugidb;
CREATE FOREIGN TABLE fdw_type_char_l (
  c char(10)
) SERVER tsurugidb;
CREATE FOREIGN TABLE fdw_type_varchar (
  c varchar
) SERVER tsurugidb;
CREATE FOREIGN TABLE fdw_type_varchar_l (
  c varchar(10)
) SERVER tsurugidb;
CREATE FOREIGN TABLE fdw_type_text (
  c text
) SERVER tsurugidb;
CREATE FOREIGN TABLE fdw_type_date (
  c date
) SERVER tsurugidb;
CREATE FOREIGN TABLE fdw_type_time (
  c time
) SERVER tsurugidb;
CREATE FOREIGN TABLE fdw_type_time_tz (
  c time with time zone
) SERVER tsurugidb;
CREATE FOREIGN TABLE fdw_type_timestamp (
  c timestamp
) SERVER tsurugidb;
CREATE FOREIGN TABLE fdw_type_timestamp_wo_tz (
  c timestamp without time zone
) SERVER tsurugidb;
CREATE FOREIGN TABLE fdw_type_timestamp_tz (
  c timestamp with time zone
) SERVER tsurugidb;
-- Numeric Types
--- integer
PREPARE fdw_prepare_ins (integer) AS
  INSERT INTO fdw_type_int VALUES ($1);
PREPARE fdw_prepare_upd (integer, integer) AS
  UPDATE fdw_type_int SET c = $1 WHERE c = $2;
PREPARE fdw_prepare_upd_nul (integer) AS
  UPDATE fdw_type_int SET c = $1 WHERE c IS NULL;
PREPARE fdw_prepare_del (integer) AS
  DELETE FROM fdw_type_int WHERE c = $1;
PREPARE fdw_prepare_sel (integer) AS
  SELECT * FROM fdw_type_int WHERE c = $1 ORDER BY c;
PREPARE fdw_prepare_sel_all AS
  SELECT * FROM fdw_type_int ORDER BY c;
EXECUTE fdw_prepare_ins (12345);
EXECUTE fdw_prepare_ins (-12345);
EXECUTE fdw_prepare_ins (NULL);
EXECUTE fdw_prepare_ins (2147483644); --max-3
EXECUTE fdw_prepare_ins (2147483645); --max-2
EXECUTE fdw_prepare_ins (2147483646); --max-1
EXECUTE fdw_prepare_ins (2147483647); --max
EXECUTE fdw_prepare_ins (-2147483645); --min+3
EXECUTE fdw_prepare_ins (-2147483646); --min+2
EXECUTE fdw_prepare_ins (-2147483647); --min+1
EXECUTE fdw_prepare_ins (-2147483648); --min
EXECUTE fdw_prepare_ins (1.1);  -- auto-cast
EXECUTE fdw_prepare_sel_all;
      c      
-------------
            
 -2147483648
 -2147483647
 -2147483646
 -2147483645
      -12345
           1
       12345
  2147483644
  2147483645
  2147483646
  2147483647
(12 rows)

EXECUTE fdw_prepare_sel (2147483647);
     c      
------------
 2147483647
(1 row)

EXECUTE fdw_prepare_sel (-2147483648);
      c      
-------------
 -2147483648
(1 row)

EXECUTE fdw_prepare_upd (2147483647, -2147483648);
EXECUTE fdw_prepare_sel (2147483647);
     c      
------------
 2147483647
 2147483647
(2 rows)

EXECUTE fdw_prepare_upd (-2147483648, 2147483647);
EXECUTE fdw_prepare_sel (-2147483648);
      c      
-------------
 -2147483648
 -2147483648
(2 rows)

EXECUTE fdw_prepare_del (-2147483648);
EXECUTE fdw_prepare_sel_all;
      c      
-------------
            
 -2147483647
 -2147483646
 -2147483645
      -12345
           1
       12345
  2147483644
  2147483645
  2147483646
(10 rows)

EXECUTE fdw_prepare_upd_nul (2147483647);
EXECUTE fdw_prepare_del (2147483647);
EXECUTE fdw_prepare_sel_all;
      c      
-------------
 -2147483647
 -2147483646
 -2147483645
      -12345
           1
       12345
  2147483644
  2147483645
  2147483646
(9 rows)

DEALLOCATE fdw_prepare_ins;
DEALLOCATE fdw_prepare_upd;
DEALLOCATE fdw_prepare_upd_nul;
DEALLOCATE fdw_prepare_del;
DEALLOCATE fdw_prepare_sel;
DEALLOCATE fdw_prepare_sel_all;
--- bigint
PREPARE fdw_prepare_ins (bigint) AS
  INSERT INTO fdw_type_bigint VALUES ($1);
PREPARE fdw_prepare_upd (bigint, bigint) AS
  UPDATE fdw_type_bigint SET c = $1 WHERE c = $2;
PREPARE fdw_prepare_upd_nul (bigint) AS
  UPDATE fdw_type_bigint SET c = $1 WHERE c IS NULL;
PREPARE fdw_prepare_del (bigint) AS
  DELETE FROM fdw_type_bigint WHERE c = $1;
PREPARE fdw_prepare_sel (bigint) AS
  SELECT * FROM fdw_type_bigint WHERE c = $1 ORDER BY c;
PREPARE fdw_prepare_sel_all AS
  SELECT * FROM fdw_type_bigint ORDER BY c;
EXECUTE fdw_prepare_ins (12345);
EXECUTE fdw_prepare_ins (-12345);
EXECUTE fdw_prepare_ins (NULL);
EXECUTE fdw_prepare_ins (9223372036854775804);  --max-3
EXECUTE fdw_prepare_ins (9223372036854775805);  --max-2
EXECUTE fdw_prepare_ins (9223372036854775806);  --max-1
EXECUTE fdw_prepare_ins (9223372036854775807);  --max
EXECUTE fdw_prepare_ins (-9223372036854775805);  --min+3
EXECUTE fdw_prepare_ins (-9223372036854775806);  --min+2
EXECUTE fdw_prepare_ins (-9223372036854775807);  --min+1
EXECUTE fdw_prepare_ins (-9223372036854775808); --min
EXECUTE fdw_prepare_ins (1.1);  -- auto-cast
EXECUTE fdw_prepare_sel_all;
          c           
----------------------
                     
 -9223372036854775808
 -9223372036854775807
 -9223372036854775806
 -9223372036854775805
               -12345
                    1
                12345
  9223372036854775804
  9223372036854775805
  9223372036854775806
  9223372036854775807
(12 rows)

EXECUTE fdw_prepare_sel (9223372036854775807);
          c          
---------------------
 9223372036854775807
(1 row)

EXECUTE fdw_prepare_sel (-9223372036854775808);
          c           
----------------------
 -9223372036854775808
(1 row)

EXECUTE fdw_prepare_upd (9223372036854775807, -9223372036854775808);
EXECUTE fdw_prepare_sel (9223372036854775807);
          c          
---------------------
 9223372036854775807
 9223372036854775807
(2 rows)

EXECUTE fdw_prepare_upd (-9223372036854775808, 9223372036854775807);
EXECUTE fdw_prepare_del (-9223372036854775808);
EXECUTE fdw_prepare_sel_all;
          c           
----------------------
                     
 -9223372036854775807
 -9223372036854775806
 -9223372036854775805
               -12345
                    1
                12345
  9223372036854775804
  9223372036854775805
  9223372036854775806
(10 rows)

EXECUTE fdw_prepare_upd_nul (9223372036854775807);
EXECUTE fdw_prepare_del (9223372036854775807);
EXECUTE fdw_prepare_sel_all;
          c           
----------------------
 -9223372036854775807
 -9223372036854775806
 -9223372036854775805
               -12345
                    1
                12345
  9223372036854775804
  9223372036854775805
  9223372036854775806
(9 rows)

DEALLOCATE fdw_prepare_ins;
DEALLOCATE fdw_prepare_upd;
DEALLOCATE fdw_prepare_upd_nul;
DEALLOCATE fdw_prepare_del;
DEALLOCATE fdw_prepare_sel;
DEALLOCATE fdw_prepare_sel_all;
--- decimal
PREPARE fdw_prepare_ins (decimal) AS
  INSERT INTO fdw_type_decimal VALUES ($1);
PREPARE fdw_prepare_upd (decimal) AS
  UPDATE fdw_type_decimal SET c = c * -1 WHERE c = $1;
PREPARE fdw_prepare_upd_nul (decimal) AS
  UPDATE fdw_type_decimal SET c = $1 WHERE c IS NULL;
PREPARE fdw_prepare_del (decimal) AS
  DELETE FROM fdw_type_decimal WHERE c = $1;
PREPARE fdw_prepare_sel_all AS
  SELECT * FROM fdw_type_decimal ORDER BY c;
PREPARE fdw_prepare_sel_all_d AS
  SELECT * FROM fdw_type_decimal ORDER BY c DESC;
EXECUTE fdw_prepare_ins (12345);
EXECUTE fdw_prepare_ins (-12345);
EXECUTE fdw_prepare_ins (NULL);
EXECUTE fdw_prepare_sel_all;
   c    
--------
       
 -12345
  12345
(3 rows)

EXECUTE fdw_prepare_upd_nul (987654);
EXECUTE fdw_prepare_sel_all;
   c    
--------
 -12345
  12345
 987654
(3 rows)

EXECUTE fdw_prepare_upd (987654);
EXECUTE fdw_prepare_sel_all_d;
    c    
---------
   12345
  -12345
 -987654
(3 rows)

EXECUTE fdw_prepare_del (-987654);
EXECUTE fdw_prepare_sel_all;
   c    
--------
 -12345
  12345
(2 rows)

DEALLOCATE fdw_prepare_ins;
DEALLOCATE fdw_prepare_upd;
DEALLOCATE fdw_prepare_upd_nul;
DEALLOCATE fdw_prepare_del;
DEALLOCATE fdw_prepare_sel_all;
DEALLOCATE fdw_prepare_sel_all_d;
--- decimal(5)
PREPARE fdw_prepare_ins (decimal(5)) AS
  INSERT INTO fdw_type_decimal_p VALUES ($1);
PREPARE fdw_prepare_upd (decimal(5)) AS
  UPDATE fdw_type_decimal_p SET c = c * -1 WHERE c = $1;
PREPARE fdw_prepare_upd_nul (decimal(5)) AS
  UPDATE fdw_type_decimal_p SET c = $1 WHERE c IS NULL;
PREPARE fdw_prepare_del (decimal(5)) AS
  DELETE FROM fdw_type_decimal_p WHERE c = $1;
PREPARE fdw_prepare_sel_all AS
  SELECT * FROM fdw_type_decimal_p ORDER BY c;
PREPARE fdw_prepare_sel_all_d AS
  SELECT * FROM fdw_type_decimal_p ORDER BY c DESC;
EXECUTE fdw_prepare_ins (12345);
EXECUTE fdw_prepare_ins (-12345);
EXECUTE fdw_prepare_ins (NULL);
EXECUTE fdw_prepare_sel_all;
   c    
--------
       
 -12345
  12345
(3 rows)

EXECUTE fdw_prepare_upd_nul (98765);
EXECUTE fdw_prepare_sel_all;
   c    
--------
 -12345
  12345
  98765
(3 rows)

EXECUTE fdw_prepare_upd (98765);
EXECUTE fdw_prepare_sel_all_d;
   c    
--------
  12345
 -12345
 -98765
(3 rows)

EXECUTE fdw_prepare_del (-98765);
EXECUTE fdw_prepare_sel_all;
   c    
--------
 -12345
  12345
(2 rows)

DEALLOCATE fdw_prepare_ins;
DEALLOCATE fdw_prepare_upd;
DEALLOCATE fdw_prepare_upd_nul;
DEALLOCATE fdw_prepare_del;
DEALLOCATE fdw_prepare_sel_all;
DEALLOCATE fdw_prepare_sel_all_d;
--- decimal(5, 2)
PREPARE fdw_prepare_ins (decimal(5, 2)) AS
  INSERT INTO fdw_type_decimal_ps VALUES ($1);
PREPARE fdw_prepare_upd (decimal(5, 2)) AS
  UPDATE fdw_type_decimal_ps SET c = c * -1 WHERE c = $1;
PREPARE fdw_prepare_upd_nul (decimal(5, 2)) AS
  UPDATE fdw_type_decimal_ps SET c = $1 WHERE c IS NULL;
PREPARE fdw_prepare_del (decimal(5, 2)) AS
  DELETE FROM fdw_type_decimal_ps WHERE c = $1;
PREPARE fdw_prepare_sel_all AS
  SELECT * FROM fdw_type_decimal_ps ORDER BY c;
PREPARE fdw_prepare_sel_all_d AS
  SELECT * FROM fdw_type_decimal_ps ORDER BY c DESC;
EXECUTE fdw_prepare_ins (123.45);
EXECUTE fdw_prepare_ins (-123.45);
EXECUTE fdw_prepare_ins (NULL);
EXECUTE fdw_prepare_sel_all;
    c    
---------
        
 -123.45
  123.45
(3 rows)

EXECUTE fdw_prepare_upd_nul (987.65);
EXECUTE fdw_prepare_sel_all;
    c    
---------
 -123.45
  123.45
  987.65
(3 rows)

EXECUTE fdw_prepare_upd (987.65);
EXECUTE fdw_prepare_sel_all_d;
    c    
---------
  123.45
 -123.45
 -987.65
(3 rows)

EXECUTE fdw_prepare_del (-987.65);
EXECUTE fdw_prepare_sel_all;
    c    
---------
 -123.45
  123.45
(2 rows)

EXECUTE fdw_prepare_ins (abs(-17.4));
EXECUTE fdw_prepare_ins (ceil(-42.8));
EXECUTE fdw_prepare_ins (floor(-42.8));
EXECUTE fdw_prepare_ins (mod(9, 4));
EXECUTE fdw_prepare_ins (round(42.4));
EXECUTE fdw_prepare_ins (round(42.4382, 2));
EXECUTE fdw_prepare_sel_all;
    c    
---------
 -123.45
  -43.00
  -42.00
    1.00
   17.40
   42.00
   42.44
  123.45
(8 rows)

DEALLOCATE fdw_prepare_ins;
DEALLOCATE fdw_prepare_upd;
DEALLOCATE fdw_prepare_upd_nul;
DEALLOCATE fdw_prepare_del;
DEALLOCATE fdw_prepare_sel_all;
DEALLOCATE fdw_prepare_sel_all_d;
--- decimal(38, 0)
PREPARE fdw_prepare_ins (numeric(38, 0)) AS
  INSERT INTO fdw_type_decimal_ps0 VALUES ($1);
PREPARE fdw_prepare_sel_all AS
  SELECT * FROM fdw_type_decimal_ps0 ORDER BY c;
EXECUTE fdw_prepare_ins (0);
EXECUTE fdw_prepare_ins (1);
EXECUTE fdw_prepare_ins (18446744073709551615);
EXECUTE fdw_prepare_ins (18446744073709551616);
EXECUTE fdw_prepare_ins (99999999999999999999999999999999999999);
EXECUTE fdw_prepare_ins (-1);
EXECUTE fdw_prepare_ins (-18446744073709551615);
EXECUTE fdw_prepare_ins (-18446744073709551616);
EXECUTE fdw_prepare_ins (-99999999999999999999999999999999999999);
EXECUTE fdw_prepare_sel_all;
                    c                    
-----------------------------------------
 -99999999999999999999999999999999999999
                   -18446744073709551616
                   -18446744073709551615
                                      -1
                                       0
                                       1
                    18446744073709551615
                    18446744073709551616
  99999999999999999999999999999999999999
(9 rows)

DEALLOCATE fdw_prepare_ins;
DEALLOCATE fdw_prepare_sel_all;
--- decimal(38, 38)
PREPARE fdw_prepare_ins (numeric(38, 38)) AS
  INSERT INTO fdw_type_decimal_ps38 VALUES ($1);
PREPARE fdw_prepare_sel_all AS
  SELECT * FROM fdw_type_decimal_ps38 ORDER BY c;
EXECUTE fdw_prepare_ins (0);
EXECUTE fdw_prepare_ins (0.00000000000000000000000000000000000001);
EXECUTE fdw_prepare_ins (0.00000000000000000018446744073709551615);
EXECUTE fdw_prepare_ins (0.00000000000000000018446744073709551616);
EXECUTE fdw_prepare_ins (0.99999999999999999999999999999999999999);
EXECUTE fdw_prepare_ins (-0.00000000000000000000000000000000000001);
EXECUTE fdw_prepare_ins (-0.00000000000000000018446744073709551615);
EXECUTE fdw_prepare_ins (-0.00000000000000000018446744073709551616);
EXECUTE fdw_prepare_ins (-0.99999999999999999999999999999999999999);
EXECUTE fdw_prepare_sel_all;
                     c                     
-------------------------------------------
 -0.99999999999999999999999999999999999999
 -0.00000000000000000018446744073709551616
 -0.00000000000000000018446744073709551615
 -0.00000000000000000000000000000000000001
  0.00000000000000000000000000000000000000
  0.00000000000000000000000000000000000001
  0.00000000000000000018446744073709551615
  0.00000000000000000018446744073709551616
  0.99999999999999999999999999999999999999
(9 rows)

DEALLOCATE fdw_prepare_ins;
DEALLOCATE fdw_prepare_sel_all;
--- numeric
PREPARE fdw_prepare_ins (numeric) AS
  INSERT INTO fdw_type_numeric VALUES ($1);
PREPARE fdw_prepare_upd (numeric) AS
  UPDATE fdw_type_numeric SET c = c * -1 WHERE c = $1;
PREPARE fdw_prepare_upd_nul (numeric) AS
  UPDATE fdw_type_numeric SET c = $1 WHERE c IS NULL;
PREPARE fdw_prepare_del (numeric) AS
  DELETE FROM fdw_type_numeric WHERE c = $1;
PREPARE fdw_prepare_sel_all AS
  SELECT * FROM fdw_type_numeric ORDER BY c;
PREPARE fdw_prepare_sel_all_d AS
  SELECT * FROM fdw_type_numeric ORDER BY c DESC;
EXECUTE fdw_prepare_ins (12345);
EXECUTE fdw_prepare_ins (-12345);
EXECUTE fdw_prepare_ins (NULL);
EXECUTE fdw_prepare_sel_all;
   c    
--------
       
 -12345
  12345
(3 rows)

EXECUTE fdw_prepare_upd_nul (987654);
EXECUTE fdw_prepare_sel_all;
   c    
--------
 -12345
  12345
 987654
(3 rows)

EXECUTE fdw_prepare_upd (987654);
EXECUTE fdw_prepare_sel_all_d;
    c    
---------
   12345
  -12345
 -987654
(3 rows)

EXECUTE fdw_prepare_del (-987654);
EXECUTE fdw_prepare_sel_all;
   c    
--------
 -12345
  12345
(2 rows)

DEALLOCATE fdw_prepare_ins;
DEALLOCATE fdw_prepare_upd;
DEALLOCATE fdw_prepare_upd_nul;
DEALLOCATE fdw_prepare_del;
DEALLOCATE fdw_prepare_sel_all;
DEALLOCATE fdw_prepare_sel_all_d;
--- numeric(5)
PREPARE fdw_prepare_ins (numeric(5)) AS
  INSERT INTO fdw_type_numeric_p VALUES ($1);
PREPARE fdw_prepare_upd (numeric(5)) AS
  UPDATE fdw_type_numeric_p SET c = c * -1 WHERE c = $1;
PREPARE fdw_prepare_upd_nul (numeric(5)) AS
  UPDATE fdw_type_numeric_p SET c = $1 WHERE c IS NULL;
PREPARE fdw_prepare_del (numeric(5)) AS
  DELETE FROM fdw_type_numeric_p WHERE c = $1;
PREPARE fdw_prepare_sel_all AS
  SELECT * FROM fdw_type_numeric_p ORDER BY c;
PREPARE fdw_prepare_sel_all_d AS
  SELECT * FROM fdw_type_numeric_p ORDER BY c DESC;
EXECUTE fdw_prepare_ins (12345);
EXECUTE fdw_prepare_ins (-12345);
EXECUTE fdw_prepare_ins (NULL);
EXECUTE fdw_prepare_sel_all;
   c    
--------
       
 -12345
  12345
(3 rows)

EXECUTE fdw_prepare_upd_nul (98765);
EXECUTE fdw_prepare_sel_all;
   c    
--------
 -12345
  12345
  98765
(3 rows)

EXECUTE fdw_prepare_upd (98765);
EXECUTE fdw_prepare_sel_all_d;
   c    
--------
  12345
 -12345
 -98765
(3 rows)

EXECUTE fdw_prepare_del (-98765);
EXECUTE fdw_prepare_sel_all;
   c    
--------
 -12345
  12345
(2 rows)

DEALLOCATE fdw_prepare_ins;
DEALLOCATE fdw_prepare_upd;
DEALLOCATE fdw_prepare_upd_nul;
DEALLOCATE fdw_prepare_del;
DEALLOCATE fdw_prepare_sel_all;
DEALLOCATE fdw_prepare_sel_all_d;
--- numeric(5, 2)
PREPARE fdw_prepare_ins (numeric(5, 2)) AS
  INSERT INTO fdw_type_numeric_ps VALUES ($1);
PREPARE fdw_prepare_upd (numeric(5, 2)) AS
  UPDATE fdw_type_numeric_ps SET c = c * -1 WHERE c = $1;
PREPARE fdw_prepare_upd_nul (numeric(5, 2)) AS
  UPDATE fdw_type_numeric_ps SET c = $1 WHERE c IS NULL;
PREPARE fdw_prepare_del (numeric(5, 2)) AS
  DELETE FROM fdw_type_numeric_ps WHERE c = $1;
PREPARE fdw_prepare_sel_all AS
  SELECT * FROM fdw_type_numeric_ps ORDER BY c;
PREPARE fdw_prepare_sel_all_d AS
  SELECT * FROM fdw_type_numeric_ps ORDER BY c DESC;
EXECUTE fdw_prepare_ins (123.45);
EXECUTE fdw_prepare_ins (-123.45);
EXECUTE fdw_prepare_ins (NULL);
EXECUTE fdw_prepare_sel_all;
    c    
---------
        
 -123.45
  123.45
(3 rows)

EXECUTE fdw_prepare_upd_nul (987.65);
EXECUTE fdw_prepare_sel_all;
    c    
---------
 -123.45
  123.45
  987.65
(3 rows)

EXECUTE fdw_prepare_upd (987.65);
EXECUTE fdw_prepare_sel_all_d;
    c    
---------
  123.45
 -123.45
 -987.65
(3 rows)

EXECUTE fdw_prepare_del (-987.65);
EXECUTE fdw_prepare_sel_all;
    c    
---------
 -123.45
  123.45
(2 rows)

EXECUTE fdw_prepare_ins (abs(-17.4));
EXECUTE fdw_prepare_ins (ceil(-42.8));
EXECUTE fdw_prepare_ins (floor(-42.8));
EXECUTE fdw_prepare_ins (mod(9, 4));
EXECUTE fdw_prepare_ins (round(42.4));
EXECUTE fdw_prepare_ins (round(42.4382, 2));
EXECUTE fdw_prepare_sel_all;
    c    
---------
 -123.45
  -43.00
  -42.00
    1.00
   17.40
   42.00
   42.44
  123.45
(8 rows)

DEALLOCATE fdw_prepare_ins;
DEALLOCATE fdw_prepare_upd;
DEALLOCATE fdw_prepare_upd_nul;
DEALLOCATE fdw_prepare_del;
DEALLOCATE fdw_prepare_sel_all;
DEALLOCATE fdw_prepare_sel_all_d;
--- numeric(38, 0)
PREPARE fdw_prepare_ins (numeric(38, 0)) AS
  INSERT INTO fdw_type_numeric_ps0 VALUES ($1);
PREPARE fdw_prepare_sel_all AS
  SELECT * FROM fdw_type_numeric_ps0 ORDER BY c;
EXECUTE fdw_prepare_ins (0);
EXECUTE fdw_prepare_ins (1);
EXECUTE fdw_prepare_ins (18446744073709551615);
EXECUTE fdw_prepare_ins (18446744073709551616);
EXECUTE fdw_prepare_ins (99999999999999999999999999999999999999);
EXECUTE fdw_prepare_ins (-1);
EXECUTE fdw_prepare_ins (-18446744073709551615);
EXECUTE fdw_prepare_ins (-18446744073709551616);
EXECUTE fdw_prepare_ins (-99999999999999999999999999999999999999);
EXECUTE fdw_prepare_sel_all;
                    c                    
-----------------------------------------
 -99999999999999999999999999999999999999
                   -18446744073709551616
                   -18446744073709551615
                                      -1
                                       0
                                       1
                    18446744073709551615
                    18446744073709551616
  99999999999999999999999999999999999999
(9 rows)

DEALLOCATE fdw_prepare_ins;
DEALLOCATE fdw_prepare_sel_all;
--- numeric(38, 38)
PREPARE fdw_prepare_ins (numeric(38, 38)) AS
  INSERT INTO fdw_type_numeric_ps38 VALUES ($1);
PREPARE fdw_prepare_sel_all AS
  SELECT * FROM fdw_type_numeric_ps38 ORDER BY c;
EXECUTE fdw_prepare_ins (0);  -- see tsurugi-issues#736
EXECUTE fdw_prepare_ins (0.00000000000000000000000000000000000001);
EXECUTE fdw_prepare_ins (0.00000000000000000018446744073709551615);
EXECUTE fdw_prepare_ins (0.00000000000000000018446744073709551616);
EXECUTE fdw_prepare_ins (0.99999999999999999999999999999999999999);
EXECUTE fdw_prepare_ins (-0.00000000000000000000000000000000000001);
EXECUTE fdw_prepare_ins (-0.00000000000000000018446744073709551615);
EXECUTE fdw_prepare_ins (-0.00000000000000000018446744073709551616);
EXECUTE fdw_prepare_ins (-0.99999999999999999999999999999999999999);
EXECUTE fdw_prepare_sel_all;
                     c                     
-------------------------------------------
 -0.99999999999999999999999999999999999999
 -0.00000000000000000018446744073709551616
 -0.00000000000000000018446744073709551615
 -0.00000000000000000000000000000000000001
  0.00000000000000000000000000000000000000
  0.00000000000000000000000000000000000001
  0.00000000000000000018446744073709551615
  0.00000000000000000018446744073709551616
  0.99999999999999999999999999999999999999
(9 rows)

DEALLOCATE fdw_prepare_ins;
DEALLOCATE fdw_prepare_sel_all;
--- real
PREPARE fdw_prepare_ins (real) AS
  INSERT INTO fdw_type_real VALUES ($1);
PREPARE fdw_prepare_upd (real) AS
  UPDATE fdw_type_real SET c = c * -1 WHERE c = $1;
PREPARE fdw_prepare_upd_nul (real) AS
  UPDATE fdw_type_real SET c = $1 WHERE c IS NULL;
PREPARE fdw_prepare_del (real) AS
  DELETE FROM fdw_type_real WHERE c = $1;
PREPARE fdw_prepare_sel_all AS
  SELECT * FROM fdw_type_real ORDER BY c;
PREPARE fdw_prepare_sel_all_d AS
  SELECT * FROM fdw_type_real ORDER BY c DESC;
EXECUTE fdw_prepare_ins (0.1);
EXECUTE fdw_prepare_ins (1.1);
EXECUTE fdw_prepare_ins (1.2345);
EXECUTE fdw_prepare_ins (-1.2345);
EXECUTE fdw_prepare_ins (NULL);
EXECUTE fdw_prepare_ins (12.345678901234567890); --20 digits
EXECUTE fdw_prepare_sel_all;
     c     
-----------
          
   -1.2345
       0.1
       1.1
    1.2345
 12.345679
(6 rows)

EXECUTE fdw_prepare_upd_nul (9.87654);
EXECUTE fdw_prepare_sel_all;
     c     
-----------
   -1.2345
       0.1
       1.1
    1.2345
   9.87654
 12.345679
(6 rows)

EXECUTE fdw_prepare_upd (9.87654::real);
EXECUTE fdw_prepare_sel_all_d;
     c     
-----------
 12.345679
    1.2345
       1.1
       0.1
   -1.2345
  -9.87654
(6 rows)

EXECUTE fdw_prepare_del (CAST(-9.87654 AS real));
EXECUTE fdw_prepare_sel_all;
     c     
-----------
   -1.2345
       0.1
       1.1
    1.2345
 12.345679
(5 rows)

DEALLOCATE fdw_prepare_ins;
DEALLOCATE fdw_prepare_upd;
DEALLOCATE fdw_prepare_upd_nul;
DEALLOCATE fdw_prepare_del;
DEALLOCATE fdw_prepare_sel_all;
DEALLOCATE fdw_prepare_sel_all_d;
--- double precision
PREPARE fdw_prepare_ins (double precision) AS
  INSERT INTO fdw_type_double VALUES ($1);
PREPARE fdw_prepare_upd (double precision) AS
  UPDATE fdw_type_double SET c = c * -1 WHERE c = $1;
PREPARE fdw_prepare_upd_nul (double precision) AS
  UPDATE fdw_type_double SET c = $1 WHERE c IS NULL;
PREPARE fdw_prepare_del (double precision) AS
  DELETE FROM fdw_type_double WHERE c = $1;
PREPARE fdw_prepare_sel_all AS
  SELECT * FROM fdw_type_double ORDER BY c;
PREPARE fdw_prepare_sel_all_d AS
  SELECT * FROM fdw_type_double ORDER BY c DESC;
EXECUTE fdw_prepare_ins (0.1);
EXECUTE fdw_prepare_ins (1.1);
EXECUTE fdw_prepare_ins (1.2345);
EXECUTE fdw_prepare_ins (-1.2345);
EXECUTE fdw_prepare_ins (NULL);
EXECUTE fdw_prepare_ins (12.345678901234567890); --20 digits
EXECUTE fdw_prepare_sel_all;
         c          
--------------------
                   
            -1.2345
                0.1
                1.1
             1.2345
 12.345678901234567
(6 rows)

EXECUTE fdw_prepare_upd_nul (9.87654);
EXECUTE fdw_prepare_sel_all;
         c          
--------------------
            -1.2345
                0.1
                1.1
             1.2345
            9.87654
 12.345678901234567
(6 rows)

EXECUTE fdw_prepare_upd (9.87654::double precision);
EXECUTE fdw_prepare_sel_all_d;
         c          
--------------------
 12.345678901234567
             1.2345
                1.1
                0.1
            -1.2345
           -9.87654
(6 rows)

EXECUTE fdw_prepare_del (CAST(-9.87654 AS double precision));
EXECUTE fdw_prepare_sel_all;
         c          
--------------------
            -1.2345
                0.1
                1.1
             1.2345
 12.345678901234567
(5 rows)

DEALLOCATE fdw_prepare_ins;
DEALLOCATE fdw_prepare_upd;
DEALLOCATE fdw_prepare_upd_nul;
DEALLOCATE fdw_prepare_del;
DEALLOCATE fdw_prepare_sel_all;
DEALLOCATE fdw_prepare_sel_all_d;
-- Character Types
--- char
PREPARE fdw_prepare_ins (char) AS
  INSERT INTO fdw_type_char VALUES ($1);
PREPARE fdw_prepare_upd (char, char) AS
  UPDATE fdw_type_char SET c = $1 WHERE c = $2;
PREPARE fdw_prepare_upd_nul (char) AS
  UPDATE fdw_type_char SET c = $1 WHERE c IS NULL;
PREPARE fdw_prepare_del (char) AS
  DELETE FROM fdw_type_char WHERE c = $1;
PREPARE fdw_prepare_sel_all AS
  SELECT * FROM fdw_type_char ORDER BY c;
PREPARE fdw_prepare_sel_all_d AS
  SELECT * FROM fdw_type_char ORDER BY c DESC;
EXECUTE fdw_prepare_ins ('a');
EXECUTE fdw_prepare_ins ('');
EXECUTE fdw_prepare_ins (NULL);
EXECUTE fdw_prepare_ins (1);  -- auto-cast
EXECUTE fdw_prepare_sel_all;
 c 
---
 
  
 1
 a
(4 rows)

EXECUTE fdw_prepare_upd_nul ('X');
EXECUTE fdw_prepare_sel_all;
 c 
---
  
 1
 X
 a
(4 rows)

EXECUTE fdw_prepare_upd ('z', 'X');
EXECUTE fdw_prepare_sel_all_d;
 c 
---
 z
 a
 1
  
(4 rows)

EXECUTE fdw_prepare_del ('z');
EXECUTE fdw_prepare_sel_all;
 c 
---
  
 1
 a
(3 rows)

DEALLOCATE fdw_prepare_ins;
DEALLOCATE fdw_prepare_upd;
DEALLOCATE fdw_prepare_upd_nul;
DEALLOCATE fdw_prepare_del;
DEALLOCATE fdw_prepare_sel_all;
DEALLOCATE fdw_prepare_sel_all_d;
--- char(length)
PREPARE fdw_prepare_ins (char(10)) AS
  INSERT INTO fdw_type_char_l VALUES ($1);
PREPARE fdw_prepare_upd (char(10), char(10)) AS
  UPDATE fdw_type_char_l SET c = $1 WHERE c = $2;
PREPARE fdw_prepare_upd_nul (char(10)) AS
  UPDATE fdw_type_char_l SET c = $1 WHERE c IS NULL;
PREPARE fdw_prepare_del (char(10)) AS
  DELETE FROM fdw_type_char_l WHERE c = $1;
PREPARE fdw_prepare_sel_all AS
  SELECT * FROM fdw_type_char_l ORDER BY c;
PREPARE fdw_prepare_sel_all_d AS
  SELECT * FROM fdw_type_char_l ORDER BY c DESC;
EXECUTE fdw_prepare_ins ('abcdef');
EXECUTE fdw_prepare_ins ('PostgreSQL');
EXECUTE fdw_prepare_ins ('');
EXECUTE fdw_prepare_ins (NULL);
EXECUTE fdw_prepare_ins (12345);  -- auto-cast
EXECUTE fdw_prepare_sel_all;
     c      
------------
 
           
 12345     
 PostgreSQL
 abcdef    
(5 rows)

EXECUTE fdw_prepare_upd_nul ('NULL');
EXECUTE fdw_prepare_sel_all;
     c      
------------
           
 12345     
 NULL      
 PostgreSQL
 abcdef    
(5 rows)

EXECUTE fdw_prepare_upd ('update', CAST('NULL' AS char(10)));
EXECUTE fdw_prepare_sel_all_d;
     c      
------------
 update    
 abcdef    
 PostgreSQL
 12345     
           
(5 rows)

EXECUTE fdw_prepare_del ('update'::char(10));
EXECUTE fdw_prepare_sel_all;
     c      
------------
           
 12345     
 PostgreSQL
 abcdef    
(4 rows)

DEALLOCATE fdw_prepare_ins;
DEALLOCATE fdw_prepare_upd;
DEALLOCATE fdw_prepare_upd_nul;
DEALLOCATE fdw_prepare_del;
DEALLOCATE fdw_prepare_sel_all;
DEALLOCATE fdw_prepare_sel_all_d;
--- varchar
PREPARE fdw_prepare_ins (varchar) AS
  INSERT INTO fdw_type_varchar VALUES ($1);
PREPARE fdw_prepare_upd (varchar, varchar) AS
  UPDATE fdw_type_varchar SET c = c || '_' || $1 WHERE c = $2;
PREPARE fdw_prepare_upd_nul (varchar) AS
  UPDATE fdw_type_varchar SET c = $1 WHERE c IS NULL;
PREPARE fdw_prepare_del (varchar) AS
  DELETE FROM fdw_type_varchar WHERE c = $1;
PREPARE fdw_prepare_sel_all AS
  SELECT * FROM fdw_type_varchar ORDER BY c;
PREPARE fdw_prepare_sel_all_d AS
  SELECT * FROM fdw_type_varchar ORDER BY c DESC;
EXECUTE fdw_prepare_ins ('abcdef');
EXECUTE fdw_prepare_ins ('');
EXECUTE fdw_prepare_ins (NULL);
EXECUTE fdw_prepare_ins (12345);  -- auto-cast
EXECUTE fdw_prepare_sel_all;
   c    
--------
 
 
 12345
 abcdef
(4 rows)

EXECUTE fdw_prepare_upd_nul ('NULL');
EXECUTE fdw_prepare_sel_all;
   c    
--------
 
 12345
 NULL
 abcdef
(4 rows)

EXECUTE fdw_prepare_upd ('updated', 'NULL');
EXECUTE fdw_prepare_sel_all_d;
      c       
--------------
 abcdef
 NULL_updated
 12345
 
(4 rows)

EXECUTE fdw_prepare_del ('NULL_updated');
EXECUTE fdw_prepare_sel_all;
   c    
--------
 
 12345
 abcdef
(3 rows)

DEALLOCATE fdw_prepare_ins;
DEALLOCATE fdw_prepare_upd;
DEALLOCATE fdw_prepare_upd_nul;
DEALLOCATE fdw_prepare_del;
DEALLOCATE fdw_prepare_sel_all;
DEALLOCATE fdw_prepare_sel_all_d;
--- varchar(length)
PREPARE fdw_prepare_ins (varchar(10)) AS
  INSERT INTO fdw_type_varchar_l VALUES ($1);
PREPARE fdw_prepare_upd (varchar(10), varchar(10)) AS
  UPDATE fdw_type_varchar_l SET c = $1 WHERE c = $2;
PREPARE fdw_prepare_upd_nul (varchar(10)) AS
  UPDATE fdw_type_varchar_l SET c = $1 WHERE c IS NULL;
PREPARE fdw_prepare_del (varchar(10)) AS
  DELETE FROM fdw_type_varchar_l WHERE c = $1;
PREPARE fdw_prepare_sel_all AS
  SELECT * FROM fdw_type_varchar_l ORDER BY c;
PREPARE fdw_prepare_sel_all_d AS
  SELECT * FROM fdw_type_varchar_l ORDER BY c DESC;
EXECUTE fdw_prepare_ins ('abcdef');
EXECUTE fdw_prepare_ins ('PostgreSQL');
EXECUTE fdw_prepare_ins ('');
EXECUTE fdw_prepare_ins (NULL);
EXECUTE fdw_prepare_ins (12345);  -- auto-cast
EXECUTE fdw_prepare_sel_all;
     c      
------------
 
 
 12345
 PostgreSQL
 abcdef
(5 rows)

EXECUTE fdw_prepare_upd_nul ('NULL');
EXECUTE fdw_prepare_sel_all;
     c      
------------
 
 12345
 NULL
 PostgreSQL
 abcdef
(5 rows)

EXECUTE fdw_prepare_upd ('update', 'NULL');
EXECUTE fdw_prepare_sel_all_d;
     c      
------------
 update
 abcdef
 PostgreSQL
 12345
 
(5 rows)

EXECUTE fdw_prepare_del ('update');
EXECUTE fdw_prepare_sel_all;
     c      
------------
 
 12345
 PostgreSQL
 abcdef
(4 rows)

DEALLOCATE fdw_prepare_ins;
DEALLOCATE fdw_prepare_upd;
DEALLOCATE fdw_prepare_upd_nul;
DEALLOCATE fdw_prepare_del;
DEALLOCATE fdw_prepare_sel_all;
DEALLOCATE fdw_prepare_sel_all_d;
--- text
PREPARE fdw_prepare_ins (text) AS
  INSERT INTO fdw_type_text VALUES ($1);
PREPARE fdw_prepare_upd (text, text) AS
  UPDATE fdw_type_text SET c = c || '_' || $1 WHERE c = $2;
PREPARE fdw_prepare_upd_nul (text) AS
  UPDATE fdw_type_text SET c = $1 WHERE c IS NULL;
PREPARE fdw_prepare_del (text) AS
  DELETE FROM fdw_type_text WHERE c = $1;
PREPARE fdw_prepare_sel_all AS
  SELECT * FROM fdw_type_text ORDER BY c;
PREPARE fdw_prepare_sel_all_d AS
  SELECT * FROM fdw_type_text ORDER BY c DESC;
EXECUTE fdw_prepare_ins ('abcdef');
EXECUTE fdw_prepare_ins ('');
EXECUTE fdw_prepare_ins (NULL);
EXECUTE fdw_prepare_ins (12345);  -- auto-cast
EXECUTE fdw_prepare_sel_all;
   c    
--------
 
 
 12345
 abcdef
(4 rows)

EXECUTE fdw_prepare_upd_nul ('NULL');
EXECUTE fdw_prepare_sel_all;
   c    
--------
 
 12345
 NULL
 abcdef
(4 rows)

EXECUTE fdw_prepare_upd ('updated', 'NULL');
EXECUTE fdw_prepare_sel_all_d;
      c       
--------------
 abcdef
 NULL_updated
 12345
 
(4 rows)

EXECUTE fdw_prepare_del ('NULL_updated');
EXECUTE fdw_prepare_sel_all;
   c    
--------
 
 12345
 abcdef
(3 rows)

DEALLOCATE fdw_prepare_ins;
DEALLOCATE fdw_prepare_upd;
DEALLOCATE fdw_prepare_upd_nul;
DEALLOCATE fdw_prepare_del;
DEALLOCATE fdw_prepare_sel_all;
DEALLOCATE fdw_prepare_sel_all_d;
-- Date/Time Types
SET DATESTYLE TO ISO, YMD;
--- date
PREPARE fdw_prepare_ins (date) AS
  INSERT INTO fdw_type_date VALUES ($1);
PREPARE fdw_prepare_upd_nul (date) AS
  UPDATE fdw_type_date SET c = $1 WHERE c IS NULL;
PREPARE fdw_prepare_upd (date, date) AS
  UPDATE fdw_type_date SET c = $1 WHERE c = $2;
PREPARE fdw_prepare_del (date) AS
  DELETE FROM fdw_type_date WHERE c = $1;
PREPARE fdw_prepare_sel_all AS
  SELECT * FROM fdw_type_date ORDER BY c;
PREPARE fdw_prepare_sel_all_d AS
  SELECT * FROM fdw_type_date ORDER BY c DESC;
EXECUTE fdw_prepare_ins (date '2025-01-01');
EXECUTE fdw_prepare_ins ('2025-01-02'::date);
EXECUTE fdw_prepare_ins (CAST('2025-01-03' AS date));
EXECUTE fdw_prepare_ins (date '0001-01-01');
EXECUTE fdw_prepare_ins (date '9999-12-31');
EXECUTE fdw_prepare_ins (NULL);
EXECUTE fdw_prepare_ins ('2024-12-31');  -- auto cast
EXECUTE fdw_prepare_sel_all;
     c      
------------
 
 0001-01-01
 2024-12-31
 2025-01-01
 2025-01-02
 2025-01-03
 9999-12-31
(7 rows)

EXECUTE fdw_prepare_upd_nul ('2025-02-01');
EXECUTE fdw_prepare_sel_all;
     c      
------------
 0001-01-01
 2024-12-31
 2025-01-01
 2025-01-02
 2025-01-03
 2025-02-01
 9999-12-31
(7 rows)

EXECUTE fdw_prepare_upd ('2025-03-10'::date, '2025-02-01'::date);
EXECUTE fdw_prepare_sel_all_d;
     c      
------------
 9999-12-31
 2025-03-10
 2025-01-03
 2025-01-02
 2025-01-01
 2024-12-31
 0001-01-01
(7 rows)

EXECUTE fdw_prepare_del (CAST('2025-03-10' AS date));
EXECUTE fdw_prepare_sel_all;
     c      
------------
 0001-01-01
 2024-12-31
 2025-01-01
 2025-01-02
 2025-01-03
 9999-12-31
(6 rows)

DEALLOCATE fdw_prepare_ins;
DEALLOCATE fdw_prepare_upd;
DEALLOCATE fdw_prepare_upd_nul;
DEALLOCATE fdw_prepare_del;
DEALLOCATE fdw_prepare_sel_all;
DEALLOCATE fdw_prepare_sel_all_d;
--- time
PREPARE fdw_prepare_ins (time) AS
  INSERT INTO fdw_type_time VALUES ($1);
PREPARE fdw_prepare_upd_nul (time) AS
  UPDATE fdw_type_time SET c = $1 WHERE c IS NULL;
PREPARE fdw_prepare_upd (time, time) AS
  UPDATE fdw_type_time SET c = $1 WHERE c = $2;
PREPARE fdw_prepare_del (time) AS
  DELETE FROM fdw_type_time WHERE c = $1;
PREPARE fdw_prepare_sel_all AS
  SELECT * FROM fdw_type_time ORDER BY c;
PREPARE fdw_prepare_sel_all_d AS
  SELECT * FROM fdw_type_time ORDER BY c DESC;
EXECUTE fdw_prepare_ins (time '01:02:03.456');
EXECUTE fdw_prepare_ins ('03:02:01.456'::time);
EXECUTE fdw_prepare_ins (CAST('02:01:03.456' AS time));
EXECUTE fdw_prepare_ins (time '01:02:03.456789012');
EXECUTE fdw_prepare_ins (time '00:00:00');
EXECUTE fdw_prepare_ins (time '23:59:59.999999');
EXECUTE fdw_prepare_ins (NULL);
EXECUTE fdw_prepare_ins ('04:05:06.789');  -- auto cast
EXECUTE fdw_prepare_sel_all;
        c        
-----------------
 
 00:00:00
 01:02:03.456
 01:02:03.456789
 02:01:03.456
 03:02:01.456
 04:05:06.789
 23:59:59.999999
(8 rows)

EXECUTE fdw_prepare_upd_nul ('00:00:00.001');
EXECUTE fdw_prepare_sel_all;
        c        
-----------------
 00:00:00
 00:00:00.001
 01:02:03.456
 01:02:03.456789
 02:01:03.456
 03:02:01.456
 04:05:06.789
 23:59:59.999999
(8 rows)

EXECUTE fdw_prepare_upd ('05:06:12.345'::time, '00:00:00.001'::time);
EXECUTE fdw_prepare_sel_all_d;
        c        
-----------------
 23:59:59.999999
 05:06:12.345
 04:05:06.789
 03:02:01.456
 02:01:03.456
 01:02:03.456789
 01:02:03.456
 00:00:00
(8 rows)

EXECUTE fdw_prepare_del (CAST('05:06:12.345' AS time));
EXECUTE fdw_prepare_sel_all;
        c        
-----------------
 00:00:00
 01:02:03.456
 01:02:03.456789
 02:01:03.456
 03:02:01.456
 04:05:06.789
 23:59:59.999999
(7 rows)

DEALLOCATE fdw_prepare_ins;
DEALLOCATE fdw_prepare_upd;
DEALLOCATE fdw_prepare_upd_nul;
DEALLOCATE fdw_prepare_del;
DEALLOCATE fdw_prepare_sel_all;
DEALLOCATE fdw_prepare_sel_all_d;
--- time with time zone
PREPARE fdw_prepare_ins (time with time zone) AS
  INSERT INTO fdw_type_time_tz VALUES ($1);
PREPARE fdw_prepare_upd_nul (time with time zone) AS
  UPDATE fdw_type_time_tz SET c = $1 WHERE c IS NULL;
PREPARE fdw_prepare_upd (time with time zone, time with time zone) AS
  UPDATE fdw_type_time_tz SET c = $1 WHERE c = $2;
PREPARE fdw_prepare_del (time with time zone) AS
  DELETE FROM fdw_type_time_tz WHERE c = $1;
PREPARE fdw_prepare_sel_all AS
  SELECT * FROM fdw_type_time_tz ORDER BY c;
PREPARE fdw_prepare_sel_all_d AS
  SELECT * FROM fdw_type_time_tz ORDER BY c DESC;
EXECUTE fdw_prepare_ins (time with time zone '12:34:56.789+9:00');
EXECUTE fdw_prepare_ins ('12:34:56.789+9:00'::time with time zone);
EXECUTE fdw_prepare_ins (CAST('12:34:56.789+9:00' AS time with time zone));
EXECUTE fdw_prepare_ins (time with time zone '12:34:56.789+900');
EXECUTE fdw_prepare_ins (time with time zone '12:34:56.789+9');
EXECUTE fdw_prepare_ins (time with time zone '12:34:56.789JST');
EXECUTE fdw_prepare_ins (time with time zone '18:01:02.3456789 -8:00');
EXECUTE fdw_prepare_ins (time with time zone '18:01:02.3456789 -800');
EXECUTE fdw_prepare_ins (time with time zone '18:01:02.3456789 -8');
EXECUTE fdw_prepare_ins (time with time zone '18:01:02.3456789 PST');
EXECUTE fdw_prepare_ins (time with time zone '00:01:02+00');
EXECUTE fdw_prepare_ins (time with time zone '00:01:02Z');
EXECUTE fdw_prepare_ins (time with time zone '00:01:02 z');
EXECUTE fdw_prepare_ins (time with time zone '00:01:02 zulu');
EXECUTE fdw_prepare_ins (time with time zone '23:59:59.999999+14');
EXECUTE fdw_prepare_ins (NULL);
EXECUTE fdw_prepare_ins ('04:05:06.789+9:00');
SET SESSION TIMEZONE TO 'UTC';
EXECUTE fdw_prepare_sel_all;
         c          
--------------------
 
 00:01:02+00
 00:01:02+00
 00:01:02+00
 00:01:02+00
 02:01:02.345679+00
 02:01:02.345679+00
 02:01:02.345679+00
 02:01:02.345679+00
 03:34:56.789+00
 03:34:56.789+00
 03:34:56.789+00
 03:34:56.789+00
 03:34:56.789+00
 03:34:56.789+00
 09:59:59.999999+00
 19:05:06.789+00
(17 rows)

EXECUTE fdw_prepare_upd_nul ('00:00:00.001+900'::time with time zone);
EXECUTE fdw_prepare_sel_all;
         c          
--------------------
 00:01:02+00
 00:01:02+00
 00:01:02+00
 00:01:02+00
 02:01:02.345679+00
 02:01:02.345679+00
 02:01:02.345679+00
 02:01:02.345679+00
 03:34:56.789+00
 03:34:56.789+00
 03:34:56.789+00
 03:34:56.789+00
 03:34:56.789+00
 03:34:56.789+00
 09:59:59.999999+00
 15:00:00.001+00
 19:05:06.789+00
(17 rows)

EXECUTE fdw_prepare_upd ('05:05:05.005005z', '18:01:02.3456789 PST');
EXECUTE fdw_prepare_sel_all_d;
         c          
--------------------
 19:05:06.789+00
 15:00:00.001+00
 09:59:59.999999+00
 05:05:05.005005+00
 05:05:05.005005+00
 05:05:05.005005+00
 05:05:05.005005+00
 03:34:56.789+00
 03:34:56.789+00
 03:34:56.789+00
 03:34:56.789+00
 03:34:56.789+00
 03:34:56.789+00
 00:01:02+00
 00:01:02+00
 00:01:02+00
 00:01:02+00
(17 rows)

EXECUTE fdw_prepare_del
  (CAST('23:59:59.999999+14' AS time with time zone));
EXECUTE fdw_prepare_sel_all;
         c          
--------------------
 00:01:02+00
 00:01:02+00
 00:01:02+00
 00:01:02+00
 03:34:56.789+00
 03:34:56.789+00
 03:34:56.789+00
 03:34:56.789+00
 03:34:56.789+00
 03:34:56.789+00
 05:05:05.005005+00
 05:05:05.005005+00
 05:05:05.005005+00
 05:05:05.005005+00
 15:00:00.001+00
 19:05:06.789+00
(16 rows)

DEALLOCATE fdw_prepare_ins;
DEALLOCATE fdw_prepare_upd;
DEALLOCATE fdw_prepare_upd_nul;
DEALLOCATE fdw_prepare_del;
DEALLOCATE fdw_prepare_sel_all;
DEALLOCATE fdw_prepare_sel_all_d;
--- timestamp
PREPARE fdw_prepare_ins (timestamp) AS
  INSERT INTO fdw_type_timestamp VALUES ($1);
PREPARE fdw_prepare_upd_nul (timestamp) AS
  UPDATE fdw_type_timestamp SET c = $1 WHERE c IS NULL;
PREPARE fdw_prepare_upd (timestamp, timestamp) AS
  UPDATE fdw_type_timestamp SET c = $1 WHERE c = $2;
PREPARE fdw_prepare_del (timestamp) AS
  DELETE FROM fdw_type_timestamp WHERE c = $1;
PREPARE fdw_prepare_sel_all AS
  SELECT * FROM fdw_type_timestamp ORDER BY c;
PREPARE fdw_prepare_sel_all_d AS
  SELECT * FROM fdw_type_timestamp ORDER BY c DESC;
EXECUTE fdw_prepare_ins (timestamp '2025-01-01 00:00:00');
EXECUTE fdw_prepare_ins ('2025-01-02 00:00:00'::timestamp);
EXECUTE fdw_prepare_ins (CAST('2025-01-03 00:00:00' AS timestamp));
EXECUTE fdw_prepare_ins (timestamp '1887-12-31 15:00:00');
EXECUTE fdw_prepare_ins (timestamp '9999-12-31 23:59:59.999999');
EXECUTE fdw_prepare_ins (NULL);
EXECUTE fdw_prepare_ins ('2024-08-30 04:05:06.789');  -- auto cast
EXECUTE fdw_prepare_sel_all;
             c              
----------------------------
 
 1887-12-31 15:00:00
 2024-08-30 04:05:06.789
 2025-01-01 00:00:00
 2025-01-02 00:00:00
 2025-01-03 00:00:00
 9999-12-31 23:59:59.999999
(7 rows)

EXECUTE fdw_prepare_upd_nul ('2025-01-01 00:00:00.001');
EXECUTE fdw_prepare_sel_all;
             c              
----------------------------
 1887-12-31 15:00:00
 2024-08-30 04:05:06.789
 2025-01-01 00:00:00
 2025-01-01 00:00:00.001
 2025-01-02 00:00:00
 2025-01-03 00:00:00
 9999-12-31 23:59:59.999999
(7 rows)

EXECUTE fdw_prepare_upd
  ('2025-03-02 05:06:12.345'::timestamp, '2025-01-01 00:00:00.001'::timestamp);
EXECUTE fdw_prepare_sel_all_d;
             c              
----------------------------
 9999-12-31 23:59:59.999999
 2025-03-02 05:06:12.345
 2025-01-03 00:00:00
 2025-01-02 00:00:00
 2025-01-01 00:00:00
 2024-08-30 04:05:06.789
 1887-12-31 15:00:00
(7 rows)

EXECUTE fdw_prepare_del (CAST('2025-03-02 05:06:12.345' AS timestamp));
EXECUTE fdw_prepare_sel_all;
             c              
----------------------------
 1887-12-31 15:00:00
 2024-08-30 04:05:06.789
 2025-01-01 00:00:00
 2025-01-02 00:00:00
 2025-01-03 00:00:00
 9999-12-31 23:59:59.999999
(6 rows)

DEALLOCATE fdw_prepare_ins;
DEALLOCATE fdw_prepare_upd;
DEALLOCATE fdw_prepare_upd_nul;
DEALLOCATE fdw_prepare_del;
DEALLOCATE fdw_prepare_sel_all;
DEALLOCATE fdw_prepare_sel_all_d;
--- timestamp without time zone
PREPARE fdw_prepare_ins (timestamp without time zone) AS
  INSERT INTO fdw_type_timestamp_wo_tz VALUES ($1);
PREPARE fdw_prepare_upd_nul (timestamp without time zone) AS
  UPDATE fdw_type_timestamp_wo_tz SET c = $1 WHERE c IS NULL;
PREPARE fdw_prepare_upd
  (timestamp without time zone, timestamp without time zone) AS
  UPDATE fdw_type_timestamp_wo_tz SET c = $1 WHERE c = $2;
PREPARE fdw_prepare_del (timestamp without time zone) AS
  DELETE FROM fdw_type_timestamp_wo_tz WHERE c = $1;
PREPARE fdw_prepare_sel_all AS
  SELECT * FROM fdw_type_timestamp_wo_tz ORDER BY c;
PREPARE fdw_prepare_sel_all_d AS
  SELECT * FROM fdw_type_timestamp_wo_tz ORDER BY c DESC;
EXECUTE fdw_prepare_ins (timestamp without time zone '2025-01-01 00:00:00');
EXECUTE fdw_prepare_ins ('2025-01-02 00:00:00'::timestamp without time zone);
EXECUTE fdw_prepare_ins
  (CAST('2025-01-03 00:00:00' AS timestamp without time zone));
EXECUTE fdw_prepare_ins (timestamp without time zone '1887-12-31 15:00:00');
EXECUTE fdw_prepare_ins
  (timestamp without time zone '9999-12-31 23:59:59.999999');
EXECUTE fdw_prepare_ins (NULL);
EXECUTE fdw_prepare_ins ('2024-08-30 04:05:06.789');  -- auto cast
EXECUTE fdw_prepare_sel_all;
             c              
----------------------------
 
 1887-12-31 15:00:00
 2024-08-30 04:05:06.789
 2025-01-01 00:00:00
 2025-01-02 00:00:00
 2025-01-03 00:00:00
 9999-12-31 23:59:59.999999
(7 rows)

EXECUTE fdw_prepare_upd_nul ('2025-01-01 00:00:00.001');
EXECUTE fdw_prepare_sel_all;
             c              
----------------------------
 1887-12-31 15:00:00
 2024-08-30 04:05:06.789
 2025-01-01 00:00:00
 2025-01-01 00:00:00.001
 2025-01-02 00:00:00
 2025-01-03 00:00:00
 9999-12-31 23:59:59.999999
(7 rows)

EXECUTE fdw_prepare_upd
  ('2025-03-02 05:06:12.345'::timestamp without time zone,
   '2025-01-01 00:00:00.001'::timestamp without time zone);
EXECUTE fdw_prepare_sel_all_d;
             c              
----------------------------
 9999-12-31 23:59:59.999999
 2025-03-02 05:06:12.345
 2025-01-03 00:00:00
 2025-01-02 00:00:00
 2025-01-01 00:00:00
 2024-08-30 04:05:06.789
 1887-12-31 15:00:00
(7 rows)

EXECUTE fdw_prepare_del
  (CAST('2025-03-02 05:06:12.345' AS timestamp without time zone));
EXECUTE fdw_prepare_sel_all;
             c              
----------------------------
 1887-12-31 15:00:00
 2024-08-30 04:05:06.789
 2025-01-01 00:00:00
 2025-01-02 00:00:00
 2025-01-03 00:00:00
 9999-12-31 23:59:59.999999
(6 rows)

DEALLOCATE fdw_prepare_ins;
DEALLOCATE fdw_prepare_upd;
DEALLOCATE fdw_prepare_upd_nul;
DEALLOCATE fdw_prepare_del;
DEALLOCATE fdw_prepare_sel_all;
DEALLOCATE fdw_prepare_sel_all_d;
--- timestamp with time zone
PREPARE fdw_prepare_ins (timestamp with time zone) AS
  INSERT INTO fdw_type_timestamp_tz VALUES ($1);
PREPARE fdw_prepare_upd_nul (timestamp with time zone) AS
  UPDATE fdw_type_timestamp_tz SET c = $1 WHERE c IS NULL;
PREPARE fdw_prepare_upd (timestamp with time zone, timestamp with time zone) AS
  UPDATE fdw_type_timestamp_tz SET c = $1 WHERE c = $2;
PREPARE fdw_prepare_del (timestamp with time zone) AS
  DELETE FROM fdw_type_timestamp_tz WHERE c = $1;
PREPARE fdw_prepare_sel_all AS
  SELECT * FROM fdw_type_timestamp_tz ORDER BY c;
PREPARE fdw_prepare_sel_all_d AS
  SELECT * FROM fdw_type_timestamp_tz ORDER BY c DESC;
EXECUTE fdw_prepare_ins
  (timestamp with time zone '2025-01-01 12:01:02.34567+9:00');
EXECUTE fdw_prepare_ins
  ('2025-01-02 12:01:02.34567+9:00'::timestamp with time zone);
EXECUTE fdw_prepare_ins
  (CAST('2025-01-03 12:01:02.34567+9:00' AS timestamp with time zone));
EXECUTE fdw_prepare_ins
  (timestamp with time zone '2025-01-01 12:01:02.34567+900');
EXECUTE fdw_prepare_ins
  (timestamp with time zone '2025-01-01 12:01:02.34567+9');
EXECUTE fdw_prepare_ins
  (timestamp with time zone '2025-01-01 12:01:02.34567JST');
EXECUTE fdw_prepare_ins
  (timestamp with time zone '2025-02-01 00:00:00.001 America/New_York');
EXECUTE fdw_prepare_ins
  (timestamp with time zone '2025-02-01 00:00:00.002 PST8PDT');
EXECUTE fdw_prepare_ins
  (timestamp with time zone '2025-01-01 12:01:02.34567Z');
EXECUTE fdw_prepare_ins
  (timestamp with time zone '2025-01-01T12:01:02.34567 Z');
EXECUTE fdw_prepare_ins
  (timestamp with time zone '2025-01-01T12:01:02.34567 ZULU');
EXECUTE fdw_prepare_ins
  (timestamp with time zone '1887-12-31 15:00:00+00');
EXECUTE fdw_prepare_ins
  (timestamp with time zone '9999-12-31 23:59:59.999999+14');
EXECUTE fdw_prepare_ins (NULL);
EXECUTE fdw_prepare_ins ('2024-08-30 04:05:06.789+9:00');   -- auto cast
SET SESSION TIMEZONE TO 'UTC';  -- check time zone in UTC
EXECUTE fdw_prepare_sel_all;
               c               
-------------------------------
 
 1887-12-31 15:00:00+00
 2024-08-29 19:05:06.789+00
 2025-01-01 03:01:02.34567+00
 2025-01-01 03:01:02.34567+00
 2025-01-01 03:01:02.34567+00
 2025-01-01 03:01:02.34567+00
 2025-01-01 12:01:02.34567+00
 2025-01-01 12:01:02.34567+00
 2025-01-01 12:01:02.34567+00
 2025-01-02 03:01:02.34567+00
 2025-01-03 03:01:02.34567+00
 2025-02-01 05:00:00.001+00
 2025-02-01 08:00:00.002+00
 9999-12-31 09:59:59.999999+00
(15 rows)

SET SESSION TIMEZONE TO 'Asia/Tokyo';  -- check time zone in Asia/Tokyo
EXECUTE fdw_prepare_sel_all;
               c               
-------------------------------
 
 1888-01-01 00:00:00+09
 2024-08-30 04:05:06.789+09
 2025-01-01 12:01:02.34567+09
 2025-01-01 12:01:02.34567+09
 2025-01-01 12:01:02.34567+09
 2025-01-01 12:01:02.34567+09
 2025-01-01 21:01:02.34567+09
 2025-01-01 21:01:02.34567+09
 2025-01-01 21:01:02.34567+09
 2025-01-02 12:01:02.34567+09
 2025-01-03 12:01:02.34567+09
 2025-02-01 14:00:00.001+09
 2025-02-01 17:00:00.002+09
 9999-12-31 18:59:59.999999+09
(15 rows)

EXECUTE fdw_prepare_upd_nul ('2025-01-01 00:00:00.001+900');
EXECUTE fdw_prepare_sel_all;
               c               
-------------------------------
 1888-01-01 00:00:00+09
 2024-08-30 04:05:06.789+09
 2025-01-01 00:00:00.001+09
 2025-01-01 12:01:02.34567+09
 2025-01-01 12:01:02.34567+09
 2025-01-01 12:01:02.34567+09
 2025-01-01 12:01:02.34567+09
 2025-01-01 21:01:02.34567+09
 2025-01-01 21:01:02.34567+09
 2025-01-01 21:01:02.34567+09
 2025-01-02 12:01:02.34567+09
 2025-01-03 12:01:02.34567+09
 2025-02-01 14:00:00.001+09
 2025-02-01 17:00:00.002+09
 9999-12-31 18:59:59.999999+09
(15 rows)

EXECUTE fdw_prepare_upd
  ('2025-03-02 05:06:12.345+900'::timestamp with time zone,
   '2025-01-01 00:00:00.001+900'::timestamp with time zone);
EXECUTE fdw_prepare_sel_all_d;
               c               
-------------------------------
 9999-12-31 18:59:59.999999+09
 2025-03-02 05:06:12.345+09
 2025-02-01 17:00:00.002+09
 2025-02-01 14:00:00.001+09
 2025-01-03 12:01:02.34567+09
 2025-01-02 12:01:02.34567+09
 2025-01-01 21:01:02.34567+09
 2025-01-01 21:01:02.34567+09
 2025-01-01 21:01:02.34567+09
 2025-01-01 12:01:02.34567+09
 2025-01-01 12:01:02.34567+09
 2025-01-01 12:01:02.34567+09
 2025-01-01 12:01:02.34567+09
 2024-08-30 04:05:06.789+09
 1888-01-01 00:00:00+09
(15 rows)

EXECUTE fdw_prepare_del
  (CAST('2025-03-02 05:06:12.345+900' AS timestamp with time zone));
EXECUTE fdw_prepare_sel_all;
               c               
-------------------------------
 1888-01-01 00:00:00+09
 2024-08-30 04:05:06.789+09
 2025-01-01 12:01:02.34567+09
 2025-01-01 12:01:02.34567+09
 2025-01-01 12:01:02.34567+09
 2025-01-01 12:01:02.34567+09
 2025-01-01 21:01:02.34567+09
 2025-01-01 21:01:02.34567+09
 2025-01-01 21:01:02.34567+09
 2025-01-02 12:01:02.34567+09
 2025-01-03 12:01:02.34567+09
 2025-02-01 14:00:00.001+09
 2025-02-01 17:00:00.002+09
 9999-12-31 18:59:59.999999+09
(14 rows)

DEALLOCATE fdw_prepare_ins;
DEALLOCATE fdw_prepare_upd;
DEALLOCATE fdw_prepare_upd_nul;
DEALLOCATE fdw_prepare_del;
DEALLOCATE fdw_prepare_sel_all;
DEALLOCATE fdw_prepare_sel_all_d;
SET DATESTYLE TO 'default';
/* Test teardown: DDL of the PostgreSQL */
DROP FOREIGN TABLE fdw_type_int;
DROP FOREIGN TABLE fdw_type_bigint;
DROP FOREIGN TABLE fdw_type_decimal;
DROP FOREIGN TABLE fdw_type_decimal_p;
DROP FOREIGN TABLE fdw_type_decimal_ps;
DROP FOREIGN TABLE fdw_type_decimal_ps0;
DROP FOREIGN TABLE fdw_type_decimal_ps38;
DROP FOREIGN TABLE fdw_type_numeric;
DROP FOREIGN TABLE fdw_type_numeric_p;
DROP FOREIGN TABLE fdw_type_numeric_ps;
DROP FOREIGN TABLE fdw_type_numeric_ps0;
DROP FOREIGN TABLE fdw_type_numeric_ps38;
DROP FOREIGN TABLE fdw_type_real;
DROP FOREIGN TABLE fdw_type_double;
DROP FOREIGN TABLE fdw_type_char;
DROP FOREIGN TABLE fdw_type_char_l;
DROP FOREIGN TABLE fdw_type_varchar;
DROP FOREIGN TABLE fdw_type_varchar_l;
DROP FOREIGN TABLE fdw_type_text;
DROP FOREIGN TABLE fdw_type_date;
DROP FOREIGN TABLE fdw_type_time;
DROP FOREIGN TABLE fdw_type_time_tz;
DROP FOREIGN TABLE fdw_type_timestamp;
DROP FOREIGN TABLE fdw_type_timestamp_wo_tz;
DROP FOREIGN TABLE fdw_type_timestamp_tz;
/* Test teardown: DDL of the Tsurugi */
SELECT tg_execute_ddl('DROP TABLE fdw_type_int', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE fdw_type_bigint', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE fdw_type_decimal', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE fdw_type_decimal_p', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE fdw_type_decimal_ps', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE fdw_type_decimal_ps0', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE fdw_type_decimal_ps38', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE fdw_type_numeric', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE fdw_type_numeric_p', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE fdw_type_numeric_ps', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE fdw_type_numeric_ps0', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE fdw_type_numeric_ps38', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE fdw_type_real', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE fdw_type_double', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE fdw_type_char', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE fdw_type_char_l', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE fdw_type_varchar', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE fdw_type_varchar_l', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE fdw_type_text', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE fdw_type_date', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE fdw_type_time', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE fdw_type_time_tz', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE fdw_type_timestamp', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE fdw_type_timestamp_wo_tz', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

SELECT tg_execute_ddl('DROP TABLE fdw_type_timestamp_tz', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

