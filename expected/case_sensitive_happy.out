/* Test case: happy path - Case sensitivity */
-- Test setup: DDL of the Tsurugi
SELECT tg_execute_ddl('
  CREATE TABLE fdw_case_table (
    col INT,
    Col INT
  )
', 'tsurugidb');
 tg_execute_ddl 
----------------
 CREATE TABLE
(1 row)

-- Test setup: DDL of the PostgreSQL
CREATE FOREIGN TABLE fdw_case_table (
  col integer,
  "Col" integer
) SERVER tsurugidb;
-- Test
/* Fix tsurugi-issues#568 */
INSERT INTO fdw_case_table VALUES (1000, 1);
INSERT INTO public.fdw_case_table (col, "Col") VALUES (2000, 2);
INSERT INTO "public".fdw_case_table (col) VALUES (3000);
INSERT INTO "public"."fdw_case_table" (Col) VALUES (4000);
INSERT INTO Public.fdw_case_table ("col") VALUES (5000);
INSERT INTO PUBLIC.fdw_case_table ("Col") VALUES (6);
SELECT * FROM public.fdw_case_table ORDER BY col, Col DESC;
 col  | Col 
------+-----
      |   6
 1000 |   1
 2000 |   2
 3000 |    
 4000 |    
 5000 |    
(6 rows)

UPDATE fdw_case_table SET col = col + 100;
UPDATE public.fdw_case_table SET Col = Col + 10;
UPDATE "public".fdw_case_table SET "col" = "col" + 100 WHERE col > 5000;
UPDATE public."fdw_case_table" SET "Col" = "Col" + 10 WHERE "Col" < 10;
UPDATE "public"."fdw_case_table" SET "col" = col + 100 WHERE "col" > 3000;
UPDATE public.Fdw_Case_Table SET "col" = NULL WHERE "Col" = 16;
UPDATE Public.fdw_case_table SET "col" = "Col" * 10 WHERE Col IS NULL;
UPDATE PUBLIC.fdw_case_table SET "Col" = Col / 100 WHERE "Col" IS NULL;
SELECT * FROM fdw_case_table ORDER BY col;
 col  | Col 
------+-----
  160 |  16
 1110 |  11
 2110 |  12
 3210 |  32
 4210 |  42
 5310 |  53
(6 rows)

SELECT * FROM Public.Fdw_Case_Table ORDER BY Col;
 col  | Col 
------+-----
  160 |  16
 1110 |  11
 2110 |  12
 3210 |  32
 4210 |  42
 5310 |  53
(6 rows)

DELETE FROM fdw_case_table WHERE col = 1110;
DELETE FROM public.fdw_case_table WHERE "col" > 5000;
DELETE FROM "public".fdw_case_table WHERE Col <= 160;
DELETE FROM public."fdw_case_table" WHERE "col" >= 4200;
DELETE FROM "public"."fdw_case_table" WHERE "Col" > 30;
DELETE FROM Public.fdw_case_table WHERE col <> 2110;
DELETE FROM PUBLIC.fdw_case_table WHERE Col = 12;
SELECT * FROM Public.fdw_case_table;
 col  | Col 
------+-----
 2110 |  12
(1 row)

-- Test teardown: DDL of the PostgreSQL
DROP FOREIGN TABLE fdw_case_table;
-- Test teardown: DDL of the Tsurugi
SELECT tg_execute_ddl('DROP TABLE fdw_case_table', 'tsurugidb');
 tg_execute_ddl 
----------------
 DROP TABLE
(1 row)

